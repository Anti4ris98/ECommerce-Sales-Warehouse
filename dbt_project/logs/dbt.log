[0m22:57:35.408065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E83C6CC20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E85BBBED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E85BBBB10>]}


============================== 22:57:35.417350 | 421588bc-dbca-4b38-930c-a621bca6761b ==============================
[0m22:57:35.417350 [info ] [MainThread]: Running with dbt=1.11.4
[0m22:57:35.417773 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': '.', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt debug --profiles-dir .', 'use_experimental_parser': 'False', 'log_path': 'D:\\ML Projects\\ECommerce-Sales-Warehouse\\dbt_project\\logs'}
[0m22:57:35.536519 [info ] [MainThread]: dbt version: 1.11.4
[0m22:57:35.536880 [info ] [MainThread]: python version: 3.13.12
[0m22:57:35.537092 [info ] [MainThread]: python path: D:\ML Projects\ECommerce-Sales-Warehouse\de_potfolio_project\Scripts\python.exe
[0m22:57:35.537262 [info ] [MainThread]: os info: Windows-11-10.0.26200-SP0
[0m22:57:35.720096 [info ] [MainThread]: Using profiles dir at .
[0m22:57:35.720426 [info ] [MainThread]: Using profiles.yml file at .\profiles.yml
[0m22:57:35.720642 [info ] [MainThread]: Using dbt_project.yml file at D:\ML Projects\ECommerce-Sales-Warehouse\dbt_project\dbt_project.yml
[0m22:57:35.725403 [info ] [MainThread]: adapter type: postgres
[0m22:57:35.725648 [info ] [MainThread]: adapter version: 1.8.0
[0m22:57:35.785799 [info ] [MainThread]: Configuration:
[0m22:57:35.786157 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m22:57:35.786405 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m22:57:35.786603 [info ] [MainThread]: Required dependencies:
[0m22:57:35.786840 [debug] [MainThread]: Executing "git --help"
[0m22:57:35.810841 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Set `HEAD` or the index to a known state\n   switch     Switch branches\n   tag        Create, list, delete or verify tags\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m22:57:35.811143 [debug] [MainThread]: STDERR: "b''"
[0m22:57:35.811387 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m22:57:35.811646 [info ] [MainThread]: Connection:
[0m22:57:35.811860 [info ] [MainThread]:   host: localhost
[0m22:57:35.812028 [info ] [MainThread]:   port: 5432
[0m22:57:35.812188 [info ] [MainThread]:   user: user
[0m22:57:35.812335 [info ] [MainThread]:   database: ecommerce_dw
[0m22:57:35.812544 [info ] [MainThread]:   schema: public
[0m22:57:35.812800 [info ] [MainThread]:   connect_timeout: 10
[0m22:57:35.813027 [info ] [MainThread]:   role: None
[0m22:57:35.813359 [info ] [MainThread]:   search_path: None
[0m22:57:35.813624 [info ] [MainThread]:   keepalives_idle: 0
[0m22:57:35.813963 [info ] [MainThread]:   sslmode: None
[0m22:57:35.814190 [info ] [MainThread]:   sslcert: None
[0m22:57:35.814386 [info ] [MainThread]:   sslkey: None
[0m22:57:35.814607 [info ] [MainThread]:   sslrootcert: None
[0m22:57:35.814808 [info ] [MainThread]:   application_name: dbt
[0m22:57:35.815009 [info ] [MainThread]:   retries: 1
[0m22:57:35.815339 [info ] [MainThread]: Registered adapter: postgres=1.8.0
[0m22:57:35.911391 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m22:57:37.595161 [debug] [MainThread]: Using postgres connection "debug"
[0m22:57:37.595399 [debug] [MainThread]: On debug: select 1 as id
[0m22:57:37.595550 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:57:37.608450 [debug] [MainThread]: SQL status: SELECT 1 in 0.013 seconds
[0m22:57:37.609020 [debug] [MainThread]: On debug: Close
[0m22:57:37.609270 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m22:57:37.609632 [info ] [MainThread]: [32mAll checks passed![0m
[0m22:57:37.610134 [debug] [MainThread]: Command `dbt debug` succeeded at 22:57:37.610057 after 2.31 seconds
[0m22:57:37.610313 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m22:57:37.610487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E87154640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E871D4710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017E85C5E9C0>]}
[0m22:57:37.610690 [debug] [MainThread]: Flushing usage events
[0m22:57:38.085228 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:57:44.737585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002274A96CC20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002274C8E3ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002274C8E3B10>]}


============================== 22:57:44.740001 | 26a29352-c0dc-4426-807a-e3c16d9c44fe ==============================
[0m22:57:44.740001 [info ] [MainThread]: Running with dbt=1.11.4
[0m22:57:44.740405 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': '.', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt run --profiles-dir .', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'D:\\ML Projects\\ECommerce-Sales-Warehouse\\dbt_project\\logs'}
[0m22:57:44.848170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '26a29352-c0dc-4426-807a-e3c16d9c44fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002274ABF9940>]}
[0m22:57:44.884719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '26a29352-c0dc-4426-807a-e3c16d9c44fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002274C743350>]}
[0m22:57:44.885280 [info ] [MainThread]: Registered adapter: postgres=1.8.0
[0m22:57:44.993934 [debug] [MainThread]: checksum: 092b177ba87eb6bb3c55954c38aa57900eebac336561eb9ee32218428aa81d43, vars: {}, profile: , target: , version: 1.11.4
[0m22:57:44.994444 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:57:44.994712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '26a29352-c0dc-4426-807a-e3c16d9c44fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002274C975650>]}
[0m22:57:46.205381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '26a29352-c0dc-4426-807a-e3c16d9c44fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002274CB84320>]}
[0m22:57:46.235979 [debug] [MainThread]: Wrote artifact WritableManifest to D:\ML Projects\ECommerce-Sales-Warehouse\dbt_project\target\manifest.json
[0m22:57:46.250306 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\ML Projects\ECommerce-Sales-Warehouse\dbt_project\target\semantic_manifest.json
[0m22:57:46.291322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '26a29352-c0dc-4426-807a-e3c16d9c44fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002274CEDD710>]}
[0m22:57:46.291608 [info ] [MainThread]: Found 4 models, 462 macros
[0m22:57:46.291919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26a29352-c0dc-4426-807a-e3c16d9c44fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002274C983A00>]}
[0m22:57:46.292953 [info ] [MainThread]: 
[0m22:57:46.293230 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:57:46.293422 [info ] [MainThread]: 
[0m22:57:46.293692 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:57:46.295977 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_dw'
[0m22:57:46.321627 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_dw"
[0m22:57:46.321855 [debug] [ThreadPool]: On list_ecommerce_dw: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "connection_name": "list_ecommerce_dw"} */

    select distinct nspname from pg_namespace
  
[0m22:57:46.321996 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:57:46.334215 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.012 seconds
[0m22:57:46.334994 [debug] [ThreadPool]: On list_ecommerce_dw: Close
[0m22:57:46.336045 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_dw_public'
[0m22:57:46.338980 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_dw_public"
[0m22:57:46.339166 [debug] [ThreadPool]: On list_ecommerce_dw_public: BEGIN
[0m22:57:46.339385 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:57:46.345880 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m22:57:46.346133 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_dw_public"
[0m22:57:46.346372 [debug] [ThreadPool]: On list_ecommerce_dw_public: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "connection_name": "list_ecommerce_dw_public"} */
select
      'ecommerce_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:57:46.350015 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.003 seconds
[0m22:57:46.350796 [debug] [ThreadPool]: On list_ecommerce_dw_public: ROLLBACK
[0m22:57:46.351234 [debug] [ThreadPool]: On list_ecommerce_dw_public: Close
[0m22:57:46.354173 [debug] [MainThread]: Using postgres connection "master"
[0m22:57:46.354347 [debug] [MainThread]: On master: BEGIN
[0m22:57:46.354481 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:57:46.360733 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m22:57:46.360925 [debug] [MainThread]: Using postgres connection "master"
[0m22:57:46.361094 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:57:46.364725 [debug] [MainThread]: SQL status: SELECT 6 in 0.003 seconds
[0m22:57:46.366022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26a29352-c0dc-4426-807a-e3c16d9c44fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002274E09D490>]}
[0m22:57:46.366266 [debug] [MainThread]: On master: ROLLBACK
[0m22:57:46.366711 [debug] [MainThread]: Using postgres connection "master"
[0m22:57:46.366883 [debug] [MainThread]: On master: BEGIN
[0m22:57:46.367422 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:57:46.367583 [debug] [MainThread]: On master: COMMIT
[0m22:57:46.367722 [debug] [MainThread]: Using postgres connection "master"
[0m22:57:46.367837 [debug] [MainThread]: On master: COMMIT
[0m22:57:46.368226 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:57:46.368423 [debug] [MainThread]: On master: Close
[0m22:57:46.372762 [debug] [Thread-1 (]: Began running node model.ecommerce_dw.stg_sales
[0m22:57:46.373059 [info ] [Thread-1 (]: 1 of 4 START sql view model public.stg_sales ................................... [RUN]
[0m22:57:46.373431 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.ecommerce_dw.stg_sales'
[0m22:57:46.373633 [debug] [Thread-1 (]: Began compiling node model.ecommerce_dw.stg_sales
[0m22:57:46.377194 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_dw.stg_sales"
[0m22:57:46.377915 [debug] [Thread-1 (]: Began executing node model.ecommerce_dw.stg_sales
[0m22:57:46.395703 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_dw.stg_sales"
[0m22:57:46.396975 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dw.stg_sales"
[0m22:57:46.397204 [debug] [Thread-1 (]: On model.ecommerce_dw.stg_sales: BEGIN
[0m22:57:46.397368 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:57:46.404067 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m22:57:46.404319 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dw.stg_sales"
[0m22:57:46.404499 [debug] [Thread-1 (]: On model.ecommerce_dw.stg_sales: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.stg_sales"} */

  create view "ecommerce_dw"."public"."stg_sales__dbt_tmp"
    
    
  as (
    -- Staging model: Clean fact_sales data
-- This is a foundation for marts



SELECT 
    f.sale_id,
    f.order_id,
    f.user_id,
    f.product_id,
    f.date_id,
    f.quantity,
    f.unit_price,
    f.revenue,
    f.created_at,
    
    -- Join dimension data for easier querying
    p.product_title,
    p.category,
    u.username,
    u.email,
    d.full_date,
    d.year,
    d.month,
    d.quarter
    
FROM fact_sales f
LEFT JOIN dim_product p ON f.product_id = p.product_id
LEFT JOIN dim_user u ON f.user_id = u.user_id
LEFT JOIN dim_date d ON f.date_id = d.date_id
WHERE f.created_at IS NOT NULL
  );
[0m22:57:46.407973 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m22:57:46.411151 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dw.stg_sales"
[0m22:57:46.411355 [debug] [Thread-1 (]: On model.ecommerce_dw.stg_sales: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.stg_sales"} */
alter table "ecommerce_dw"."public"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m22:57:46.412258 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:57:46.420222 [debug] [Thread-1 (]: On model.ecommerce_dw.stg_sales: COMMIT
[0m22:57:46.420462 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dw.stg_sales"
[0m22:57:46.420620 [debug] [Thread-1 (]: On model.ecommerce_dw.stg_sales: COMMIT
[0m22:57:46.422662 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m22:57:46.425666 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_dw"."public"."stg_sales__dbt_backup"
[0m22:57:46.428341 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dw.stg_sales"
[0m22:57:46.428573 [debug] [Thread-1 (]: On model.ecommerce_dw.stg_sales: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.stg_sales"} */
drop view if exists "ecommerce_dw"."public"."stg_sales__dbt_backup" cascade
[0m22:57:46.429617 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m22:57:46.430966 [debug] [Thread-1 (]: On model.ecommerce_dw.stg_sales: Close
[0m22:57:46.436803 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26a29352-c0dc-4426-807a-e3c16d9c44fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002274E29E4C0>]}
[0m22:57:46.437236 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public.stg_sales .............................. [[32mCREATE VIEW[0m in 0.06s]
[0m22:57:46.437718 [debug] [Thread-1 (]: Finished running node model.ecommerce_dw.stg_sales
[0m22:57:46.438165 [debug] [Thread-3 (]: Began running node model.ecommerce_dw.daily_sales
[0m22:57:46.438733 [debug] [Thread-2 (]: Began running node model.ecommerce_dw.customer_ltv
[0m22:57:46.438998 [debug] [Thread-4 (]: Began running node model.ecommerce_dw.product_performance
[0m22:57:46.438513 [info ] [Thread-3 (]: 3 of 4 START sql table model public.daily_sales ................................ [RUN]
[0m22:57:46.439351 [info ] [Thread-2 (]: 2 of 4 START sql table model public.customer_ltv ............................... [RUN]
[0m22:57:46.440049 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_dw.daily_sales'
[0m22:57:46.439748 [info ] [Thread-4 (]: 4 of 4 START sql table model public.product_performance ........................ [RUN]
[0m22:57:46.440398 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.ecommerce_dw.customer_ltv'
[0m22:57:46.440611 [debug] [Thread-3 (]: Began compiling node model.ecommerce_dw.daily_sales
[0m22:57:46.440880 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.ecommerce_dw.product_performance'
[0m22:57:46.441117 [debug] [Thread-2 (]: Began compiling node model.ecommerce_dw.customer_ltv
[0m22:57:46.442622 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_dw.daily_sales"
[0m22:57:46.442856 [debug] [Thread-4 (]: Began compiling node model.ecommerce_dw.product_performance
[0m22:57:46.444564 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_dw.customer_ltv"
[0m22:57:46.446086 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_dw.product_performance"
[0m22:57:46.447231 [debug] [Thread-3 (]: Began executing node model.ecommerce_dw.daily_sales
[0m22:57:46.447567 [debug] [Thread-4 (]: Began executing node model.ecommerce_dw.product_performance
[0m22:57:46.458720 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_dw.daily_sales"
[0m22:57:46.460537 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_dw.product_performance"
[0m22:57:46.460797 [debug] [Thread-2 (]: Began executing node model.ecommerce_dw.customer_ltv
[0m22:57:46.462629 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_dw.customer_ltv"
[0m22:57:46.463275 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_dw.daily_sales"
[0m22:57:46.463481 [debug] [Thread-3 (]: On model.ecommerce_dw.daily_sales: BEGIN
[0m22:57:46.463702 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:57:46.464120 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_dw.product_performance"
[0m22:57:46.464391 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_dw.customer_ltv"
[0m22:57:46.464596 [debug] [Thread-4 (]: On model.ecommerce_dw.product_performance: BEGIN
[0m22:57:46.464803 [debug] [Thread-2 (]: On model.ecommerce_dw.customer_ltv: BEGIN
[0m22:57:46.465019 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:57:46.465258 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:57:46.471749 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m22:57:46.471974 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_dw.daily_sales"
[0m22:57:46.472151 [debug] [Thread-3 (]: On model.ecommerce_dw.daily_sales: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.daily_sales"} */

  
    

  create  table "ecommerce_dw"."public"."daily_sales__dbt_tmp"
  
  
    as
  
  (
    -- Daily Sales Aggregations
-- Business metrics aggregated by day



SELECT 
    full_date,
    year,
    month,
    quarter,
    
    COUNT(DISTINCT order_id) as total_orders,
    COUNT(DISTINCT user_id) as unique_customers,
    SUM(quantity) as total_items_sold,
    SUM(revenue) as total_revenue,
    AVG(revenue) as avg_order_value,
    MAX(revenue) as max_order_value,
    MIN(revenue) as min_order_value
    
FROM "ecommerce_dw"."public"."stg_sales"
GROUP BY full_date, year, month, quarter
ORDER BY full_date DESC
  );
  
[0m22:57:46.473033 [debug] [Thread-4 (]: SQL status: BEGIN in 0.008 seconds
[0m22:57:46.473261 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m22:57:46.473476 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_dw.product_performance"
[0m22:57:46.473712 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_dw.customer_ltv"
[0m22:57:46.473951 [debug] [Thread-4 (]: On model.ecommerce_dw.product_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.product_performance"} */

  
    

  create  table "ecommerce_dw"."public"."product_performance__dbt_tmp"
  
  
    as
  
  (
    -- Product Performance Analytics
-- Product-level metrics



SELECT 
    product_id,
    product_title,
    category,
    
    COUNT(DISTINCT order_id) as times_ordered,
    SUM(quantity) as total_units_sold,
    SUM(revenue) as total_revenue,
    AVG(unit_price) as avg_sale_price,
    
    -- Performance metrics
    RANK() OVER (ORDER BY SUM(revenue) DESC) as revenue_rank,
    RANK() OVER (PARTITION BY category ORDER BY SUM(revenue) DESC) as category_rank,
    
    -- Calculate what % of total revenue
    ROUND(
        100.0 * SUM(revenue) / SUM(SUM(revenue)) OVER (),
        2
    ) as pct_of_total_revenue
    
FROM "ecommerce_dw"."public"."stg_sales"
GROUP BY product_id, product_title, category
ORDER BY total_revenue DESC
  );
  
[0m22:57:46.474206 [debug] [Thread-2 (]: On model.ecommerce_dw.customer_ltv: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.customer_ltv"} */

  
    

  create  table "ecommerce_dw"."public"."customer_ltv__dbt_tmp"
  
  
    as
  
  (
    -- Customer Lifetime Value
-- Aggregated customer metrics



SELECT 
    user_id,
    username,
    email,
    
    COUNT(DISTINCT order_id) as lifetime_orders,
    SUM(revenue) as lifetime_value,
    AVG(revenue) as avg_order_value,
    SUM(quantity) as total_items_purchased,
    
    MIN(created_at) as first_order_date,
    MAX(created_at) as last_order_date,
    
    -- Calculate days between first and last order
    EXTRACT(DAY FROM (MAX(created_at) - MIN(created_at))) as customer_tenure_days,
    
    -- Categorize customers
    CASE 
        WHEN COUNT(DISTINCT order_id) >= 10 THEN 'VIP'
        WHEN COUNT(DISTINCT order_id) >= 5 THEN 'Regular'
        ELSE 'Casual'
    END as customer_segment
    
FROM "ecommerce_dw"."public"."stg_sales"
GROUP BY user_id, username, email
ORDER BY lifetime_value DESC
  );
  
[0m22:57:46.479692 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.007 seconds
[0m22:57:46.483222 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_dw.daily_sales"
[0m22:57:46.483467 [debug] [Thread-4 (]: SQL status: SELECT 20 in 0.009 seconds
[0m22:57:46.483725 [debug] [Thread-3 (]: On model.ecommerce_dw.daily_sales: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.daily_sales"} */
alter table "ecommerce_dw"."public"."daily_sales__dbt_tmp" rename to "daily_sales"
[0m22:57:46.483927 [debug] [Thread-2 (]: SQL status: SELECT 10 in 0.009 seconds
[0m22:57:46.485492 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_dw.product_performance"
[0m22:57:46.486844 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_dw.customer_ltv"
[0m22:57:46.487037 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:57:46.487219 [debug] [Thread-4 (]: On model.ecommerce_dw.product_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.product_performance"} */
alter table "ecommerce_dw"."public"."product_performance__dbt_tmp" rename to "product_performance"
[0m22:57:46.487421 [debug] [Thread-2 (]: On model.ecommerce_dw.customer_ltv: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.customer_ltv"} */
alter table "ecommerce_dw"."public"."customer_ltv__dbt_tmp" rename to "customer_ltv"
[0m22:57:46.488575 [debug] [Thread-3 (]: On model.ecommerce_dw.daily_sales: COMMIT
[0m22:57:46.489002 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_dw.daily_sales"
[0m22:57:46.489230 [debug] [Thread-3 (]: On model.ecommerce_dw.daily_sales: COMMIT
[0m22:57:46.489445 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:57:46.489661 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:57:46.490371 [debug] [Thread-4 (]: On model.ecommerce_dw.product_performance: COMMIT
[0m22:57:46.491072 [debug] [Thread-2 (]: On model.ecommerce_dw.customer_ltv: COMMIT
[0m22:57:46.491276 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m22:57:46.491493 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_dw.product_performance"
[0m22:57:46.491712 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_dw.customer_ltv"
[0m22:57:46.492987 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_dw"."public"."daily_sales__dbt_backup"
[0m22:57:46.493218 [debug] [Thread-4 (]: On model.ecommerce_dw.product_performance: COMMIT
[0m22:57:46.493434 [debug] [Thread-2 (]: On model.ecommerce_dw.customer_ltv: COMMIT
[0m22:57:46.494958 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_dw.daily_sales"
[0m22:57:46.495462 [debug] [Thread-3 (]: On model.ecommerce_dw.daily_sales: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.daily_sales"} */
drop table if exists "ecommerce_dw"."public"."daily_sales__dbt_backup" cascade
[0m22:57:46.495994 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.000 seconds
[0m22:57:46.496953 [debug] [Thread-3 (]: On model.ecommerce_dw.daily_sales: Close
[0m22:57:46.497187 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m22:57:46.498310 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_dw"."public"."customer_ltv__dbt_backup"
[0m22:57:46.498678 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_dw.customer_ltv"
[0m22:57:46.498977 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26a29352-c0dc-4426-807a-e3c16d9c44fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002274E4FD270>]}
[0m22:57:46.499191 [debug] [Thread-4 (]: SQL status: COMMIT in 0.004 seconds
[0m22:57:46.499387 [debug] [Thread-2 (]: On model.ecommerce_dw.customer_ltv: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.customer_ltv"} */
drop table if exists "ecommerce_dw"."public"."customer_ltv__dbt_backup" cascade
[0m22:57:46.500962 [debug] [Thread-4 (]: Applying DROP to: "ecommerce_dw"."public"."product_performance__dbt_backup"
[0m22:57:46.499806 [info ] [Thread-3 (]: 3 of 4 OK created sql table model public.daily_sales ........................... [[32mSELECT 1[0m in 0.06s]
[0m22:57:46.501433 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_dw.product_performance"
[0m22:57:46.501648 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.000 seconds
[0m22:57:46.501966 [debug] [Thread-3 (]: Finished running node model.ecommerce_dw.daily_sales
[0m22:57:46.502186 [debug] [Thread-4 (]: On model.ecommerce_dw.product_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.product_performance"} */
drop table if exists "ecommerce_dw"."public"."product_performance__dbt_backup" cascade
[0m22:57:46.502873 [debug] [Thread-2 (]: On model.ecommerce_dw.customer_ltv: Close
[0m22:57:46.503363 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26a29352-c0dc-4426-807a-e3c16d9c44fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002274E029350>]}
[0m22:57:46.503595 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.000 seconds
[0m22:57:46.504655 [debug] [Thread-4 (]: On model.ecommerce_dw.product_performance: Close
[0m22:57:46.503939 [info ] [Thread-2 (]: 2 of 4 OK created sql table model public.customer_ltv .......................... [[32mSELECT 10[0m in 0.06s]
[0m22:57:46.505041 [debug] [Thread-2 (]: Finished running node model.ecommerce_dw.customer_ltv
[0m22:57:46.505296 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26a29352-c0dc-4426-807a-e3c16d9c44fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002274E4A6C10>]}
[0m22:57:46.505715 [info ] [Thread-4 (]: 4 of 4 OK created sql table model public.product_performance ................... [[32mSELECT 20[0m in 0.06s]
[0m22:57:46.506062 [debug] [Thread-4 (]: Finished running node model.ecommerce_dw.product_performance
[0m22:57:46.506796 [debug] [MainThread]: Using postgres connection "master"
[0m22:57:46.506967 [debug] [MainThread]: On master: BEGIN
[0m22:57:46.507097 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:57:46.513649 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m22:57:46.513913 [debug] [MainThread]: On master: COMMIT
[0m22:57:46.514077 [debug] [MainThread]: Using postgres connection "master"
[0m22:57:46.514212 [debug] [MainThread]: On master: COMMIT
[0m22:57:46.514608 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:57:46.514789 [debug] [MainThread]: On master: Close
[0m22:57:46.515026 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:57:46.515154 [debug] [MainThread]: Connection 'list_ecommerce_dw' was properly closed.
[0m22:57:46.515261 [debug] [MainThread]: Connection 'list_ecommerce_dw_public' was properly closed.
[0m22:57:46.515374 [debug] [MainThread]: Connection 'model.ecommerce_dw.stg_sales' was properly closed.
[0m22:57:46.515473 [debug] [MainThread]: Connection 'model.ecommerce_dw.daily_sales' was properly closed.
[0m22:57:46.515572 [debug] [MainThread]: Connection 'model.ecommerce_dw.customer_ltv' was properly closed.
[0m22:57:46.515755 [debug] [MainThread]: Connection 'model.ecommerce_dw.product_performance' was properly closed.
[0m22:57:46.515964 [info ] [MainThread]: 
[0m22:57:46.516227 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m22:57:46.516807 [debug] [MainThread]: Command end result
[0m22:57:46.527964 [debug] [MainThread]: Wrote artifact WritableManifest to D:\ML Projects\ECommerce-Sales-Warehouse\dbt_project\target\manifest.json
[0m22:57:46.529176 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\ML Projects\ECommerce-Sales-Warehouse\dbt_project\target\semantic_manifest.json
[0m22:57:46.532571 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\ML Projects\ECommerce-Sales-Warehouse\dbt_project\target\run_results.json
[0m22:57:46.532759 [info ] [MainThread]: 
[0m22:57:46.533044 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:57:46.533259 [info ] [MainThread]: 
[0m22:57:46.533449 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m22:57:46.533913 [debug] [MainThread]: Command `dbt run` succeeded at 22:57:46.533851 after 1.87 seconds
[0m22:57:46.534099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002274CB31190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022748E36630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002274E4DCA70>]}
[0m22:57:46.534276 [debug] [MainThread]: Flushing usage events
[0m22:57:47.016177 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:48:53.420733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F34C674C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F34E6AFED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F34E6AFB10>]}


============================== 20:48:53.423656 | 59151721-b627-4b2d-961d-46a622bc6cd5 ==============================
[0m20:48:53.423656 [info ] [MainThread]: Running with dbt=1.11.4
[0m20:48:53.424057 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'profiles_dir': '.', 'use_colors': 'True', 'invocation_command': 'dbt debug --profiles-dir .', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'D:\\ML Projects\\ECommerce-Sales-Warehouse\\dbt_project\\logs'}
[0m20:48:53.430770 [info ] [MainThread]: dbt version: 1.11.4
[0m20:48:53.431036 [info ] [MainThread]: python version: 3.13.12
[0m20:48:53.431244 [info ] [MainThread]: python path: D:\ML Projects\ECommerce-Sales-Warehouse\venv\Scripts\python.exe
[0m20:48:53.431428 [info ] [MainThread]: os info: Windows-11-10.0.26200-SP0
[0m20:48:53.497642 [info ] [MainThread]: Using profiles dir at .
[0m20:48:53.497979 [info ] [MainThread]: Using profiles.yml file at .\profiles.yml
[0m20:48:53.498231 [info ] [MainThread]: Using dbt_project.yml file at D:\ML Projects\ECommerce-Sales-Warehouse\dbt_project\dbt_project.yml
[0m20:48:53.498612 [info ] [MainThread]: adapter type: postgres
[0m20:48:53.498886 [info ] [MainThread]: adapter version: 1.8.0
[0m20:48:53.559899 [info ] [MainThread]: Configuration:
[0m20:48:53.560263 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:48:53.560477 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:48:53.560647 [info ] [MainThread]: Required dependencies:
[0m20:48:53.561017 [debug] [MainThread]: Executing "git --help"
[0m20:48:53.585611 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Set `HEAD` or the index to a known state\n   switch     Switch branches\n   tag        Create, list, delete or verify tags\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:48:53.585919 [debug] [MainThread]: STDERR: "b''"
[0m20:48:53.586135 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:48:53.586400 [info ] [MainThread]: Connection:
[0m20:48:53.586682 [info ] [MainThread]:   host: localhost
[0m20:48:53.586931 [info ] [MainThread]:   port: 5432
[0m20:48:53.587130 [info ] [MainThread]:   user: user
[0m20:48:53.587306 [info ] [MainThread]:   database: ecommerce_dw
[0m20:48:53.587466 [info ] [MainThread]:   schema: public
[0m20:48:53.587629 [info ] [MainThread]:   connect_timeout: 10
[0m20:48:53.587777 [info ] [MainThread]:   role: None
[0m20:48:53.587918 [info ] [MainThread]:   search_path: None
[0m20:48:53.588057 [info ] [MainThread]:   keepalives_idle: 0
[0m20:48:53.588204 [info ] [MainThread]:   sslmode: None
[0m20:48:53.588347 [info ] [MainThread]:   sslcert: None
[0m20:48:53.588488 [info ] [MainThread]:   sslkey: None
[0m20:48:53.588691 [info ] [MainThread]:   sslrootcert: None
[0m20:48:53.588879 [info ] [MainThread]:   application_name: dbt
[0m20:48:53.589079 [info ] [MainThread]:   retries: 1
[0m20:48:53.589374 [info ] [MainThread]: Registered adapter: postgres=1.8.0
[0m20:48:53.681849 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m20:48:53.703691 [debug] [MainThread]: Using postgres connection "debug"
[0m20:48:53.703904 [debug] [MainThread]: On debug: select 1 as id
[0m20:48:53.704048 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:48:53.715790 [debug] [MainThread]: SQL status: SELECT 1 in 0.012 seconds
[0m20:48:53.716489 [debug] [MainThread]: On debug: Close
[0m20:48:53.716739 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m20:48:53.717049 [info ] [MainThread]: [32mAll checks passed![0m
[0m20:48:53.717540 [debug] [MainThread]: Command `dbt debug` succeeded at 20:48:53.717465 after 0.40 seconds
[0m20:48:53.717713 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:48:53.717876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F34EC38770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F34ECBC710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F34E74E9C0>]}
[0m20:48:53.718103 [debug] [MainThread]: Flushing usage events
[0m20:48:54.178274 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:49:04.846000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3E9C84C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3EBCB3ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3EBCB3B10>]}


============================== 20:49:04.848533 | 16230bd0-7de1-4826-a990-95ae3feace2b ==============================
[0m20:49:04.848533 [info ] [MainThread]: Running with dbt=1.11.4
[0m20:49:04.848944 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': '.', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt run --profiles-dir .', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'D:\\ML Projects\\ECommerce-Sales-Warehouse\\dbt_project\\logs'}
[0m20:49:04.943061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '16230bd0-7de1-4826-a990-95ae3feace2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3E9F09810>]}
[0m20:49:04.980482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '16230bd0-7de1-4826-a990-95ae3feace2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3EBB1F350>]}
[0m20:49:04.981069 [info ] [MainThread]: Registered adapter: postgres=1.8.0
[0m20:49:05.081106 [debug] [MainThread]: checksum: 092b177ba87eb6bb3c55954c38aa57900eebac336561eb9ee32218428aa81d43, vars: {}, profile: , target: , version: 1.11.4
[0m20:49:05.129202 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:49:05.129418 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m20:49:05.129551 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:49:05.143326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '16230bd0-7de1-4826-a990-95ae3feace2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3EBD4DA50>]}
[0m20:49:05.172087 [debug] [MainThread]: Wrote artifact WritableManifest to D:\ML Projects\ECommerce-Sales-Warehouse\dbt_project\target\manifest.json
[0m20:49:05.173286 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\ML Projects\ECommerce-Sales-Warehouse\dbt_project\target\semantic_manifest.json
[0m20:49:05.182919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '16230bd0-7de1-4826-a990-95ae3feace2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3EBB41130>]}
[0m20:49:05.183168 [info ] [MainThread]: Found 4 models, 462 macros
[0m20:49:05.183434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16230bd0-7de1-4826-a990-95ae3feace2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3EBE642F0>]}
[0m20:49:05.184378 [info ] [MainThread]: 
[0m20:49:05.184638 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:49:05.185205 [info ] [MainThread]: 
[0m20:49:05.185562 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:49:05.187679 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_dw'
[0m20:49:05.215225 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_dw"
[0m20:49:05.215447 [debug] [ThreadPool]: On list_ecommerce_dw: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "connection_name": "list_ecommerce_dw"} */

    select distinct nspname from pg_namespace
  
[0m20:49:05.215594 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:49:05.227861 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.012 seconds
[0m20:49:05.228606 [debug] [ThreadPool]: On list_ecommerce_dw: Close
[0m20:49:05.229596 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_dw_public'
[0m20:49:05.232574 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_dw_public"
[0m20:49:05.232754 [debug] [ThreadPool]: On list_ecommerce_dw_public: BEGIN
[0m20:49:05.232885 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:49:05.240145 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m20:49:05.240381 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_dw_public"
[0m20:49:05.240538 [debug] [ThreadPool]: On list_ecommerce_dw_public: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "connection_name": "list_ecommerce_dw_public"} */
select
      'ecommerce_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m20:49:05.243164 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.002 seconds
[0m20:49:05.243970 [debug] [ThreadPool]: On list_ecommerce_dw_public: ROLLBACK
[0m20:49:05.244429 [debug] [ThreadPool]: On list_ecommerce_dw_public: Close
[0m20:49:05.247487 [debug] [MainThread]: Using postgres connection "master"
[0m20:49:05.247789 [debug] [MainThread]: On master: BEGIN
[0m20:49:05.247953 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:49:05.254704 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m20:49:05.254911 [debug] [MainThread]: Using postgres connection "master"
[0m20:49:05.255088 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:49:05.258292 [debug] [MainThread]: SQL status: SELECT 6 in 0.003 seconds
[0m20:49:05.259525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16230bd0-7de1-4826-a990-95ae3feace2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3ED417C70>]}
[0m20:49:05.259870 [debug] [MainThread]: On master: ROLLBACK
[0m20:49:05.260292 [debug] [MainThread]: Using postgres connection "master"
[0m20:49:05.260452 [debug] [MainThread]: On master: BEGIN
[0m20:49:05.260993 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:49:05.261172 [debug] [MainThread]: On master: COMMIT
[0m20:49:05.261321 [debug] [MainThread]: Using postgres connection "master"
[0m20:49:05.261447 [debug] [MainThread]: On master: COMMIT
[0m20:49:05.261774 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:49:05.261960 [debug] [MainThread]: On master: Close
[0m20:49:05.265511 [debug] [Thread-1 (]: Began running node model.ecommerce_dw.stg_sales
[0m20:49:05.265793 [info ] [Thread-1 (]: 1 of 4 START sql view model public.stg_sales ................................... [RUN]
[0m20:49:05.266168 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.ecommerce_dw.stg_sales'
[0m20:49:05.266366 [debug] [Thread-1 (]: Began compiling node model.ecommerce_dw.stg_sales
[0m20:49:05.270136 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_dw.stg_sales"
[0m20:49:05.270582 [debug] [Thread-1 (]: Began executing node model.ecommerce_dw.stg_sales
[0m20:49:05.289208 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_dw.stg_sales"
[0m20:49:05.289822 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dw.stg_sales"
[0m20:49:05.290036 [debug] [Thread-1 (]: On model.ecommerce_dw.stg_sales: BEGIN
[0m20:49:05.290191 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:49:05.296669 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m20:49:05.296894 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dw.stg_sales"
[0m20:49:05.297078 [debug] [Thread-1 (]: On model.ecommerce_dw.stg_sales: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.stg_sales"} */

  create view "ecommerce_dw"."public"."stg_sales__dbt_tmp"
    
    
  as (
    -- Staging model: Clean fact_sales data
-- This is a foundation for marts



SELECT 
    f.sale_id,
    f.order_id,
    f.user_id,
    f.product_id,
    f.date_id,
    f.quantity,
    f.unit_price,
    f.revenue,
    f.created_at,
    
    -- Join dimension data for easier querying
    p.product_title,
    p.category,
    u.username,
    u.email,
    d.full_date,
    d.year,
    d.month,
    d.quarter
    
FROM fact_sales f
LEFT JOIN dim_product p ON f.product_id = p.product_id
LEFT JOIN dim_user u ON f.user_id = u.user_id
LEFT JOIN dim_date d ON f.date_id = d.date_id
WHERE f.created_at IS NOT NULL
  );
[0m20:49:05.298969 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m20:49:05.302259 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dw.stg_sales"
[0m20:49:05.302471 [debug] [Thread-1 (]: On model.ecommerce_dw.stg_sales: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.stg_sales"} */
alter table "ecommerce_dw"."public"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m20:49:05.303293 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:49:05.310622 [debug] [Thread-1 (]: On model.ecommerce_dw.stg_sales: COMMIT
[0m20:49:05.310829 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dw.stg_sales"
[0m20:49:05.310986 [debug] [Thread-1 (]: On model.ecommerce_dw.stg_sales: COMMIT
[0m20:49:05.312883 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:49:05.315897 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_dw"."public"."stg_sales__dbt_backup"
[0m20:49:05.318915 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dw.stg_sales"
[0m20:49:05.319120 [debug] [Thread-1 (]: On model.ecommerce_dw.stg_sales: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.stg_sales"} */
drop view if exists "ecommerce_dw"."public"."stg_sales__dbt_backup" cascade
[0m20:49:05.319841 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m20:49:05.321071 [debug] [Thread-1 (]: On model.ecommerce_dw.stg_sales: Close
[0m20:49:05.322226 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16230bd0-7de1-4826-a990-95ae3feace2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3ED273A10>]}
[0m20:49:05.322631 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public.stg_sales .............................. [[32mCREATE VIEW[0m in 0.06s]
[0m20:49:05.323008 [debug] [Thread-1 (]: Finished running node model.ecommerce_dw.stg_sales
[0m20:49:05.323407 [debug] [Thread-3 (]: Began running node model.ecommerce_dw.daily_sales
[0m20:49:05.323618 [debug] [Thread-4 (]: Began running node model.ecommerce_dw.product_performance
[0m20:49:05.323913 [debug] [Thread-2 (]: Began running node model.ecommerce_dw.customer_ltv
[0m20:49:05.324194 [info ] [Thread-3 (]: 3 of 4 START sql table model public.daily_sales ................................ [RUN]
[0m20:49:05.325065 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_dw.daily_sales'
[0m20:49:05.324461 [info ] [Thread-4 (]: 4 of 4 START sql table model public.product_performance ........................ [RUN]
[0m20:49:05.325312 [debug] [Thread-3 (]: Began compiling node model.ecommerce_dw.daily_sales
[0m20:49:05.325545 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.ecommerce_dw.product_performance'
[0m20:49:05.324803 [info ] [Thread-2 (]: 2 of 4 START sql table model public.customer_ltv ............................... [RUN]
[0m20:49:05.328558 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_dw.daily_sales"
[0m20:49:05.328778 [debug] [Thread-4 (]: Began compiling node model.ecommerce_dw.product_performance
[0m20:49:05.329066 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.ecommerce_dw.customer_ltv'
[0m20:49:05.330436 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_dw.product_performance"
[0m20:49:05.330666 [debug] [Thread-2 (]: Began compiling node model.ecommerce_dw.customer_ltv
[0m20:49:05.332160 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_dw.customer_ltv"
[0m20:49:05.332385 [debug] [Thread-3 (]: Began executing node model.ecommerce_dw.daily_sales
[0m20:49:05.378688 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_dw.daily_sales"
[0m20:49:05.379102 [debug] [Thread-4 (]: Began executing node model.ecommerce_dw.product_performance
[0m20:49:05.380950 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_dw.product_performance"
[0m20:49:05.381349 [debug] [Thread-2 (]: Began executing node model.ecommerce_dw.customer_ltv
[0m20:49:05.382960 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_dw.customer_ltv"
[0m20:49:05.383231 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_dw.daily_sales"
[0m20:49:05.383549 [debug] [Thread-3 (]: On model.ecommerce_dw.daily_sales: BEGIN
[0m20:49:05.383825 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:49:05.384072 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_dw.product_performance"
[0m20:49:05.384391 [debug] [Thread-4 (]: On model.ecommerce_dw.product_performance: BEGIN
[0m20:49:05.385065 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:49:05.385313 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_dw.customer_ltv"
[0m20:49:05.385604 [debug] [Thread-2 (]: On model.ecommerce_dw.customer_ltv: BEGIN
[0m20:49:05.385799 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:49:05.392225 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m20:49:05.392477 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_dw.daily_sales"
[0m20:49:05.392660 [debug] [Thread-3 (]: On model.ecommerce_dw.daily_sales: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.daily_sales"} */

  
    

  create  table "ecommerce_dw"."public"."daily_sales__dbt_tmp"
  
  
    as
  
  (
    -- Daily Sales Aggregations
-- Business metrics aggregated by day



SELECT 
    full_date,
    year,
    month,
    quarter,
    
    COUNT(DISTINCT order_id) as total_orders,
    COUNT(DISTINCT user_id) as unique_customers,
    SUM(quantity) as total_items_sold,
    SUM(revenue) as total_revenue,
    AVG(revenue) as avg_order_value,
    MAX(revenue) as max_order_value,
    MIN(revenue) as min_order_value
    
FROM "ecommerce_dw"."public"."stg_sales"
GROUP BY full_date, year, month, quarter
ORDER BY full_date DESC
  );
  
[0m20:49:05.393442 [debug] [Thread-4 (]: SQL status: BEGIN in 0.008 seconds
[0m20:49:05.393671 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_dw.product_performance"
[0m20:49:05.393854 [debug] [Thread-4 (]: On model.ecommerce_dw.product_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.product_performance"} */

  
    

  create  table "ecommerce_dw"."public"."product_performance__dbt_tmp"
  
  
    as
  
  (
    -- Product Performance Analytics
-- Product-level metrics



SELECT 
    product_id,
    product_title,
    category,
    
    COUNT(DISTINCT order_id) as times_ordered,
    SUM(quantity) as total_units_sold,
    SUM(revenue) as total_revenue,
    AVG(unit_price) as avg_sale_price,
    
    -- Performance metrics
    RANK() OVER (ORDER BY SUM(revenue) DESC) as revenue_rank,
    RANK() OVER (PARTITION BY category ORDER BY SUM(revenue) DESC) as category_rank,
    
    -- Calculate what % of total revenue
    ROUND(
        100.0 * SUM(revenue) / SUM(SUM(revenue)) OVER (),
        2
    ) as pct_of_total_revenue
    
FROM "ecommerce_dw"."public"."stg_sales"
GROUP BY product_id, product_title, category
ORDER BY total_revenue DESC
  );
  
[0m20:49:05.397980 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.005 seconds
[0m20:49:05.401661 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_dw.daily_sales"
[0m20:49:05.401934 [debug] [Thread-3 (]: On model.ecommerce_dw.daily_sales: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.daily_sales"} */
alter table "ecommerce_dw"."public"."daily_sales__dbt_tmp" rename to "daily_sales"
[0m20:49:05.402342 [debug] [Thread-4 (]: SQL status: SELECT 20 in 0.008 seconds
[0m20:49:05.402584 [debug] [Thread-2 (]: SQL status: BEGIN in 0.017 seconds
[0m20:49:05.404217 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_dw.product_performance"
[0m20:49:05.404427 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m20:49:05.404616 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_dw.customer_ltv"
[0m20:49:05.404849 [debug] [Thread-4 (]: On model.ecommerce_dw.product_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.product_performance"} */
alter table "ecommerce_dw"."public"."product_performance__dbt_tmp" rename to "product_performance"
[0m20:49:05.405541 [debug] [Thread-3 (]: On model.ecommerce_dw.daily_sales: COMMIT
[0m20:49:05.405786 [debug] [Thread-2 (]: On model.ecommerce_dw.customer_ltv: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.customer_ltv"} */

  
    

  create  table "ecommerce_dw"."public"."customer_ltv__dbt_tmp"
  
  
    as
  
  (
    -- Customer Lifetime Value
-- Aggregated customer metrics



SELECT 
    user_id,
    username,
    email,
    
    COUNT(DISTINCT order_id) as lifetime_orders,
    SUM(revenue) as lifetime_value,
    AVG(revenue) as avg_order_value,
    SUM(quantity) as total_items_purchased,
    
    MIN(created_at) as first_order_date,
    MAX(created_at) as last_order_date,
    
    -- Calculate days between first and last order
    EXTRACT(DAY FROM (MAX(created_at) - MIN(created_at))) as customer_tenure_days,
    
    -- Categorize customers
    CASE 
        WHEN COUNT(DISTINCT order_id) >= 10 THEN 'VIP'
        WHEN COUNT(DISTINCT order_id) >= 5 THEN 'Regular'
        ELSE 'Casual'
    END as customer_segment
    
FROM "ecommerce_dw"."public"."stg_sales"
GROUP BY user_id, username, email
ORDER BY lifetime_value DESC
  );
  
[0m20:49:05.406086 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_dw.daily_sales"
[0m20:49:05.406337 [debug] [Thread-3 (]: On model.ecommerce_dw.daily_sales: COMMIT
[0m20:49:05.406537 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:49:05.407246 [debug] [Thread-4 (]: On model.ecommerce_dw.product_performance: COMMIT
[0m20:49:05.407434 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_dw.product_performance"
[0m20:49:05.407591 [debug] [Thread-4 (]: On model.ecommerce_dw.product_performance: COMMIT
[0m20:49:05.408118 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m20:49:05.409155 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_dw"."public"."daily_sales__dbt_backup"
[0m20:49:05.409374 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m20:49:05.410972 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_dw.daily_sales"
[0m20:49:05.411188 [debug] [Thread-2 (]: SQL status: SELECT 10 in 0.005 seconds
[0m20:49:05.412490 [debug] [Thread-4 (]: Applying DROP to: "ecommerce_dw"."public"."product_performance__dbt_backup"
[0m20:49:05.412756 [debug] [Thread-3 (]: On model.ecommerce_dw.daily_sales: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.daily_sales"} */
drop table if exists "ecommerce_dw"."public"."daily_sales__dbt_backup" cascade
[0m20:49:05.414283 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_dw.customer_ltv"
[0m20:49:05.414689 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_dw.product_performance"
[0m20:49:05.414972 [debug] [Thread-2 (]: On model.ecommerce_dw.customer_ltv: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.customer_ltv"} */
alter table "ecommerce_dw"."public"."customer_ltv__dbt_tmp" rename to "customer_ltv"
[0m20:49:05.415201 [debug] [Thread-4 (]: On model.ecommerce_dw.product_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.product_performance"} */
drop table if exists "ecommerce_dw"."public"."product_performance__dbt_backup" cascade
[0m20:49:05.415404 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.001 seconds
[0m20:49:05.416178 [debug] [Thread-3 (]: On model.ecommerce_dw.daily_sales: Close
[0m20:49:05.416415 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.001 seconds
[0m20:49:05.416786 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16230bd0-7de1-4826-a990-95ae3feace2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3ED29F490>]}
[0m20:49:05.417004 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:49:05.417679 [debug] [Thread-4 (]: On model.ecommerce_dw.product_performance: Close
[0m20:49:05.418775 [debug] [Thread-2 (]: On model.ecommerce_dw.customer_ltv: COMMIT
[0m20:49:05.418038 [info ] [Thread-3 (]: 3 of 4 OK created sql table model public.daily_sales ........................... [[32mSELECT 1[0m in 0.09s]
[0m20:49:05.419099 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_dw.customer_ltv"
[0m20:49:05.419367 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16230bd0-7de1-4826-a990-95ae3feace2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3ED65B930>]}
[0m20:49:05.419704 [debug] [Thread-3 (]: Finished running node model.ecommerce_dw.daily_sales
[0m20:49:05.419925 [debug] [Thread-2 (]: On model.ecommerce_dw.customer_ltv: COMMIT
[0m20:49:05.420286 [info ] [Thread-4 (]: 4 of 4 OK created sql table model public.product_performance ................... [[32mSELECT 20[0m in 0.09s]
[0m20:49:05.420778 [debug] [Thread-4 (]: Finished running node model.ecommerce_dw.product_performance
[0m20:49:05.421883 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m20:49:05.423113 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_dw"."public"."customer_ltv__dbt_backup"
[0m20:49:05.423485 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_dw.customer_ltv"
[0m20:49:05.423704 [debug] [Thread-2 (]: On model.ecommerce_dw.customer_ltv: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.customer_ltv"} */
drop table if exists "ecommerce_dw"."public"."customer_ltv__dbt_backup" cascade
[0m20:49:05.424213 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.000 seconds
[0m20:49:05.424884 [debug] [Thread-2 (]: On model.ecommerce_dw.customer_ltv: Close
[0m20:49:05.425213 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16230bd0-7de1-4826-a990-95ae3feace2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3EBE4D050>]}
[0m20:49:05.425546 [info ] [Thread-2 (]: 2 of 4 OK created sql table model public.customer_ltv .......................... [[32mSELECT 10[0m in 0.10s]
[0m20:49:05.425889 [debug] [Thread-2 (]: Finished running node model.ecommerce_dw.customer_ltv
[0m20:49:05.426683 [debug] [MainThread]: Using postgres connection "master"
[0m20:49:05.426863 [debug] [MainThread]: On master: BEGIN
[0m20:49:05.427002 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:49:05.433543 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m20:49:05.433796 [debug] [MainThread]: On master: COMMIT
[0m20:49:05.433951 [debug] [MainThread]: Using postgres connection "master"
[0m20:49:05.434090 [debug] [MainThread]: On master: COMMIT
[0m20:49:05.434437 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:49:05.434650 [debug] [MainThread]: On master: Close
[0m20:49:05.435090 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:49:05.435401 [debug] [MainThread]: Connection 'list_ecommerce_dw' was properly closed.
[0m20:49:05.435586 [debug] [MainThread]: Connection 'list_ecommerce_dw_public' was properly closed.
[0m20:49:05.435791 [debug] [MainThread]: Connection 'model.ecommerce_dw.stg_sales' was properly closed.
[0m20:49:05.435932 [debug] [MainThread]: Connection 'model.ecommerce_dw.daily_sales' was properly closed.
[0m20:49:05.436055 [debug] [MainThread]: Connection 'model.ecommerce_dw.product_performance' was properly closed.
[0m20:49:05.436173 [debug] [MainThread]: Connection 'model.ecommerce_dw.customer_ltv' was properly closed.
[0m20:49:05.436354 [info ] [MainThread]: 
[0m20:49:05.436598 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m20:49:05.437331 [debug] [MainThread]: Command end result
[0m20:49:05.446321 [debug] [MainThread]: Wrote artifact WritableManifest to D:\ML Projects\ECommerce-Sales-Warehouse\dbt_project\target\manifest.json
[0m20:49:05.447538 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\ML Projects\ECommerce-Sales-Warehouse\dbt_project\target\semantic_manifest.json
[0m20:49:05.450841 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\ML Projects\ECommerce-Sales-Warehouse\dbt_project\target\run_results.json
[0m20:49:05.451026 [info ] [MainThread]: 
[0m20:49:05.451307 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:49:05.451580 [info ] [MainThread]: 
[0m20:49:05.451985 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m20:49:05.452510 [debug] [MainThread]: Command `dbt run` succeeded at 20:49:05.452442 after 0.68 seconds
[0m20:49:05.452703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3EBD1C8A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3E5A79E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3E96CA390>]}
[0m20:49:05.452884 [debug] [MainThread]: Flushing usage events
[0m20:49:05.941929 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:15:07.725320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D01A464C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D01C3B3ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D01C3B3B10>]}


============================== 21:15:07.727885 | 42fa28a3-ba3d-4cf5-81b4-4a827b77c390 ==============================
[0m21:15:07.727885 [info ] [MainThread]: Running with dbt=1.11.4
[0m21:15:07.728314 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': '.', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt run --profiles-dir .', 'use_colors': 'True', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'D:\\ML Projects\\ECommerce-Sales-Warehouse\\dbt_project\\logs'}
[0m21:15:07.818853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '42fa28a3-ba3d-4cf5-81b4-4a827b77c390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D01A6ED940>]}
[0m21:15:07.855665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '42fa28a3-ba3d-4cf5-81b4-4a827b77c390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D01C21F350>]}
[0m21:15:07.856276 [info ] [MainThread]: Registered adapter: postgres=1.8.0
[0m21:15:07.951796 [debug] [MainThread]: checksum: 092b177ba87eb6bb3c55954c38aa57900eebac336561eb9ee32218428aa81d43, vars: {}, profile: , target: , version: 1.11.4
[0m21:15:08.000540 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:15:08.000837 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m21:15:08.001190 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:15:08.018491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '42fa28a3-ba3d-4cf5-81b4-4a827b77c390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D01C44DA50>]}
[0m21:15:08.048990 [debug] [MainThread]: Wrote artifact WritableManifest to D:\ML Projects\ECommerce-Sales-Warehouse\dbt_project\target\manifest.json
[0m21:15:08.050345 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\ML Projects\ECommerce-Sales-Warehouse\dbt_project\target\semantic_manifest.json
[0m21:15:08.059723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '42fa28a3-ba3d-4cf5-81b4-4a827b77c390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D01C241130>]}
[0m21:15:08.059983 [info ] [MainThread]: Found 4 models, 462 macros
[0m21:15:08.060223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42fa28a3-ba3d-4cf5-81b4-4a827b77c390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D01C5703D0>]}
[0m21:15:08.061566 [info ] [MainThread]: 
[0m21:15:08.061858 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:15:08.062137 [info ] [MainThread]: 
[0m21:15:08.062460 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:15:08.064593 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_dw'
[0m21:15:08.092915 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_dw"
[0m21:15:08.093155 [debug] [ThreadPool]: On list_ecommerce_dw: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "connection_name": "list_ecommerce_dw"} */

    select distinct nspname from pg_namespace
  
[0m21:15:08.093302 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:15:08.105556 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.012 seconds
[0m21:15:08.106341 [debug] [ThreadPool]: On list_ecommerce_dw: Close
[0m21:15:08.107364 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_dw_public'
[0m21:15:08.110436 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_dw_public"
[0m21:15:08.110617 [debug] [ThreadPool]: On list_ecommerce_dw_public: BEGIN
[0m21:15:08.110754 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:15:08.117034 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m21:15:08.117247 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_dw_public"
[0m21:15:08.117401 [debug] [ThreadPool]: On list_ecommerce_dw_public: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "connection_name": "list_ecommerce_dw_public"} */
select
      'ecommerce_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:15:08.119144 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.002 seconds
[0m21:15:08.120048 [debug] [ThreadPool]: On list_ecommerce_dw_public: ROLLBACK
[0m21:15:08.120510 [debug] [ThreadPool]: On list_ecommerce_dw_public: Close
[0m21:15:08.123880 [debug] [MainThread]: Using postgres connection "master"
[0m21:15:08.124052 [debug] [MainThread]: On master: BEGIN
[0m21:15:08.124183 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:15:08.148218 [debug] [MainThread]: SQL status: BEGIN in 0.024 seconds
[0m21:15:08.148446 [debug] [MainThread]: Using postgres connection "master"
[0m21:15:08.148628 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:15:08.151569 [debug] [MainThread]: SQL status: SELECT 10 in 0.003 seconds
[0m21:15:08.153249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42fa28a3-ba3d-4cf5-81b4-4a827b77c390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D01CB37EE0>]}
[0m21:15:08.153468 [debug] [MainThread]: On master: ROLLBACK
[0m21:15:08.153886 [debug] [MainThread]: Using postgres connection "master"
[0m21:15:08.154059 [debug] [MainThread]: On master: BEGIN
[0m21:15:08.154632 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:15:08.154811 [debug] [MainThread]: On master: COMMIT
[0m21:15:08.154956 [debug] [MainThread]: Using postgres connection "master"
[0m21:15:08.155083 [debug] [MainThread]: On master: COMMIT
[0m21:15:08.155453 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:15:08.155627 [debug] [MainThread]: On master: Close
[0m21:15:08.158474 [debug] [Thread-1 (]: Began running node model.ecommerce_dw.stg_sales
[0m21:15:08.158766 [info ] [Thread-1 (]: 1 of 4 START sql view model public.stg_sales ................................... [RUN]
[0m21:15:08.159218 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.ecommerce_dw.stg_sales'
[0m21:15:08.159413 [debug] [Thread-1 (]: Began compiling node model.ecommerce_dw.stg_sales
[0m21:15:08.162910 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_dw.stg_sales"
[0m21:15:08.163369 [debug] [Thread-1 (]: Began executing node model.ecommerce_dw.stg_sales
[0m21:15:08.181663 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_dw.stg_sales"
[0m21:15:08.182230 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dw.stg_sales"
[0m21:15:08.182429 [debug] [Thread-1 (]: On model.ecommerce_dw.stg_sales: BEGIN
[0m21:15:08.182603 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:15:08.189332 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m21:15:08.189555 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dw.stg_sales"
[0m21:15:08.189893 [debug] [Thread-1 (]: On model.ecommerce_dw.stg_sales: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.stg_sales"} */

  create view "ecommerce_dw"."public"."stg_sales__dbt_tmp"
    
    
  as (
    -- Staging model: Clean fact_sales data
-- This is a foundation for marts



SELECT 
    f.sale_id,
    f.order_id,
    f.user_id,
    f.product_id,
    f.date_id,
    f.quantity,
    f.unit_price,
    f.revenue,
    f.created_at,
    
    -- Join dimension data for easier querying
    p.product_title,
    p.category,
    u.username,
    u.email,
    d.full_date,
    d.year,
    d.month,
    d.quarter
    
FROM fact_sales f
LEFT JOIN dim_product p ON f.product_id = p.product_id
LEFT JOIN dim_user u ON f.user_id = u.user_id
LEFT JOIN dim_date d ON f.date_id = d.date_id
WHERE f.created_at IS NOT NULL
  );
[0m21:15:08.192168 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m21:15:08.195908 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dw.stg_sales"
[0m21:15:08.196130 [debug] [Thread-1 (]: On model.ecommerce_dw.stg_sales: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.stg_sales"} */
alter table "ecommerce_dw"."public"."stg_sales" rename to "stg_sales__dbt_backup"
[0m21:15:08.196836 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:15:08.198505 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dw.stg_sales"
[0m21:15:08.198751 [debug] [Thread-1 (]: On model.ecommerce_dw.stg_sales: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.stg_sales"} */
alter table "ecommerce_dw"."public"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m21:15:08.199462 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:15:08.207756 [debug] [Thread-1 (]: On model.ecommerce_dw.stg_sales: COMMIT
[0m21:15:08.207972 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dw.stg_sales"
[0m21:15:08.208142 [debug] [Thread-1 (]: On model.ecommerce_dw.stg_sales: COMMIT
[0m21:15:08.209772 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m21:15:08.212796 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_dw"."public"."stg_sales__dbt_backup"
[0m21:15:08.215401 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dw.stg_sales"
[0m21:15:08.215604 [debug] [Thread-1 (]: On model.ecommerce_dw.stg_sales: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.stg_sales"} */
drop view if exists "ecommerce_dw"."public"."stg_sales__dbt_backup" cascade
[0m21:15:08.217999 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m21:15:08.219217 [debug] [Thread-1 (]: On model.ecommerce_dw.stg_sales: Close
[0m21:15:08.220507 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42fa28a3-ba3d-4cf5-81b4-4a827b77c390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D01C97FC50>]}
[0m21:15:08.220925 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public.stg_sales .............................. [[32mCREATE VIEW[0m in 0.06s]
[0m21:15:08.221445 [debug] [Thread-1 (]: Finished running node model.ecommerce_dw.stg_sales
[0m21:15:08.221877 [debug] [Thread-3 (]: Began running node model.ecommerce_dw.daily_sales
[0m21:15:08.222107 [debug] [Thread-4 (]: Began running node model.ecommerce_dw.product_performance
[0m21:15:08.222350 [debug] [Thread-2 (]: Began running node model.ecommerce_dw.customer_ltv
[0m21:15:08.222645 [info ] [Thread-3 (]: 3 of 4 START sql table model public.daily_sales ................................ [RUN]
[0m21:15:08.223089 [info ] [Thread-4 (]: 4 of 4 START sql table model public.product_performance ........................ [RUN]
[0m21:15:08.225369 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_dw.daily_sales'
[0m21:15:08.225668 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.ecommerce_dw.product_performance'
[0m21:15:08.224975 [info ] [Thread-2 (]: 2 of 4 START sql table model public.customer_ltv ............................... [RUN]
[0m21:15:08.225949 [debug] [Thread-3 (]: Began compiling node model.ecommerce_dw.daily_sales
[0m21:15:08.226158 [debug] [Thread-4 (]: Began compiling node model.ecommerce_dw.product_performance
[0m21:15:08.226413 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.ecommerce_dw.customer_ltv'
[0m21:15:08.227806 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_dw.daily_sales"
[0m21:15:08.229134 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_dw.product_performance"
[0m21:15:08.229357 [debug] [Thread-2 (]: Began compiling node model.ecommerce_dw.customer_ltv
[0m21:15:08.262253 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_dw.customer_ltv"
[0m21:15:08.262675 [debug] [Thread-4 (]: Began executing node model.ecommerce_dw.product_performance
[0m21:15:08.262915 [debug] [Thread-3 (]: Began executing node model.ecommerce_dw.daily_sales
[0m21:15:08.274036 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_dw.product_performance"
[0m21:15:08.275740 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_dw.daily_sales"
[0m21:15:08.276150 [debug] [Thread-2 (]: Began executing node model.ecommerce_dw.customer_ltv
[0m21:15:08.277670 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_dw.customer_ltv"
[0m21:15:08.278096 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_dw.product_performance"
[0m21:15:08.278336 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_dw.customer_ltv"
[0m21:15:08.278560 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_dw.daily_sales"
[0m21:15:08.278786 [debug] [Thread-4 (]: On model.ecommerce_dw.product_performance: BEGIN
[0m21:15:08.279011 [debug] [Thread-2 (]: On model.ecommerce_dw.customer_ltv: BEGIN
[0m21:15:08.279217 [debug] [Thread-3 (]: On model.ecommerce_dw.daily_sales: BEGIN
[0m21:15:08.279416 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:15:08.279607 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:15:08.279800 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:15:08.288808 [debug] [Thread-2 (]: SQL status: BEGIN in 0.009 seconds
[0m21:15:08.289192 [debug] [Thread-4 (]: SQL status: BEGIN in 0.010 seconds
[0m21:15:08.289411 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_dw.customer_ltv"
[0m21:15:08.289651 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_dw.product_performance"
[0m21:15:08.289884 [debug] [Thread-2 (]: On model.ecommerce_dw.customer_ltv: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.customer_ltv"} */

  
    

  create  table "ecommerce_dw"."public"."customer_ltv__dbt_tmp"
  
  
    as
  
  (
    -- Customer Lifetime Value
-- Aggregated customer metrics



SELECT 
    user_id,
    username,
    email,
    
    COUNT(DISTINCT order_id) as lifetime_orders,
    SUM(revenue) as lifetime_value,
    AVG(revenue) as avg_order_value,
    SUM(quantity) as total_items_purchased,
    
    MIN(created_at) as first_order_date,
    MAX(created_at) as last_order_date,
    
    -- Calculate days between first and last order
    EXTRACT(DAY FROM (MAX(created_at) - MIN(created_at))) as customer_tenure_days,
    
    -- Categorize customers
    CASE 
        WHEN COUNT(DISTINCT order_id) >= 10 THEN 'VIP'
        WHEN COUNT(DISTINCT order_id) >= 5 THEN 'Regular'
        ELSE 'Casual'
    END as customer_segment
    
FROM "ecommerce_dw"."public"."stg_sales"
GROUP BY user_id, username, email
ORDER BY lifetime_value DESC
  );
  
[0m21:15:08.290109 [debug] [Thread-4 (]: On model.ecommerce_dw.product_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.product_performance"} */

  
    

  create  table "ecommerce_dw"."public"."product_performance__dbt_tmp"
  
  
    as
  
  (
    -- Product Performance Analytics
-- Product-level metrics



SELECT 
    product_id,
    product_title,
    category,
    
    COUNT(DISTINCT order_id) as times_ordered,
    SUM(quantity) as total_units_sold,
    SUM(revenue) as total_revenue,
    AVG(unit_price) as avg_sale_price,
    
    -- Performance metrics
    RANK() OVER (ORDER BY SUM(revenue) DESC) as revenue_rank,
    RANK() OVER (PARTITION BY category ORDER BY SUM(revenue) DESC) as category_rank,
    
    -- Calculate what % of total revenue
    ROUND(
        100.0 * SUM(revenue) / SUM(SUM(revenue)) OVER (),
        2
    ) as pct_of_total_revenue
    
FROM "ecommerce_dw"."public"."stg_sales"
GROUP BY product_id, product_title, category
ORDER BY total_revenue DESC
  );
  
[0m21:15:08.295800 [debug] [Thread-2 (]: SQL status: SELECT 10 in 0.005 seconds
[0m21:15:08.296024 [debug] [Thread-4 (]: SQL status: SELECT 20 in 0.006 seconds
[0m21:15:08.299866 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_dw.customer_ltv"
[0m21:15:08.301606 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_dw.product_performance"
[0m21:15:08.301859 [debug] [Thread-2 (]: On model.ecommerce_dw.customer_ltv: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.customer_ltv"} */
alter table "ecommerce_dw"."public"."customer_ltv" rename to "customer_ltv__dbt_backup"
[0m21:15:08.302123 [debug] [Thread-4 (]: On model.ecommerce_dw.product_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.product_performance"} */
alter table "ecommerce_dw"."public"."product_performance" rename to "product_performance__dbt_backup"
[0m21:15:08.302837 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:15:08.303057 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:15:08.304524 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_dw.customer_ltv"
[0m21:15:08.305937 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_dw.product_performance"
[0m21:15:08.306142 [debug] [Thread-3 (]: SQL status: BEGIN in 0.026 seconds
[0m21:15:08.306336 [debug] [Thread-2 (]: On model.ecommerce_dw.customer_ltv: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.customer_ltv"} */
alter table "ecommerce_dw"."public"."customer_ltv__dbt_tmp" rename to "customer_ltv"
[0m21:15:08.306559 [debug] [Thread-4 (]: On model.ecommerce_dw.product_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.product_performance"} */
alter table "ecommerce_dw"."public"."product_performance__dbt_tmp" rename to "product_performance"
[0m21:15:08.306775 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_dw.daily_sales"
[0m21:15:08.307065 [debug] [Thread-3 (]: On model.ecommerce_dw.daily_sales: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.daily_sales"} */

  
    

  create  table "ecommerce_dw"."public"."daily_sales__dbt_tmp"
  
  
    as
  
  (
    -- Daily Sales Aggregations
-- Business metrics aggregated by day



SELECT 
    full_date,
    year,
    month,
    quarter,
    
    COUNT(DISTINCT order_id) as total_orders,
    COUNT(DISTINCT user_id) as unique_customers,
    SUM(quantity) as total_items_sold,
    SUM(revenue) as total_revenue,
    AVG(revenue) as avg_order_value,
    MAX(revenue) as max_order_value,
    MIN(revenue) as min_order_value
    
FROM "ecommerce_dw"."public"."stg_sales"
GROUP BY full_date, year, month, quarter
ORDER BY full_date DESC
  );
  
[0m21:15:08.307389 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:15:08.307593 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:15:08.308382 [debug] [Thread-4 (]: On model.ecommerce_dw.product_performance: COMMIT
[0m21:15:08.309206 [debug] [Thread-2 (]: On model.ecommerce_dw.customer_ltv: COMMIT
[0m21:15:08.309432 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_dw.product_performance"
[0m21:15:08.309659 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_dw.customer_ltv"
[0m21:15:08.309854 [debug] [Thread-4 (]: On model.ecommerce_dw.product_performance: COMMIT
[0m21:15:08.310072 [debug] [Thread-2 (]: On model.ecommerce_dw.customer_ltv: COMMIT
[0m21:15:08.311833 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.005 seconds
[0m21:15:08.312056 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m21:15:08.314105 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_dw.daily_sales"
[0m21:15:08.314337 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m21:15:08.315489 [debug] [Thread-4 (]: Applying DROP to: "ecommerce_dw"."public"."product_performance__dbt_backup"
[0m21:15:08.315727 [debug] [Thread-3 (]: On model.ecommerce_dw.daily_sales: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.daily_sales"} */
alter table "ecommerce_dw"."public"."daily_sales" rename to "daily_sales__dbt_backup"
[0m21:15:08.316808 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_dw"."public"."customer_ltv__dbt_backup"
[0m21:15:08.318524 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_dw.product_performance"
[0m21:15:08.318998 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_dw.customer_ltv"
[0m21:15:08.319306 [debug] [Thread-4 (]: On model.ecommerce_dw.product_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.product_performance"} */
drop table if exists "ecommerce_dw"."public"."product_performance__dbt_backup" cascade
[0m21:15:08.319522 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:15:08.319781 [debug] [Thread-2 (]: On model.ecommerce_dw.customer_ltv: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.customer_ltv"} */
drop table if exists "ecommerce_dw"."public"."customer_ltv__dbt_backup" cascade
[0m21:15:08.321515 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_dw.daily_sales"
[0m21:15:08.321848 [debug] [Thread-3 (]: On model.ecommerce_dw.daily_sales: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.daily_sales"} */
alter table "ecommerce_dw"."public"."daily_sales__dbt_tmp" rename to "daily_sales"
[0m21:15:08.322104 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.002 seconds
[0m21:15:08.322863 [debug] [Thread-4 (]: On model.ecommerce_dw.product_performance: Close
[0m21:15:08.323070 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:15:08.324035 [debug] [Thread-3 (]: On model.ecommerce_dw.daily_sales: COMMIT
[0m21:15:08.324254 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.002 seconds
[0m21:15:08.324452 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_dw.daily_sales"
[0m21:15:08.324751 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42fa28a3-ba3d-4cf5-81b4-4a827b77c390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D01C9AADB0>]}
[0m21:15:08.325607 [debug] [Thread-2 (]: On model.ecommerce_dw.customer_ltv: Close
[0m21:15:08.325860 [debug] [Thread-3 (]: On model.ecommerce_dw.daily_sales: COMMIT
[0m21:15:08.326237 [info ] [Thread-4 (]: 4 of 4 OK created sql table model public.product_performance ................... [[32mSELECT 20[0m in 0.10s]
[0m21:15:08.326678 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42fa28a3-ba3d-4cf5-81b4-4a827b77c390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D01CE00A50>]}
[0m21:15:08.327060 [debug] [Thread-4 (]: Finished running node model.ecommerce_dw.product_performance
[0m21:15:08.327438 [info ] [Thread-2 (]: 2 of 4 OK created sql table model public.customer_ltv .......................... [[32mSELECT 10[0m in 0.10s]
[0m21:15:08.327784 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m21:15:08.328196 [debug] [Thread-2 (]: Finished running node model.ecommerce_dw.customer_ltv
[0m21:15:08.329368 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_dw"."public"."daily_sales__dbt_backup"
[0m21:15:08.329814 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_dw.daily_sales"
[0m21:15:08.330166 [debug] [Thread-3 (]: On model.ecommerce_dw.daily_sales: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.daily_sales"} */
drop table if exists "ecommerce_dw"."public"."daily_sales__dbt_backup" cascade
[0m21:15:08.332078 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.002 seconds
[0m21:15:08.332821 [debug] [Thread-3 (]: On model.ecommerce_dw.daily_sales: Close
[0m21:15:08.333330 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42fa28a3-ba3d-4cf5-81b4-4a827b77c390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D01CC75950>]}
[0m21:15:08.333681 [info ] [Thread-3 (]: 3 of 4 OK created sql table model public.daily_sales ........................... [[32mSELECT 1[0m in 0.11s]
[0m21:15:08.334134 [debug] [Thread-3 (]: Finished running node model.ecommerce_dw.daily_sales
[0m21:15:08.334953 [debug] [MainThread]: Using postgres connection "master"
[0m21:15:08.335149 [debug] [MainThread]: On master: BEGIN
[0m21:15:08.335288 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:15:08.341822 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m21:15:08.342045 [debug] [MainThread]: On master: COMMIT
[0m21:15:08.342196 [debug] [MainThread]: Using postgres connection "master"
[0m21:15:08.342323 [debug] [MainThread]: On master: COMMIT
[0m21:15:08.342703 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:15:08.342905 [debug] [MainThread]: On master: Close
[0m21:15:08.343157 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:15:08.343310 [debug] [MainThread]: Connection 'list_ecommerce_dw' was properly closed.
[0m21:15:08.343424 [debug] [MainThread]: Connection 'list_ecommerce_dw_public' was properly closed.
[0m21:15:08.343539 [debug] [MainThread]: Connection 'model.ecommerce_dw.stg_sales' was properly closed.
[0m21:15:08.343647 [debug] [MainThread]: Connection 'model.ecommerce_dw.daily_sales' was properly closed.
[0m21:15:08.343749 [debug] [MainThread]: Connection 'model.ecommerce_dw.product_performance' was properly closed.
[0m21:15:08.343852 [debug] [MainThread]: Connection 'model.ecommerce_dw.customer_ltv' was properly closed.
[0m21:15:08.344038 [info ] [MainThread]: 
[0m21:15:08.344258 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m21:15:08.345084 [debug] [MainThread]: Command end result
[0m21:15:08.354163 [debug] [MainThread]: Wrote artifact WritableManifest to D:\ML Projects\ECommerce-Sales-Warehouse\dbt_project\target\manifest.json
[0m21:15:08.355406 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\ML Projects\ECommerce-Sales-Warehouse\dbt_project\target\semantic_manifest.json
[0m21:15:08.358748 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\ML Projects\ECommerce-Sales-Warehouse\dbt_project\target\run_results.json
[0m21:15:08.358939 [info ] [MainThread]: 
[0m21:15:08.359226 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:15:08.359462 [info ] [MainThread]: 
[0m21:15:08.359668 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m21:15:08.360205 [debug] [MainThread]: Command `dbt run` succeeded at 21:15:08.360132 after 0.74 seconds
[0m21:15:08.360403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D01C41C8A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D013E39E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D01A636FF0>]}
[0m21:15:08.360586 [debug] [MainThread]: Flushing usage events
[0m21:15:08.875866 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:19:59.997963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205672F4C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205692B3ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205692B3B10>]}


============================== 21:20:00.000460 | ac0be002-3c7d-436e-aedc-e47d740639e1 ==============================
[0m21:20:00.000460 [info ] [MainThread]: Running with dbt=1.11.4
[0m21:20:00.000854 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': '.', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --profiles-dir .', 'use_experimental_parser': 'False', 'log_path': 'D:\\ML Projects\\ECommerce-Sales-Warehouse\\dbt_project\\logs'}
[0m21:20:00.091621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac0be002-3c7d-436e-aedc-e47d740639e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020567579940>]}
[0m21:20:00.127613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ac0be002-3c7d-436e-aedc-e47d740639e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002056911F350>]}
[0m21:20:00.128161 [info ] [MainThread]: Registered adapter: postgres=1.8.0
[0m21:20:00.227501 [debug] [MainThread]: checksum: 092b177ba87eb6bb3c55954c38aa57900eebac336561eb9ee32218428aa81d43, vars: {}, profile: , target: , version: 1.11.4
[0m21:20:00.273167 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:20:00.273390 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m21:20:00.273528 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:20:00.287072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac0be002-3c7d-436e-aedc-e47d740639e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002056934DA50>]}
[0m21:20:00.315910 [debug] [MainThread]: Wrote artifact WritableManifest to D:\ML Projects\ECommerce-Sales-Warehouse\dbt_project\target\manifest.json
[0m21:20:00.317078 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\ML Projects\ECommerce-Sales-Warehouse\dbt_project\target\semantic_manifest.json
[0m21:20:00.326389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac0be002-3c7d-436e-aedc-e47d740639e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020569141130>]}
[0m21:20:00.326662 [info ] [MainThread]: Found 4 models, 462 macros
[0m21:20:00.326985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac0be002-3c7d-436e-aedc-e47d740639e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205694603D0>]}
[0m21:20:00.327933 [info ] [MainThread]: 
[0m21:20:00.328201 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:20:00.328428 [info ] [MainThread]: 
[0m21:20:00.328729 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:20:00.330845 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_dw'
[0m21:20:00.358714 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_dw"
[0m21:20:00.358957 [debug] [ThreadPool]: On list_ecommerce_dw: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "connection_name": "list_ecommerce_dw"} */

    select distinct nspname from pg_namespace
  
[0m21:20:00.359105 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:20:00.370542 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.011 seconds
[0m21:20:00.371322 [debug] [ThreadPool]: On list_ecommerce_dw: Close
[0m21:20:00.372458 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_dw_public'
[0m21:20:00.375438 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_dw_public"
[0m21:20:00.375616 [debug] [ThreadPool]: On list_ecommerce_dw_public: BEGIN
[0m21:20:00.375749 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:20:00.382198 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m21:20:00.382400 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_dw_public"
[0m21:20:00.382577 [debug] [ThreadPool]: On list_ecommerce_dw_public: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "connection_name": "list_ecommerce_dw_public"} */
select
      'ecommerce_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m21:20:00.384406 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.002 seconds
[0m21:20:00.385183 [debug] [ThreadPool]: On list_ecommerce_dw_public: ROLLBACK
[0m21:20:00.385629 [debug] [ThreadPool]: On list_ecommerce_dw_public: Close
[0m21:20:00.389180 [debug] [MainThread]: Using postgres connection "master"
[0m21:20:00.389363 [debug] [MainThread]: On master: BEGIN
[0m21:20:00.389493 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:20:00.395708 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m21:20:00.395886 [debug] [MainThread]: Using postgres connection "master"
[0m21:20:00.396183 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:20:00.399305 [debug] [MainThread]: SQL status: SELECT 10 in 0.003 seconds
[0m21:20:00.400917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac0be002-3c7d-436e-aedc-e47d740639e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020569A13EE0>]}
[0m21:20:00.401196 [debug] [MainThread]: On master: ROLLBACK
[0m21:20:00.401638 [debug] [MainThread]: Using postgres connection "master"
[0m21:20:00.401796 [debug] [MainThread]: On master: BEGIN
[0m21:20:00.402358 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:20:00.402542 [debug] [MainThread]: On master: COMMIT
[0m21:20:00.402687 [debug] [MainThread]: Using postgres connection "master"
[0m21:20:00.402809 [debug] [MainThread]: On master: COMMIT
[0m21:20:00.403181 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:20:00.403358 [debug] [MainThread]: On master: Close
[0m21:20:00.405773 [debug] [Thread-1 (]: Began running node model.ecommerce_dw.stg_sales
[0m21:20:00.406074 [info ] [Thread-1 (]: 1 of 4 START sql view model public.stg_sales ................................... [RUN]
[0m21:20:00.406455 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.ecommerce_dw.stg_sales'
[0m21:20:00.406643 [debug] [Thread-1 (]: Began compiling node model.ecommerce_dw.stg_sales
[0m21:20:00.410132 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_dw.stg_sales"
[0m21:20:00.410558 [debug] [Thread-1 (]: Began executing node model.ecommerce_dw.stg_sales
[0m21:20:00.429386 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_dw.stg_sales"
[0m21:20:00.429930 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dw.stg_sales"
[0m21:20:00.430129 [debug] [Thread-1 (]: On model.ecommerce_dw.stg_sales: BEGIN
[0m21:20:00.430288 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:20:00.436960 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m21:20:00.437187 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dw.stg_sales"
[0m21:20:00.437362 [debug] [Thread-1 (]: On model.ecommerce_dw.stg_sales: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.stg_sales"} */

  create view "ecommerce_dw"."public"."stg_sales__dbt_tmp"
    
    
  as (
    -- Staging model: Clean fact_sales data
-- This is a foundation for marts



SELECT 
    f.sale_id,
    f.order_id,
    f.user_id,
    f.product_id,
    f.date_id,
    f.quantity,
    f.unit_price,
    f.revenue,
    f.created_at,
    
    -- Join dimension data for easier querying
    p.product_title,
    p.category,
    u.username,
    u.email,
    d.full_date,
    d.year,
    d.month,
    d.quarter
    
FROM fact_sales f
LEFT JOIN dim_product p ON f.product_id = p.product_id
LEFT JOIN dim_user u ON f.user_id = u.user_id
LEFT JOIN dim_date d ON f.date_id = d.date_id
WHERE f.created_at IS NOT NULL
  );
[0m21:20:00.439327 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m21:20:00.442924 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dw.stg_sales"
[0m21:20:00.443153 [debug] [Thread-1 (]: On model.ecommerce_dw.stg_sales: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.stg_sales"} */
alter table "ecommerce_dw"."public"."stg_sales" rename to "stg_sales__dbt_backup"
[0m21:20:00.443911 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:20:00.445416 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dw.stg_sales"
[0m21:20:00.445599 [debug] [Thread-1 (]: On model.ecommerce_dw.stg_sales: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.stg_sales"} */
alter table "ecommerce_dw"."public"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m21:20:00.446185 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:20:00.454269 [debug] [Thread-1 (]: On model.ecommerce_dw.stg_sales: COMMIT
[0m21:20:00.454474 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dw.stg_sales"
[0m21:20:00.454632 [debug] [Thread-1 (]: On model.ecommerce_dw.stg_sales: COMMIT
[0m21:20:00.456510 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m21:20:00.459517 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_dw"."public"."stg_sales__dbt_backup"
[0m21:20:00.462268 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dw.stg_sales"
[0m21:20:00.462461 [debug] [Thread-1 (]: On model.ecommerce_dw.stg_sales: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.stg_sales"} */
drop view if exists "ecommerce_dw"."public"."stg_sales__dbt_backup" cascade
[0m21:20:00.464200 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m21:20:00.465408 [debug] [Thread-1 (]: On model.ecommerce_dw.stg_sales: Close
[0m21:20:00.466514 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac0be002-3c7d-436e-aedc-e47d740639e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002056986FC50>]}
[0m21:20:00.466937 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public.stg_sales .............................. [[32mCREATE VIEW[0m in 0.06s]
[0m21:20:00.467395 [debug] [Thread-1 (]: Finished running node model.ecommerce_dw.stg_sales
[0m21:20:00.467930 [debug] [Thread-3 (]: Began running node model.ecommerce_dw.daily_sales
[0m21:20:00.468196 [debug] [Thread-4 (]: Began running node model.ecommerce_dw.product_performance
[0m21:20:00.468435 [debug] [Thread-2 (]: Began running node model.ecommerce_dw.customer_ltv
[0m21:20:00.468724 [info ] [Thread-3 (]: 3 of 4 START sql table model public.daily_sales ................................ [RUN]
[0m21:20:00.471286 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_dw.daily_sales'
[0m21:20:00.469002 [info ] [Thread-4 (]: 4 of 4 START sql table model public.product_performance ........................ [RUN]
[0m21:20:00.471552 [debug] [Thread-3 (]: Began compiling node model.ecommerce_dw.daily_sales
[0m21:20:00.471798 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.ecommerce_dw.product_performance'
[0m21:20:00.471022 [info ] [Thread-2 (]: 2 of 4 START sql table model public.customer_ltv ............................... [RUN]
[0m21:20:00.473343 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_dw.daily_sales"
[0m21:20:00.473591 [debug] [Thread-4 (]: Began compiling node model.ecommerce_dw.product_performance
[0m21:20:00.473878 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.ecommerce_dw.customer_ltv'
[0m21:20:00.475263 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_dw.product_performance"
[0m21:20:00.475570 [debug] [Thread-2 (]: Began compiling node model.ecommerce_dw.customer_ltv
[0m21:20:00.512150 [debug] [Thread-3 (]: Began executing node model.ecommerce_dw.daily_sales
[0m21:20:00.513340 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_dw.customer_ltv"
[0m21:20:00.524901 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_dw.daily_sales"
[0m21:20:00.525335 [debug] [Thread-4 (]: Began executing node model.ecommerce_dw.product_performance
[0m21:20:00.527095 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_dw.product_performance"
[0m21:20:00.527460 [debug] [Thread-2 (]: Began executing node model.ecommerce_dw.customer_ltv
[0m21:20:00.529232 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_dw.customer_ltv"
[0m21:20:00.529723 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_dw.product_performance"
[0m21:20:00.529946 [debug] [Thread-4 (]: On model.ecommerce_dw.product_performance: BEGIN
[0m21:20:00.530160 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_dw.customer_ltv"
[0m21:20:00.530376 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_dw.daily_sales"
[0m21:20:00.530561 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:20:00.530754 [debug] [Thread-2 (]: On model.ecommerce_dw.customer_ltv: BEGIN
[0m21:20:00.530939 [debug] [Thread-3 (]: On model.ecommerce_dw.daily_sales: BEGIN
[0m21:20:00.531203 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:20:00.531411 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:20:00.538885 [debug] [Thread-4 (]: SQL status: BEGIN in 0.008 seconds
[0m21:20:00.539157 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m21:20:00.539393 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_dw.product_performance"
[0m21:20:00.539624 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_dw.customer_ltv"
[0m21:20:00.539849 [debug] [Thread-4 (]: On model.ecommerce_dw.product_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.product_performance"} */

  
    

  create  table "ecommerce_dw"."public"."product_performance__dbt_tmp"
  
  
    as
  
  (
    -- Product Performance Analytics
-- Product-level metrics



SELECT 
    product_id,
    product_title,
    category,
    
    COUNT(DISTINCT order_id) as times_ordered,
    SUM(quantity) as total_units_sold,
    SUM(revenue) as total_revenue,
    AVG(unit_price) as avg_sale_price,
    
    -- Performance metrics
    RANK() OVER (ORDER BY SUM(revenue) DESC) as revenue_rank,
    RANK() OVER (PARTITION BY category ORDER BY SUM(revenue) DESC) as category_rank,
    
    -- Calculate what % of total revenue
    ROUND(
        100.0 * SUM(revenue) / SUM(SUM(revenue)) OVER (),
        2
    ) as pct_of_total_revenue
    
FROM "ecommerce_dw"."public"."stg_sales"
GROUP BY product_id, product_title, category
ORDER BY total_revenue DESC
  );
  
[0m21:20:00.540296 [debug] [Thread-2 (]: On model.ecommerce_dw.customer_ltv: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.customer_ltv"} */

  
    

  create  table "ecommerce_dw"."public"."customer_ltv__dbt_tmp"
  
  
    as
  
  (
    -- Customer Lifetime Value
-- Aggregated customer metrics



SELECT 
    user_id,
    username,
    email,
    
    COUNT(DISTINCT order_id) as lifetime_orders,
    SUM(revenue) as lifetime_value,
    AVG(revenue) as avg_order_value,
    SUM(quantity) as total_items_purchased,
    
    MIN(created_at) as first_order_date,
    MAX(created_at) as last_order_date,
    
    -- Calculate days between first and last order
    EXTRACT(DAY FROM (MAX(created_at) - MIN(created_at))) as customer_tenure_days,
    
    -- Categorize customers
    CASE 
        WHEN COUNT(DISTINCT order_id) >= 10 THEN 'VIP'
        WHEN COUNT(DISTINCT order_id) >= 5 THEN 'Regular'
        ELSE 'Casual'
    END as customer_segment
    
FROM "ecommerce_dw"."public"."stg_sales"
GROUP BY user_id, username, email
ORDER BY lifetime_value DESC
  );
  
[0m21:20:00.545893 [debug] [Thread-2 (]: SQL status: SELECT 10 in 0.005 seconds
[0m21:20:00.546128 [debug] [Thread-4 (]: SQL status: SELECT 20 in 0.006 seconds
[0m21:20:00.550128 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_dw.customer_ltv"
[0m21:20:00.551574 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_dw.product_performance"
[0m21:20:00.551813 [debug] [Thread-2 (]: On model.ecommerce_dw.customer_ltv: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.customer_ltv"} */
alter table "ecommerce_dw"."public"."customer_ltv" rename to "customer_ltv__dbt_backup"
[0m21:20:00.552101 [debug] [Thread-4 (]: On model.ecommerce_dw.product_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.product_performance"} */
alter table "ecommerce_dw"."public"."product_performance" rename to "product_performance__dbt_backup"
[0m21:20:00.553148 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:20:00.553386 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:20:00.554813 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_dw.product_performance"
[0m21:20:00.556157 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_dw.customer_ltv"
[0m21:20:00.556398 [debug] [Thread-4 (]: On model.ecommerce_dw.product_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.product_performance"} */
alter table "ecommerce_dw"."public"."product_performance__dbt_tmp" rename to "product_performance"
[0m21:20:00.556631 [debug] [Thread-2 (]: On model.ecommerce_dw.customer_ltv: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.customer_ltv"} */
alter table "ecommerce_dw"."public"."customer_ltv__dbt_tmp" rename to "customer_ltv"
[0m21:20:00.557179 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:20:00.557388 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:20:00.558115 [debug] [Thread-4 (]: On model.ecommerce_dw.product_performance: COMMIT
[0m21:20:00.558856 [debug] [Thread-2 (]: On model.ecommerce_dw.customer_ltv: COMMIT
[0m21:20:00.559058 [debug] [Thread-3 (]: SQL status: BEGIN in 0.028 seconds
[0m21:20:00.559253 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_dw.product_performance"
[0m21:20:00.559470 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_dw.customer_ltv"
[0m21:20:00.559655 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_dw.daily_sales"
[0m21:20:00.559838 [debug] [Thread-4 (]: On model.ecommerce_dw.product_performance: COMMIT
[0m21:20:00.560107 [debug] [Thread-2 (]: On model.ecommerce_dw.customer_ltv: COMMIT
[0m21:20:00.560297 [debug] [Thread-3 (]: On model.ecommerce_dw.daily_sales: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.daily_sales"} */

  
    

  create  table "ecommerce_dw"."public"."daily_sales__dbt_tmp"
  
  
    as
  
  (
    -- Daily Sales Aggregations
-- Business metrics aggregated by day



SELECT 
    full_date,
    year,
    month,
    quarter,
    
    COUNT(DISTINCT order_id) as total_orders,
    COUNT(DISTINCT user_id) as unique_customers,
    SUM(quantity) as total_items_sold,
    SUM(revenue) as total_revenue,
    AVG(revenue) as avg_order_value,
    MAX(revenue) as max_order_value,
    MIN(revenue) as min_order_value
    
FROM "ecommerce_dw"."public"."stg_sales"
GROUP BY full_date, year, month, quarter
ORDER BY full_date DESC
  );
  
[0m21:20:00.561970 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m21:20:00.562187 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m21:20:00.563402 [debug] [Thread-4 (]: Applying DROP to: "ecommerce_dw"."public"."product_performance__dbt_backup"
[0m21:20:00.564886 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_dw"."public"."customer_ltv__dbt_backup"
[0m21:20:00.565100 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.005 seconds
[0m21:20:00.566651 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_dw.product_performance"
[0m21:20:00.567051 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_dw.customer_ltv"
[0m21:20:00.568551 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_dw.daily_sales"
[0m21:20:00.568800 [debug] [Thread-4 (]: On model.ecommerce_dw.product_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.product_performance"} */
drop table if exists "ecommerce_dw"."public"."product_performance__dbt_backup" cascade
[0m21:20:00.569059 [debug] [Thread-2 (]: On model.ecommerce_dw.customer_ltv: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.customer_ltv"} */
drop table if exists "ecommerce_dw"."public"."customer_ltv__dbt_backup" cascade
[0m21:20:00.569275 [debug] [Thread-3 (]: On model.ecommerce_dw.daily_sales: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.daily_sales"} */
alter table "ecommerce_dw"."public"."daily_sales" rename to "daily_sales__dbt_backup"
[0m21:20:00.569969 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:20:00.571404 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_dw.daily_sales"
[0m21:20:00.571627 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.002 seconds
[0m21:20:00.571842 [debug] [Thread-3 (]: On model.ecommerce_dw.daily_sales: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.daily_sales"} */
alter table "ecommerce_dw"."public"."daily_sales__dbt_tmp" rename to "daily_sales"
[0m21:20:00.572102 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.003 seconds
[0m21:20:00.572764 [debug] [Thread-4 (]: On model.ecommerce_dw.product_performance: Close
[0m21:20:00.573433 [debug] [Thread-2 (]: On model.ecommerce_dw.customer_ltv: Close
[0m21:20:00.573627 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m21:20:00.574033 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac0be002-3c7d-436e-aedc-e47d740639e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002056989F960>]}
[0m21:20:00.574837 [debug] [Thread-3 (]: On model.ecommerce_dw.daily_sales: COMMIT
[0m21:20:00.575112 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac0be002-3c7d-436e-aedc-e47d740639e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020569CC9630>]}
[0m21:20:00.575707 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_dw.daily_sales"
[0m21:20:00.575492 [info ] [Thread-4 (]: 4 of 4 OK created sql table model public.product_performance ................... [[32mSELECT 20[0m in 0.10s]
[0m21:20:00.576335 [debug] [Thread-3 (]: On model.ecommerce_dw.daily_sales: COMMIT
[0m21:20:00.576133 [info ] [Thread-2 (]: 2 of 4 OK created sql table model public.customer_ltv .......................... [[32mSELECT 10[0m in 0.10s]
[0m21:20:00.576687 [debug] [Thread-4 (]: Finished running node model.ecommerce_dw.product_performance
[0m21:20:00.577023 [debug] [Thread-2 (]: Finished running node model.ecommerce_dw.customer_ltv
[0m21:20:00.578111 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m21:20:00.579127 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_dw"."public"."daily_sales__dbt_backup"
[0m21:20:00.579448 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_dw.daily_sales"
[0m21:20:00.579615 [debug] [Thread-3 (]: On model.ecommerce_dw.daily_sales: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.daily_sales"} */
drop table if exists "ecommerce_dw"."public"."daily_sales__dbt_backup" cascade
[0m21:20:00.581357 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.002 seconds
[0m21:20:00.582054 [debug] [Thread-3 (]: On model.ecommerce_dw.daily_sales: Close
[0m21:20:00.582408 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac0be002-3c7d-436e-aedc-e47d740639e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020569B54FD0>]}
[0m21:20:00.582791 [info ] [Thread-3 (]: 3 of 4 OK created sql table model public.daily_sales ........................... [[32mSELECT 1[0m in 0.11s]
[0m21:20:00.583245 [debug] [Thread-3 (]: Finished running node model.ecommerce_dw.daily_sales
[0m21:20:00.584253 [debug] [MainThread]: Using postgres connection "master"
[0m21:20:00.584437 [debug] [MainThread]: On master: BEGIN
[0m21:20:00.584573 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:20:00.591048 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m21:20:00.591279 [debug] [MainThread]: On master: COMMIT
[0m21:20:00.591428 [debug] [MainThread]: Using postgres connection "master"
[0m21:20:00.591559 [debug] [MainThread]: On master: COMMIT
[0m21:20:00.592003 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:20:00.592220 [debug] [MainThread]: On master: Close
[0m21:20:00.592467 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:20:00.592660 [debug] [MainThread]: Connection 'list_ecommerce_dw' was properly closed.
[0m21:20:00.592800 [debug] [MainThread]: Connection 'list_ecommerce_dw_public' was properly closed.
[0m21:20:00.592920 [debug] [MainThread]: Connection 'model.ecommerce_dw.stg_sales' was properly closed.
[0m21:20:00.593031 [debug] [MainThread]: Connection 'model.ecommerce_dw.daily_sales' was properly closed.
[0m21:20:00.593141 [debug] [MainThread]: Connection 'model.ecommerce_dw.product_performance' was properly closed.
[0m21:20:00.593245 [debug] [MainThread]: Connection 'model.ecommerce_dw.customer_ltv' was properly closed.
[0m21:20:00.593422 [info ] [MainThread]: 
[0m21:20:00.593672 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m21:20:00.594307 [debug] [MainThread]: Command end result
[0m21:20:00.603756 [debug] [MainThread]: Wrote artifact WritableManifest to D:\ML Projects\ECommerce-Sales-Warehouse\dbt_project\target\manifest.json
[0m21:20:00.604997 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\ML Projects\ECommerce-Sales-Warehouse\dbt_project\target\semantic_manifest.json
[0m21:20:00.608276 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\ML Projects\ECommerce-Sales-Warehouse\dbt_project\target\run_results.json
[0m21:20:00.608458 [info ] [MainThread]: 
[0m21:20:00.608748 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:20:00.609083 [info ] [MainThread]: 
[0m21:20:00.609306 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m21:20:00.609828 [debug] [MainThread]: Command `dbt run` succeeded at 21:20:00.609757 after 0.71 seconds
[0m21:20:00.610022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002056931C8A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020560CD9E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020566DC5070>]}
[0m21:20:00.610204 [debug] [MainThread]: Flushing usage events
[0m21:20:01.066814 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:11:20.705445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B2C694C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B2E6BFED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B2E6BFB10>]}


============================== 22:11:20.707948 | 7e1ba1a3-125e-4765-9064-330d66511e21 ==============================
[0m22:11:20.707948 [info ] [MainThread]: Running with dbt=1.11.4
[0m22:11:20.708315 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'printer_width': '80', 'write_json': 'True', 'empty': 'False', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'debug': 'False', 'fail_fast': 'False', 'profiles_dir': '.', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'invocation_command': 'dbt run --profiles-dir .', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': 'D:\\ML Projects\\ECommerce-Sales-Warehouse\\dbt_project\\logs'}
[0m22:11:20.799389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7e1ba1a3-125e-4765-9064-330d66511e21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B2C91D810>]}
[0m22:11:20.834746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7e1ba1a3-125e-4765-9064-330d66511e21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B2E51F350>]}
[0m22:11:20.835355 [info ] [MainThread]: Registered adapter: postgres=1.8.0
[0m22:11:20.934102 [debug] [MainThread]: checksum: 092b177ba87eb6bb3c55954c38aa57900eebac336561eb9ee32218428aa81d43, vars: {}, profile: , target: , version: 1.11.4
[0m22:11:20.980980 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:11:20.981320 [debug] [MainThread]: Partial parsing: updated file: ecommerce_dw://models\marts\customer_ltv.sql
[0m22:11:21.108253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7e1ba1a3-125e-4765-9064-330d66511e21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B2E74D850>]}
[0m22:11:21.137111 [debug] [MainThread]: Wrote artifact WritableManifest to D:\ML Projects\ECommerce-Sales-Warehouse\dbt_project\target\manifest.json
[0m22:11:21.138445 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\ML Projects\ECommerce-Sales-Warehouse\dbt_project\target\semantic_manifest.json
[0m22:11:21.182405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7e1ba1a3-125e-4765-9064-330d66511e21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B2C6AEC60>]}
[0m22:11:21.182722 [info ] [MainThread]: Found 4 models, 462 macros
[0m22:11:21.183082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e1ba1a3-125e-4765-9064-330d66511e21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B2EB07690>]}
[0m22:11:21.184140 [info ] [MainThread]: 
[0m22:11:21.184408 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:11:21.184599 [info ] [MainThread]: 
[0m22:11:21.184863 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:11:21.187020 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_dw'
[0m22:11:21.212845 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_dw"
[0m22:11:21.213059 [debug] [ThreadPool]: On list_ecommerce_dw: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "connection_name": "list_ecommerce_dw"} */

    select distinct nspname from pg_namespace
  
[0m22:11:21.213209 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:11:21.224743 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.011 seconds
[0m22:11:21.225466 [debug] [ThreadPool]: On list_ecommerce_dw: Close
[0m22:11:21.226402 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_dw_public'
[0m22:11:21.229205 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_dw_public"
[0m22:11:21.229387 [debug] [ThreadPool]: On list_ecommerce_dw_public: BEGIN
[0m22:11:21.229522 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:11:21.235790 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m22:11:21.235983 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_dw_public"
[0m22:11:21.236137 [debug] [ThreadPool]: On list_ecommerce_dw_public: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "connection_name": "list_ecommerce_dw_public"} */
select
      'ecommerce_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:11:21.238182 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.002 seconds
[0m22:11:21.238895 [debug] [ThreadPool]: On list_ecommerce_dw_public: ROLLBACK
[0m22:11:21.239327 [debug] [ThreadPool]: On list_ecommerce_dw_public: Close
[0m22:11:21.242024 [debug] [MainThread]: Using postgres connection "master"
[0m22:11:21.242204 [debug] [MainThread]: On master: BEGIN
[0m22:11:21.242334 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:11:21.265771 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m22:11:21.265990 [debug] [MainThread]: Using postgres connection "master"
[0m22:11:21.266160 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:11:21.269081 [debug] [MainThread]: SQL status: SELECT 6 in 0.003 seconds
[0m22:11:21.270318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e1ba1a3-125e-4765-9064-330d66511e21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B2ED9D300>]}
[0m22:11:21.270533 [debug] [MainThread]: On master: ROLLBACK
[0m22:11:21.270947 [debug] [MainThread]: Using postgres connection "master"
[0m22:11:21.271122 [debug] [MainThread]: On master: BEGIN
[0m22:11:21.271673 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:11:21.271857 [debug] [MainThread]: On master: COMMIT
[0m22:11:21.271996 [debug] [MainThread]: Using postgres connection "master"
[0m22:11:21.272125 [debug] [MainThread]: On master: COMMIT
[0m22:11:21.272473 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:11:21.272655 [debug] [MainThread]: On master: Close
[0m22:11:21.275203 [debug] [Thread-1 (]: Began running node model.ecommerce_dw.stg_sales
[0m22:11:21.275487 [info ] [Thread-1 (]: 1 of 4 START sql view model public.stg_sales ................................... [RUN]
[0m22:11:21.275835 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.ecommerce_dw.stg_sales'
[0m22:11:21.276026 [debug] [Thread-1 (]: Began compiling node model.ecommerce_dw.stg_sales
[0m22:11:21.279562 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_dw.stg_sales"
[0m22:11:21.279994 [debug] [Thread-1 (]: Began executing node model.ecommerce_dw.stg_sales
[0m22:11:21.298138 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_dw.stg_sales"
[0m22:11:21.298700 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dw.stg_sales"
[0m22:11:21.298898 [debug] [Thread-1 (]: On model.ecommerce_dw.stg_sales: BEGIN
[0m22:11:21.299073 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:11:21.305855 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m22:11:21.306109 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dw.stg_sales"
[0m22:11:21.306295 [debug] [Thread-1 (]: On model.ecommerce_dw.stg_sales: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.stg_sales"} */

  create view "ecommerce_dw"."public"."stg_sales__dbt_tmp"
    
    
  as (
    -- Staging model: Clean fact_sales data
-- This is a foundation for marts



SELECT 
    f.sale_id,
    f.order_id,
    f.user_id,
    f.product_id,
    f.date_id,
    f.quantity,
    f.unit_price,
    f.revenue,
    f.created_at,
    
    -- Join dimension data for easier querying
    p.product_title,
    p.category,
    u.username,
    u.email,
    d.full_date,
    d.year,
    d.month,
    d.quarter
    
FROM fact_sales f
LEFT JOIN dim_product p ON f.product_id = p.product_id
LEFT JOIN dim_user u ON f.user_id = u.user_id
LEFT JOIN dim_date d ON f.date_id = d.date_id
WHERE f.created_at IS NOT NULL
  );
[0m22:11:21.308709 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m22:11:21.311913 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dw.stg_sales"
[0m22:11:21.312118 [debug] [Thread-1 (]: On model.ecommerce_dw.stg_sales: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.stg_sales"} */
alter table "ecommerce_dw"."public"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m22:11:21.312759 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:11:21.320302 [debug] [Thread-1 (]: On model.ecommerce_dw.stg_sales: COMMIT
[0m22:11:21.320512 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dw.stg_sales"
[0m22:11:21.320671 [debug] [Thread-1 (]: On model.ecommerce_dw.stg_sales: COMMIT
[0m22:11:21.322705 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m22:11:21.325648 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_dw"."public"."stg_sales__dbt_backup"
[0m22:11:21.328101 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dw.stg_sales"
[0m22:11:21.328294 [debug] [Thread-1 (]: On model.ecommerce_dw.stg_sales: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.stg_sales"} */
drop view if exists "ecommerce_dw"."public"."stg_sales__dbt_backup" cascade
[0m22:11:21.328941 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m22:11:21.330142 [debug] [Thread-1 (]: On model.ecommerce_dw.stg_sales: Close
[0m22:11:21.331227 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e1ba1a3-125e-4765-9064-330d66511e21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B2EDC3C50>]}
[0m22:11:21.331633 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public.stg_sales .............................. [[32mCREATE VIEW[0m in 0.05s]
[0m22:11:21.332063 [debug] [Thread-1 (]: Finished running node model.ecommerce_dw.stg_sales
[0m22:11:21.332483 [debug] [Thread-3 (]: Began running node model.ecommerce_dw.daily_sales
[0m22:11:21.332942 [debug] [Thread-2 (]: Began running node model.ecommerce_dw.customer_ltv
[0m22:11:21.333182 [debug] [Thread-4 (]: Began running node model.ecommerce_dw.product_performance
[0m22:11:21.332764 [info ] [Thread-3 (]: 3 of 4 START sql table model public.daily_sales ................................ [RUN]
[0m22:11:21.333514 [info ] [Thread-2 (]: 2 of 4 START sql table model public.customer_ltv ............................... [RUN]
[0m22:11:21.333868 [info ] [Thread-4 (]: 4 of 4 START sql table model public.product_performance ........................ [RUN]
[0m22:11:21.334190 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_dw.daily_sales'
[0m22:11:21.334465 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.ecommerce_dw.customer_ltv'
[0m22:11:21.334743 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.ecommerce_dw.product_performance'
[0m22:11:21.334973 [debug] [Thread-3 (]: Began compiling node model.ecommerce_dw.daily_sales
[0m22:11:21.335235 [debug] [Thread-2 (]: Began compiling node model.ecommerce_dw.customer_ltv
[0m22:11:21.335452 [debug] [Thread-4 (]: Began compiling node model.ecommerce_dw.product_performance
[0m22:11:21.337020 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_dw.daily_sales"
[0m22:11:21.338336 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_dw.customer_ltv"
[0m22:11:21.339675 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_dw.product_performance"
[0m22:11:21.340204 [debug] [Thread-3 (]: Began executing node model.ecommerce_dw.daily_sales
[0m22:11:21.350994 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_dw.daily_sales"
[0m22:11:21.351356 [debug] [Thread-4 (]: Began executing node model.ecommerce_dw.product_performance
[0m22:11:21.352895 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_dw.product_performance"
[0m22:11:21.353123 [debug] [Thread-2 (]: Began executing node model.ecommerce_dw.customer_ltv
[0m22:11:21.354969 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_dw.customer_ltv"
[0m22:11:21.355228 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_dw.daily_sales"
[0m22:11:21.355542 [debug] [Thread-3 (]: On model.ecommerce_dw.daily_sales: BEGIN
[0m22:11:21.355716 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:11:21.356099 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_dw.product_performance"
[0m22:11:21.356434 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_dw.customer_ltv"
[0m22:11:21.356650 [debug] [Thread-4 (]: On model.ecommerce_dw.product_performance: BEGIN
[0m22:11:21.356873 [debug] [Thread-2 (]: On model.ecommerce_dw.customer_ltv: BEGIN
[0m22:11:21.357096 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:11:21.357322 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:11:21.364272 [debug] [Thread-3 (]: SQL status: BEGIN in 0.009 seconds
[0m22:11:21.364483 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_dw.daily_sales"
[0m22:11:21.364660 [debug] [Thread-3 (]: On model.ecommerce_dw.daily_sales: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.daily_sales"} */

  
    

  create  table "ecommerce_dw"."public"."daily_sales__dbt_tmp"
  
  
    as
  
  (
    -- Daily Sales Aggregations
-- Business metrics aggregated by day



SELECT 
    full_date,
    year,
    month,
    quarter,
    
    COUNT(DISTINCT order_id) as total_orders,
    COUNT(DISTINCT user_id) as unique_customers,
    SUM(quantity) as total_items_sold,
    SUM(revenue) as total_revenue,
    AVG(revenue) as avg_order_value,
    MAX(revenue) as max_order_value,
    MIN(revenue) as min_order_value
    
FROM "ecommerce_dw"."public"."stg_sales"
GROUP BY full_date, year, month, quarter
ORDER BY full_date DESC
  );
  
[0m22:11:21.365432 [debug] [Thread-4 (]: SQL status: BEGIN in 0.008 seconds
[0m22:11:21.365654 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m22:11:21.365851 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_dw.product_performance"
[0m22:11:21.366049 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_dw.customer_ltv"
[0m22:11:21.366285 [debug] [Thread-4 (]: On model.ecommerce_dw.product_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.product_performance"} */

  
    

  create  table "ecommerce_dw"."public"."product_performance__dbt_tmp"
  
  
    as
  
  (
    -- Product Performance Analytics
-- Product-level metrics



SELECT 
    product_id,
    product_title,
    category,
    
    COUNT(DISTINCT order_id) as times_ordered,
    SUM(quantity) as total_units_sold,
    SUM(revenue) as total_revenue,
    AVG(unit_price) as avg_sale_price,
    
    -- Performance metrics
    RANK() OVER (ORDER BY SUM(revenue) DESC) as revenue_rank,
    RANK() OVER (PARTITION BY category ORDER BY SUM(revenue) DESC) as category_rank,
    
    -- Calculate what % of total revenue
    ROUND(
        100.0 * SUM(revenue) / SUM(SUM(revenue)) OVER (),
        2
    ) as pct_of_total_revenue
    
FROM "ecommerce_dw"."public"."stg_sales"
GROUP BY product_id, product_title, category
ORDER BY total_revenue DESC
  );
  
[0m22:11:21.366528 [debug] [Thread-2 (]: On model.ecommerce_dw.customer_ltv: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.customer_ltv"} */

  
    

  create  table "ecommerce_dw"."public"."customer_ltv__dbt_tmp"
  
  
    as
  
  (
    -- Customer Lifetime Value
-- Aggregated customer metrics



SELECT 
    user_id,
    username,
    email,
    
    COUNT(DISTINCT order_id) as lifetime_orders,
    SUM(revenue) as lifetime_value,
    AVG(revenue) as avg_order_value,
    SUM(quantity) as total_items_purchased,
    
    MIN(created_at) as first_order_date,
    MAX(created_at) as last_order_date,
    
    -- Calculate days between first and last order
    EXTRACT(DAY FROM (MAX(created_at) - MIN(created_at))) as customer_tenure_days,
    
    -- Categorize customers
    CASE 
        WHEN COUNT(DISTINCT order_id) >= 20 THEN 'VIP'
        WHEN COUNT(DISTINCT order_id) >= 10 THEN 'Regular'
        ELSE 'Casual'
    END as customer_segment
    
FROM "ecommerce_dw"."public"."stg_sales"
GROUP BY user_id, username, email
ORDER BY lifetime_value DESC
  );
  
[0m22:11:21.370513 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.006 seconds
[0m22:11:21.374385 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_dw.daily_sales"
[0m22:11:21.374622 [debug] [Thread-4 (]: SQL status: SELECT 17 in 0.008 seconds
[0m22:11:21.374828 [debug] [Thread-2 (]: SQL status: SELECT 10 in 0.008 seconds
[0m22:11:21.375053 [debug] [Thread-3 (]: On model.ecommerce_dw.daily_sales: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.daily_sales"} */
alter table "ecommerce_dw"."public"."daily_sales__dbt_tmp" rename to "daily_sales"
[0m22:11:21.376610 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_dw.product_performance"
[0m22:11:21.378005 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_dw.customer_ltv"
[0m22:11:21.378271 [debug] [Thread-4 (]: On model.ecommerce_dw.product_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.product_performance"} */
alter table "ecommerce_dw"."public"."product_performance__dbt_tmp" rename to "product_performance"
[0m22:11:21.378506 [debug] [Thread-2 (]: On model.ecommerce_dw.customer_ltv: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.customer_ltv"} */
alter table "ecommerce_dw"."public"."customer_ltv__dbt_tmp" rename to "customer_ltv"
[0m22:11:21.378726 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:11:21.379486 [debug] [Thread-3 (]: On model.ecommerce_dw.daily_sales: COMMIT
[0m22:11:21.379701 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:11:21.379887 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:11:21.380073 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_dw.daily_sales"
[0m22:11:21.380727 [debug] [Thread-2 (]: On model.ecommerce_dw.customer_ltv: COMMIT
[0m22:11:21.381410 [debug] [Thread-4 (]: On model.ecommerce_dw.product_performance: COMMIT
[0m22:11:21.381617 [debug] [Thread-3 (]: On model.ecommerce_dw.daily_sales: COMMIT
[0m22:11:21.381816 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_dw.customer_ltv"
[0m22:11:21.382008 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_dw.product_performance"
[0m22:11:21.382210 [debug] [Thread-2 (]: On model.ecommerce_dw.customer_ltv: COMMIT
[0m22:11:21.382392 [debug] [Thread-4 (]: On model.ecommerce_dw.product_performance: COMMIT
[0m22:11:21.383773 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m22:11:21.384927 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_dw"."public"."daily_sales__dbt_backup"
[0m22:11:21.385144 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m22:11:21.386691 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_dw.daily_sales"
[0m22:11:21.386902 [debug] [Thread-4 (]: SQL status: COMMIT in 0.004 seconds
[0m22:11:21.387938 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_dw"."public"."customer_ltv__dbt_backup"
[0m22:11:21.388150 [debug] [Thread-3 (]: On model.ecommerce_dw.daily_sales: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.daily_sales"} */
drop table if exists "ecommerce_dw"."public"."daily_sales__dbt_backup" cascade
[0m22:11:21.389138 [debug] [Thread-4 (]: Applying DROP to: "ecommerce_dw"."public"."product_performance__dbt_backup"
[0m22:11:21.389640 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_dw.customer_ltv"
[0m22:11:21.390032 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_dw.product_performance"
[0m22:11:21.390246 [debug] [Thread-2 (]: On model.ecommerce_dw.customer_ltv: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.customer_ltv"} */
drop table if exists "ecommerce_dw"."public"."customer_ltv__dbt_backup" cascade
[0m22:11:21.390463 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.001 seconds
[0m22:11:21.390658 [debug] [Thread-4 (]: On model.ecommerce_dw.product_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.product_performance"} */
drop table if exists "ecommerce_dw"."public"."product_performance__dbt_backup" cascade
[0m22:11:21.391388 [debug] [Thread-3 (]: On model.ecommerce_dw.daily_sales: Close
[0m22:11:21.391580 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.001 seconds
[0m22:11:21.392395 [debug] [Thread-2 (]: On model.ecommerce_dw.customer_ltv: Close
[0m22:11:21.392599 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.001 seconds
[0m22:11:21.392983 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e1ba1a3-125e-4765-9064-330d66511e21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B301447E0>]}
[0m22:11:21.393290 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e1ba1a3-125e-4765-9064-330d66511e21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B301B6030>]}
[0m22:11:21.393932 [debug] [Thread-4 (]: On model.ecommerce_dw.product_performance: Close
[0m22:11:21.394273 [info ] [Thread-3 (]: 3 of 4 OK created sql table model public.daily_sales ........................... [[32mSELECT 1[0m in 0.06s]
[0m22:11:21.395105 [debug] [Thread-3 (]: Finished running node model.ecommerce_dw.daily_sales
[0m22:11:21.395356 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e1ba1a3-125e-4765-9064-330d66511e21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B2EF427D0>]}
[0m22:11:21.394597 [info ] [Thread-2 (]: 2 of 4 OK created sql table model public.customer_ltv .......................... [[32mSELECT 10[0m in 0.06s]
[0m22:11:21.396155 [debug] [Thread-2 (]: Finished running node model.ecommerce_dw.customer_ltv
[0m22:11:21.395836 [info ] [Thread-4 (]: 4 of 4 OK created sql table model public.product_performance ................... [[32mSELECT 17[0m in 0.06s]
[0m22:11:21.396579 [debug] [Thread-4 (]: Finished running node model.ecommerce_dw.product_performance
[0m22:11:21.397313 [debug] [MainThread]: Using postgres connection "master"
[0m22:11:21.397477 [debug] [MainThread]: On master: BEGIN
[0m22:11:21.397603 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:11:21.403869 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m22:11:21.404091 [debug] [MainThread]: On master: COMMIT
[0m22:11:21.404237 [debug] [MainThread]: Using postgres connection "master"
[0m22:11:21.404441 [debug] [MainThread]: On master: COMMIT
[0m22:11:21.404824 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:11:21.404988 [debug] [MainThread]: On master: Close
[0m22:11:21.405247 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:11:21.405490 [debug] [MainThread]: Connection 'list_ecommerce_dw' was properly closed.
[0m22:11:21.405675 [debug] [MainThread]: Connection 'list_ecommerce_dw_public' was properly closed.
[0m22:11:21.405799 [debug] [MainThread]: Connection 'model.ecommerce_dw.stg_sales' was properly closed.
[0m22:11:21.405927 [debug] [MainThread]: Connection 'model.ecommerce_dw.daily_sales' was properly closed.
[0m22:11:21.406041 [debug] [MainThread]: Connection 'model.ecommerce_dw.customer_ltv' was properly closed.
[0m22:11:21.406250 [debug] [MainThread]: Connection 'model.ecommerce_dw.product_performance' was properly closed.
[0m22:11:21.406469 [info ] [MainThread]: 
[0m22:11:21.406732 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m22:11:21.407362 [debug] [MainThread]: Command end result
[0m22:11:21.417729 [debug] [MainThread]: Wrote artifact WritableManifest to D:\ML Projects\ECommerce-Sales-Warehouse\dbt_project\target\manifest.json
[0m22:11:21.418929 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\ML Projects\ECommerce-Sales-Warehouse\dbt_project\target\semantic_manifest.json
[0m22:11:21.422274 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\ML Projects\ECommerce-Sales-Warehouse\dbt_project\target\run_results.json
[0m22:11:21.422448 [info ] [MainThread]: 
[0m22:11:21.422713 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:11:21.422945 [info ] [MainThread]: 
[0m22:11:21.423461 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m22:11:21.424060 [debug] [MainThread]: Command `dbt run` succeeded at 22:11:21.423984 after 0.83 seconds
[0m22:11:21.424258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B28509E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B301767B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026B2C113EF0>]}
[0m22:11:21.424558 [debug] [MainThread]: Flushing usage events
[0m22:11:21.929788 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:45:42.479390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002829EB64C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282A0ABFED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282A0ABFB10>]}


============================== 22:45:42.481827 | ed846bac-e101-4fd0-a5bc-9ad202aedfdd ==============================
[0m22:45:42.481827 [info ] [MainThread]: Running with dbt=1.11.4
[0m22:45:42.482256 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'write_json': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'log_format': 'default', 'profiles_dir': '.', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'invocation_command': 'dbt run --profiles-dir .', 'use_experimental_parser': 'False', 'log_path': 'D:\\ML Projects\\ECommerce-Sales-Warehouse\\dbt_project\\logs'}
[0m22:45:42.571971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ed846bac-e101-4fd0-a5bc-9ad202aedfdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002829EDE9810>]}
[0m22:45:42.606793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ed846bac-e101-4fd0-a5bc-9ad202aedfdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282A091F350>]}
[0m22:45:42.607328 [info ] [MainThread]: Registered adapter: postgres=1.8.0
[0m22:45:42.711550 [debug] [MainThread]: checksum: 092b177ba87eb6bb3c55954c38aa57900eebac336561eb9ee32218428aa81d43, vars: {}, profile: , target: , version: 1.11.4
[0m22:45:42.759839 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:45:42.760056 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m22:45:42.760185 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:45:42.773109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ed846bac-e101-4fd0-a5bc-9ad202aedfdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282A0B4DA50>]}
[0m22:45:42.800550 [debug] [MainThread]: Wrote artifact WritableManifest to D:\ML Projects\ECommerce-Sales-Warehouse\dbt_project\target\manifest.json
[0m22:45:42.801750 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\ML Projects\ECommerce-Sales-Warehouse\dbt_project\target\semantic_manifest.json
[0m22:45:42.810879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ed846bac-e101-4fd0-a5bc-9ad202aedfdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282A0941130>]}
[0m22:45:42.811137 [info ] [MainThread]: Found 4 models, 462 macros
[0m22:45:42.811463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed846bac-e101-4fd0-a5bc-9ad202aedfdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282A0C642F0>]}
[0m22:45:42.812559 [info ] [MainThread]: 
[0m22:45:42.812835 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:45:42.813030 [info ] [MainThread]: 
[0m22:45:42.813363 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m22:45:42.815454 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_dw'
[0m22:45:42.844280 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_dw"
[0m22:45:42.844505 [debug] [ThreadPool]: On list_ecommerce_dw: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "connection_name": "list_ecommerce_dw"} */

    select distinct nspname from pg_namespace
  
[0m22:45:42.844652 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:45:42.856369 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.012 seconds
[0m22:45:42.857097 [debug] [ThreadPool]: On list_ecommerce_dw: Close
[0m22:45:42.858117 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_dw_public'
[0m22:45:42.861341 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_dw_public"
[0m22:45:42.861531 [debug] [ThreadPool]: On list_ecommerce_dw_public: BEGIN
[0m22:45:42.861665 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:45:42.867709 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m22:45:42.867936 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_dw_public"
[0m22:45:42.868132 [debug] [ThreadPool]: On list_ecommerce_dw_public: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "connection_name": "list_ecommerce_dw_public"} */
select
      'ecommerce_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m22:45:42.870094 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.002 seconds
[0m22:45:42.870789 [debug] [ThreadPool]: On list_ecommerce_dw_public: ROLLBACK
[0m22:45:42.871202 [debug] [ThreadPool]: On list_ecommerce_dw_public: Close
[0m22:45:42.874485 [debug] [MainThread]: Using postgres connection "master"
[0m22:45:42.874678 [debug] [MainThread]: On master: BEGIN
[0m22:45:42.874844 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:45:42.894301 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m22:45:42.894526 [debug] [MainThread]: Using postgres connection "master"
[0m22:45:42.894718 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m22:45:42.898071 [debug] [MainThread]: SQL status: SELECT 10 in 0.003 seconds
[0m22:45:42.899624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed846bac-e101-4fd0-a5bc-9ad202aedfdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282A2213EE0>]}
[0m22:45:42.899845 [debug] [MainThread]: On master: ROLLBACK
[0m22:45:42.900286 [debug] [MainThread]: Using postgres connection "master"
[0m22:45:42.900454 [debug] [MainThread]: On master: BEGIN
[0m22:45:42.901057 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m22:45:42.901240 [debug] [MainThread]: On master: COMMIT
[0m22:45:42.901388 [debug] [MainThread]: Using postgres connection "master"
[0m22:45:42.901630 [debug] [MainThread]: On master: COMMIT
[0m22:45:42.902067 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:45:42.902252 [debug] [MainThread]: On master: Close
[0m22:45:42.905622 [debug] [Thread-1 (]: Began running node model.ecommerce_dw.stg_sales
[0m22:45:42.906129 [info ] [Thread-1 (]: 1 of 4 START sql view model public.stg_sales ................................... [RUN]
[0m22:45:42.906676 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.ecommerce_dw.stg_sales'
[0m22:45:42.906889 [debug] [Thread-1 (]: Began compiling node model.ecommerce_dw.stg_sales
[0m22:45:42.910953 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_dw.stg_sales"
[0m22:45:42.911599 [debug] [Thread-1 (]: Began executing node model.ecommerce_dw.stg_sales
[0m22:45:42.931512 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_dw.stg_sales"
[0m22:45:42.932185 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dw.stg_sales"
[0m22:45:42.932408 [debug] [Thread-1 (]: On model.ecommerce_dw.stg_sales: BEGIN
[0m22:45:42.932649 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:45:42.956801 [debug] [Thread-1 (]: SQL status: BEGIN in 0.024 seconds
[0m22:45:42.957088 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dw.stg_sales"
[0m22:45:42.957267 [debug] [Thread-1 (]: On model.ecommerce_dw.stg_sales: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.stg_sales"} */

  create view "ecommerce_dw"."public"."stg_sales__dbt_tmp"
    
    
  as (
    -- Staging model: Clean fact_sales data
-- This is a foundation for marts



SELECT 
    f.sale_id,
    f.order_id,
    f.user_id,
    f.product_id,
    f.date_id,
    f.quantity,
    f.unit_price,
    f.revenue,
    f.created_at,
    
    -- Join dimension data for easier querying
    p.product_title,
    p.category,
    u.username,
    u.email,
    d.full_date,
    d.year,
    d.month,
    d.quarter
    
FROM fact_sales f
LEFT JOIN dim_product p ON f.product_id = p.product_id
LEFT JOIN dim_user u ON f.user_id = u.user_id
LEFT JOIN dim_date d ON f.date_id = d.date_id
WHERE f.created_at IS NOT NULL
  );
[0m22:45:42.959581 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m22:45:42.963360 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dw.stg_sales"
[0m22:45:42.963571 [debug] [Thread-1 (]: On model.ecommerce_dw.stg_sales: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.stg_sales"} */
alter table "ecommerce_dw"."public"."stg_sales" rename to "stg_sales__dbt_backup"
[0m22:45:42.964211 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:45:42.965895 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dw.stg_sales"
[0m22:45:42.966090 [debug] [Thread-1 (]: On model.ecommerce_dw.stg_sales: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.stg_sales"} */
alter table "ecommerce_dw"."public"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m22:45:42.966692 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:45:42.975735 [debug] [Thread-1 (]: On model.ecommerce_dw.stg_sales: COMMIT
[0m22:45:42.975959 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dw.stg_sales"
[0m22:45:42.976134 [debug] [Thread-1 (]: On model.ecommerce_dw.stg_sales: COMMIT
[0m22:45:42.978090 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m22:45:42.981091 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_dw"."public"."stg_sales__dbt_backup"
[0m22:45:42.983521 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dw.stg_sales"
[0m22:45:42.983722 [debug] [Thread-1 (]: On model.ecommerce_dw.stg_sales: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.stg_sales"} */
drop view if exists "ecommerce_dw"."public"."stg_sales__dbt_backup" cascade
[0m22:45:42.985973 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m22:45:42.987190 [debug] [Thread-1 (]: On model.ecommerce_dw.stg_sales: Close
[0m22:45:42.988240 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed846bac-e101-4fd0-a5bc-9ad202aedfdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282A206FC50>]}
[0m22:45:42.988613 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public.stg_sales .............................. [[32mCREATE VIEW[0m in 0.08s]
[0m22:45:42.989044 [debug] [Thread-1 (]: Finished running node model.ecommerce_dw.stg_sales
[0m22:45:42.989492 [debug] [Thread-3 (]: Began running node model.ecommerce_dw.daily_sales
[0m22:45:42.989965 [debug] [Thread-2 (]: Began running node model.ecommerce_dw.customer_ltv
[0m22:45:42.990206 [debug] [Thread-4 (]: Began running node model.ecommerce_dw.product_performance
[0m22:45:42.989776 [info ] [Thread-3 (]: 3 of 4 START sql table model public.daily_sales ................................ [RUN]
[0m22:45:42.990513 [info ] [Thread-2 (]: 2 of 4 START sql table model public.customer_ltv ............................... [RUN]
[0m22:45:42.990855 [info ] [Thread-4 (]: 4 of 4 START sql table model public.product_performance ........................ [RUN]
[0m22:45:42.992823 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_dw.daily_sales'
[0m22:45:42.993112 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.ecommerce_dw.customer_ltv'
[0m22:45:42.993381 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.ecommerce_dw.product_performance'
[0m22:45:42.993648 [debug] [Thread-3 (]: Began compiling node model.ecommerce_dw.daily_sales
[0m22:45:42.993859 [debug] [Thread-2 (]: Began compiling node model.ecommerce_dw.customer_ltv
[0m22:45:42.994056 [debug] [Thread-4 (]: Began compiling node model.ecommerce_dw.product_performance
[0m22:45:42.995421 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_dw.daily_sales"
[0m22:45:42.996758 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_dw.customer_ltv"
[0m22:45:43.025443 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_dw.product_performance"
[0m22:45:43.026112 [debug] [Thread-3 (]: Began executing node model.ecommerce_dw.daily_sales
[0m22:45:43.031569 [debug] [Thread-2 (]: Began executing node model.ecommerce_dw.customer_ltv
[0m22:45:43.037165 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_dw.daily_sales"
[0m22:45:43.038843 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_dw.customer_ltv"
[0m22:45:43.039140 [debug] [Thread-4 (]: Began executing node model.ecommerce_dw.product_performance
[0m22:45:43.040734 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_dw.product_performance"
[0m22:45:43.041126 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_dw.daily_sales"
[0m22:45:43.041396 [debug] [Thread-3 (]: On model.ecommerce_dw.daily_sales: BEGIN
[0m22:45:43.041615 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_dw.customer_ltv"
[0m22:45:43.041895 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:45:43.042158 [debug] [Thread-2 (]: On model.ecommerce_dw.customer_ltv: BEGIN
[0m22:45:43.042524 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_dw.product_performance"
[0m22:45:43.042736 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:45:43.042940 [debug] [Thread-4 (]: On model.ecommerce_dw.product_performance: BEGIN
[0m22:45:43.043216 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:45:43.049458 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m22:45:43.049676 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_dw.customer_ltv"
[0m22:45:43.049857 [debug] [Thread-2 (]: On model.ecommerce_dw.customer_ltv: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.customer_ltv"} */

  
    

  create  table "ecommerce_dw"."public"."customer_ltv__dbt_tmp"
  
  
    as
  
  (
    -- Customer Lifetime Value
-- Aggregated customer metrics



SELECT 
    user_id,
    username,
    email,
    
    COUNT(DISTINCT order_id) as lifetime_orders,
    SUM(revenue) as lifetime_value,
    AVG(revenue) as avg_order_value,
    SUM(quantity) as total_items_purchased,
    
    MIN(created_at) as first_order_date,
    MAX(created_at) as last_order_date,
    
    -- Calculate days between first and last order
    EXTRACT(DAY FROM (MAX(created_at) - MIN(created_at))) as customer_tenure_days,
    
    -- Categorize customers
    CASE 
        WHEN COUNT(DISTINCT order_id) >= 20 THEN 'VIP'
        WHEN COUNT(DISTINCT order_id) >= 10 THEN 'Regular'
        ELSE 'Casual'
    END as customer_segment
    
FROM "ecommerce_dw"."public"."stg_sales"
GROUP BY user_id, username, email
ORDER BY lifetime_value DESC
  );
  
[0m22:45:43.055885 [debug] [Thread-2 (]: SQL status: SELECT 121 in 0.006 seconds
[0m22:45:43.059536 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_dw.customer_ltv"
[0m22:45:43.059737 [debug] [Thread-2 (]: On model.ecommerce_dw.customer_ltv: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.customer_ltv"} */
alter table "ecommerce_dw"."public"."customer_ltv" rename to "customer_ltv__dbt_backup"
[0m22:45:43.060296 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:45:43.061622 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_dw.customer_ltv"
[0m22:45:43.061820 [debug] [Thread-2 (]: On model.ecommerce_dw.customer_ltv: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.customer_ltv"} */
alter table "ecommerce_dw"."public"."customer_ltv__dbt_tmp" rename to "customer_ltv"
[0m22:45:43.062399 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:45:43.063317 [debug] [Thread-2 (]: On model.ecommerce_dw.customer_ltv: COMMIT
[0m22:45:43.063533 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_dw.customer_ltv"
[0m22:45:43.063695 [debug] [Thread-2 (]: On model.ecommerce_dw.customer_ltv: COMMIT
[0m22:45:43.066201 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m22:45:43.067409 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_dw"."public"."customer_ltv__dbt_backup"
[0m22:45:43.068920 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_dw.customer_ltv"
[0m22:45:43.069131 [debug] [Thread-2 (]: On model.ecommerce_dw.customer_ltv: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.customer_ltv"} */
drop table if exists "ecommerce_dw"."public"."customer_ltv__dbt_backup" cascade
[0m22:45:43.069854 [debug] [Thread-3 (]: SQL status: BEGIN in 0.028 seconds
[0m22:45:43.070080 [debug] [Thread-4 (]: SQL status: BEGIN in 0.027 seconds
[0m22:45:43.070292 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_dw.daily_sales"
[0m22:45:43.070495 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_dw.product_performance"
[0m22:45:43.070735 [debug] [Thread-3 (]: On model.ecommerce_dw.daily_sales: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.daily_sales"} */

  
    

  create  table "ecommerce_dw"."public"."daily_sales__dbt_tmp"
  
  
    as
  
  (
    -- Daily Sales Aggregations
-- Business metrics aggregated by day



SELECT 
    full_date,
    year,
    month,
    quarter,
    
    COUNT(DISTINCT order_id) as total_orders,
    COUNT(DISTINCT user_id) as unique_customers,
    SUM(quantity) as total_items_sold,
    SUM(revenue) as total_revenue,
    AVG(revenue) as avg_order_value,
    MAX(revenue) as max_order_value,
    MIN(revenue) as min_order_value
    
FROM "ecommerce_dw"."public"."stg_sales"
GROUP BY full_date, year, month, quarter
ORDER BY full_date DESC
  );
  
[0m22:45:43.070977 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.002 seconds
[0m22:45:43.071191 [debug] [Thread-4 (]: On model.ecommerce_dw.product_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.product_performance"} */

  
    

  create  table "ecommerce_dw"."public"."product_performance__dbt_tmp"
  
  
    as
  
  (
    -- Product Performance Analytics
-- Product-level metrics



SELECT 
    product_id,
    product_title,
    category,
    
    COUNT(DISTINCT order_id) as times_ordered,
    SUM(quantity) as total_units_sold,
    SUM(revenue) as total_revenue,
    AVG(unit_price) as avg_sale_price,
    
    -- Performance metrics
    RANK() OVER (ORDER BY SUM(revenue) DESC) as revenue_rank,
    RANK() OVER (PARTITION BY category ORDER BY SUM(revenue) DESC) as category_rank,
    
    -- Calculate what % of total revenue
    ROUND(
        100.0 * SUM(revenue) / SUM(SUM(revenue)) OVER (),
        2
    ) as pct_of_total_revenue
    
FROM "ecommerce_dw"."public"."stg_sales"
GROUP BY product_id, product_title, category
ORDER BY total_revenue DESC
  );
  
[0m22:45:43.072014 [debug] [Thread-2 (]: On model.ecommerce_dw.customer_ltv: Close
[0m22:45:43.072557 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed846bac-e101-4fd0-a5bc-9ad202aedfdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282A209B750>]}
[0m22:45:43.072906 [info ] [Thread-2 (]: 2 of 4 OK created sql table model public.customer_ltv .......................... [[32mSELECT 121[0m in 0.08s]
[0m22:45:43.073327 [debug] [Thread-2 (]: Finished running node model.ecommerce_dw.customer_ltv
[0m22:45:43.076188 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.005 seconds
[0m22:45:43.077700 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_dw.daily_sales"
[0m22:45:43.077969 [debug] [Thread-4 (]: SQL status: SELECT 20 in 0.006 seconds
[0m22:45:43.078347 [debug] [Thread-3 (]: On model.ecommerce_dw.daily_sales: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.daily_sales"} */
alter table "ecommerce_dw"."public"."daily_sales" rename to "daily_sales__dbt_backup"
[0m22:45:43.079984 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_dw.product_performance"
[0m22:45:43.080241 [debug] [Thread-4 (]: On model.ecommerce_dw.product_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.product_performance"} */
alter table "ecommerce_dw"."public"."product_performance" rename to "product_performance__dbt_backup"
[0m22:45:43.080626 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:45:43.080833 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:45:43.082160 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_dw.daily_sales"
[0m22:45:43.083425 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_dw.product_performance"
[0m22:45:43.083646 [debug] [Thread-3 (]: On model.ecommerce_dw.daily_sales: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.daily_sales"} */
alter table "ecommerce_dw"."public"."daily_sales__dbt_tmp" rename to "daily_sales"
[0m22:45:43.083867 [debug] [Thread-4 (]: On model.ecommerce_dw.product_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.product_performance"} */
alter table "ecommerce_dw"."public"."product_performance__dbt_tmp" rename to "product_performance"
[0m22:45:43.084511 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m22:45:43.084718 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m22:45:43.085488 [debug] [Thread-3 (]: On model.ecommerce_dw.daily_sales: COMMIT
[0m22:45:43.086191 [debug] [Thread-4 (]: On model.ecommerce_dw.product_performance: COMMIT
[0m22:45:43.086406 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_dw.daily_sales"
[0m22:45:43.086630 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_dw.product_performance"
[0m22:45:43.086850 [debug] [Thread-3 (]: On model.ecommerce_dw.daily_sales: COMMIT
[0m22:45:43.087039 [debug] [Thread-4 (]: On model.ecommerce_dw.product_performance: COMMIT
[0m22:45:43.088629 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m22:45:43.089769 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_dw"."public"."daily_sales__dbt_backup"
[0m22:45:43.089972 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m22:45:43.090339 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_dw.daily_sales"
[0m22:45:43.091339 [debug] [Thread-4 (]: Applying DROP to: "ecommerce_dw"."public"."product_performance__dbt_backup"
[0m22:45:43.091563 [debug] [Thread-3 (]: On model.ecommerce_dw.daily_sales: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.daily_sales"} */
drop table if exists "ecommerce_dw"."public"."daily_sales__dbt_backup" cascade
[0m22:45:43.091936 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_dw.product_performance"
[0m22:45:43.092181 [debug] [Thread-4 (]: On model.ecommerce_dw.product_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.product_performance"} */
drop table if exists "ecommerce_dw"."public"."product_performance__dbt_backup" cascade
[0m22:45:43.094019 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.002 seconds
[0m22:45:43.094846 [debug] [Thread-3 (]: On model.ecommerce_dw.daily_sales: Close
[0m22:45:43.095065 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.003 seconds
[0m22:45:43.095826 [debug] [Thread-4 (]: On model.ecommerce_dw.product_performance: Close
[0m22:45:43.096117 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed846bac-e101-4fd0-a5bc-9ad202aedfdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282A24C0E10>]}
[0m22:45:43.096889 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed846bac-e101-4fd0-a5bc-9ad202aedfdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282A236A250>]}
[0m22:45:43.096624 [info ] [Thread-3 (]: 3 of 4 OK created sql table model public.daily_sales ........................... [[32mSELECT 1[0m in 0.10s]
[0m22:45:43.097618 [debug] [Thread-3 (]: Finished running node model.ecommerce_dw.daily_sales
[0m22:45:43.097310 [info ] [Thread-4 (]: 4 of 4 OK created sql table model public.product_performance ................... [[32mSELECT 20[0m in 0.10s]
[0m22:45:43.098108 [debug] [Thread-4 (]: Finished running node model.ecommerce_dw.product_performance
[0m22:45:43.098844 [debug] [MainThread]: Using postgres connection "master"
[0m22:45:43.099011 [debug] [MainThread]: On master: BEGIN
[0m22:45:43.099144 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:45:43.105207 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m22:45:43.105445 [debug] [MainThread]: On master: COMMIT
[0m22:45:43.105645 [debug] [MainThread]: Using postgres connection "master"
[0m22:45:43.105794 [debug] [MainThread]: On master: COMMIT
[0m22:45:43.106170 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m22:45:43.106350 [debug] [MainThread]: On master: Close
[0m22:45:43.106597 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:45:43.106788 [debug] [MainThread]: Connection 'list_ecommerce_dw' was properly closed.
[0m22:45:43.106906 [debug] [MainThread]: Connection 'list_ecommerce_dw_public' was properly closed.
[0m22:45:43.107022 [debug] [MainThread]: Connection 'model.ecommerce_dw.stg_sales' was properly closed.
[0m22:45:43.107132 [debug] [MainThread]: Connection 'model.ecommerce_dw.daily_sales' was properly closed.
[0m22:45:43.107238 [debug] [MainThread]: Connection 'model.ecommerce_dw.customer_ltv' was properly closed.
[0m22:45:43.107340 [debug] [MainThread]: Connection 'model.ecommerce_dw.product_performance' was properly closed.
[0m22:45:43.107501 [info ] [MainThread]: 
[0m22:45:43.107742 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m22:45:43.108460 [debug] [MainThread]: Command end result
[0m22:45:43.118012 [debug] [MainThread]: Wrote artifact WritableManifest to D:\ML Projects\ECommerce-Sales-Warehouse\dbt_project\target\manifest.json
[0m22:45:43.119224 [debug] [MainThread]: Wrote artifact SemanticManifest to D:\ML Projects\ECommerce-Sales-Warehouse\dbt_project\target\semantic_manifest.json
[0m22:45:43.122583 [debug] [MainThread]: Wrote artifact RunExecutionResult to D:\ML Projects\ECommerce-Sales-Warehouse\dbt_project\target\run_results.json
[0m22:45:43.122756 [info ] [MainThread]: 
[0m22:45:43.122999 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:45:43.123252 [info ] [MainThread]: 
[0m22:45:43.123525 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m22:45:43.124009 [debug] [MainThread]: Command `dbt run` succeeded at 22:45:43.123941 after 0.73 seconds
[0m22:45:43.124199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282A0B1C8A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002829A919E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282A0455190>]}
[0m22:45:43.124377 [debug] [MainThread]: Flushing usage events
[0m22:45:43.615032 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:49:52.687073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0a43d3ead0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0a43d43250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0a43d3f950>]}


============================== 21:49:52.691632 | f72133a2-2afd-4e41-abfe-d3ea47415412 ==============================
[0m21:49:52.691632 [info ] [MainThread]: Running with dbt=1.11.4
[0m21:49:52.692103 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'log_format': 'default', 'quiet': 'False', 'write_json': 'True', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'invocation_command': 'dbt run --profiles-dir .', 'introspect': 'True', 'cache_selected_only': 'False', 'no_print': 'None', 'indirect_selection': 'eager', 'version_check': 'True', 'empty': 'False', 'fail_fast': 'False', 'static_parser': 'True', 'use_experimental_parser': 'False', 'printer_width': '80', 'log_cache_events': 'False', 'target_path': 'None', 'log_path': '/dbt_project/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '.', 'warn_error': 'None'}
[0m21:49:52.774519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f72133a2-2afd-4e41-abfe-d3ea47415412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0a43328390>]}
[0m21:49:52.808464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f72133a2-2afd-4e41-abfe-d3ea47415412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0a46c18c10>]}
[0m21:49:52.809244 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m21:49:52.841494 [debug] [MainThread]: checksum: 092b177ba87eb6bb3c55954c38aa57900eebac336561eb9ee32218428aa81d43, vars: {}, profile: , target: , version: 1.11.4
[0m21:49:52.904952 [debug] [MainThread]: Partial parsing enabled: 134 files deleted, 135 files added, 0 files changed.
[0m21:49:52.905510 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/position.sql
[0m21:49:52.905961 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/seeds/helpers.sql
[0m21:49:52.906308 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/drop_backup.sql
[0m21:49:52.906648 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/view.sql
[0m21:49:52.907284 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/adapters.sql
[0m21:49:52.907673 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/hooks.sql
[0m21:49:52.908000 [debug] [MainThread]: Partial parsing: added file: dbt://macros/adapters/freshness.sql
[0m21:49:52.908337 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/materializations/functions/scalar.sql
[0m21:49:52.908656 [debug] [MainThread]: Partial parsing: added file: dbt://macros/adapters/columns.sql
[0m21:49:52.908995 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/utils/split_part.sql
[0m21:49:52.909290 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/tests/unit.sql
[0m21:49:52.909605 [debug] [MainThread]: Partial parsing: added file: ecommerce_dw://models/staging/stg_sales.sql
[0m21:49:52.909902 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/table/rename.sql
[0m21:49:52.910234 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/utils/last_day.sql
[0m21:49:52.910524 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/cast_bool_to_text.sql
[0m21:49:52.910842 [debug] [MainThread]: Partial parsing: added file: dbt://macros/adapters/schema.sql
[0m21:49:52.911189 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/snapshots/snapshot_merge.sql
[0m21:49:52.911513 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/view/replace.sql
[0m21:49:52.911836 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/snapshots/helpers.sql
[0m21:49:52.912155 [debug] [MainThread]: Partial parsing: added file: dbt://macros/adapters/indexes.sql
[0m21:49:52.912442 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/tests/where_subquery.sql
[0m21:49:52.912791 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/timestamps.sql
[0m21:49:52.913283 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/dateadd.sql
[0m21:49:52.913990 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/concat.sql
[0m21:49:52.914522 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/right.sql
[0m21:49:52.915119 [debug] [MainThread]: Partial parsing: added file: ecommerce_dw://models/marts/customer_ltv.sql
[0m21:49:52.915515 [debug] [MainThread]: Partial parsing: added file: dbt://macros/get_custom_name/get_custom_alias.sql
[0m21:49:52.915897 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/array_construct.sql
[0m21:49:52.916335 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/functions/aggregate.sql
[0m21:49:52.916746 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/rename_intermediate.sql
[0m21:49:52.917147 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/table/rename.sql
[0m21:49:52.917539 [debug] [MainThread]: Partial parsing: added file: dbt://macros/generic_test_sql/not_null.sql
[0m21:49:52.917936 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/datediff.sql
[0m21:49:52.918390 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/materialized_view/rename.sql
[0m21:49:52.918817 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/incremental/merge.sql
[0m21:49:52.919315 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/view/create.sql
[0m21:49:52.919857 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/utils/any_value.sql
[0m21:49:52.920265 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/column/columns_spec_ddl.sql
[0m21:49:52.920628 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/materialized_view/alter.sql
[0m21:49:52.921133 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/date_spine.sql
[0m21:49:52.921528 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/table/replace.sql
[0m21:49:52.921899 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/materialized_view/refresh.sql
[0m21:49:52.922730 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/except.sql
[0m21:49:52.923926 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/listagg.sql
[0m21:49:52.924848 [debug] [MainThread]: Partial parsing: added file: ecommerce_dw://models/marts/product_performance.sql
[0m21:49:52.928464 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/materialized_view/drop.sql
[0m21:49:52.929107 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/bool_or.sql
[0m21:49:52.929527 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/seeds/seed.sql
[0m21:49:52.930594 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/intersect.sql
[0m21:49:52.931049 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/replace.sql
[0m21:49:52.931440 [debug] [MainThread]: Partial parsing: added file: ecommerce_dw://models/marts/daily_sales.sql
[0m21:49:52.931790 [debug] [MainThread]: Partial parsing: added file: dbt://macros/adapters/timestamps.sql
[0m21:49:52.932153 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/snapshots/snapshot.sql
[0m21:49:52.932519 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/create.sql
[0m21:49:52.932909 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/materializations/incremental_strategies.sql
[0m21:49:52.933240 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/materialized_view/alter.sql
[0m21:49:52.933595 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/schema.sql
[0m21:49:52.933976 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/length.sql
[0m21:49:52.934319 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/clone/clone.sql
[0m21:49:52.934679 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/equals.sql
[0m21:49:52.934984 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/functions/helpers.sql
[0m21:49:52.935412 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/date_trunc.sql
[0m21:49:52.935777 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/table/drop.sql
[0m21:49:52.936143 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/escape_single_quotes.sql
[0m21:49:52.936478 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/split_part.sql
[0m21:49:52.936785 [debug] [MainThread]: Partial parsing: added file: dbt://tests/generic/builtin.sql
[0m21:49:52.937147 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/table/replace.sql
[0m21:49:52.937543 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/incremental/on_schema_change.sql
[0m21:49:52.938154 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/data_types.sql
[0m21:49:52.938695 [debug] [MainThread]: Partial parsing: added file: dbt://macros/generic_test_sql/relationships.sql
[0m21:49:52.939299 [debug] [MainThread]: Partial parsing: added file: dbt://macros/python_model/python.sql
[0m21:49:52.940742 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/clone/can_clone_table.sql
[0m21:49:52.941428 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/utils/datediff.sql
[0m21:49:52.941763 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/view/rename.sql
[0m21:49:52.942115 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/view/rename.sql
[0m21:49:52.942475 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/materialized_view/describe.sql
[0m21:49:52.942810 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/incremental/incremental.sql
[0m21:49:52.943295 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/utils/listagg.sql
[0m21:49:52.943656 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/tests/test.sql
[0m21:49:52.944006 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/rename.sql
[0m21:49:52.944371 [debug] [MainThread]: Partial parsing: added file: dbt://macros/adapters/relation.sql
[0m21:49:52.944723 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/materialized_view.sql
[0m21:49:52.945154 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/replace.sql
[0m21:49:52.945537 [debug] [MainThread]: Partial parsing: added file: dbt://macros/adapters/show.sql
[0m21:49:52.945907 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/literal.sql
[0m21:49:52.946299 [debug] [MainThread]: Partial parsing: added file: dbt://docs/overview.md
[0m21:49:52.947229 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/utils/columns_spec_ddl.sql
[0m21:49:52.947648 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/cast.sql
[0m21:49:52.948054 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/catalog.sql
[0m21:49:52.948429 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/array_concat.sql
[0m21:49:52.948780 [debug] [MainThread]: Partial parsing: added file: dbt://macros/adapters/metadata.sql
[0m21:49:52.949169 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/create_intermediate.sql
[0m21:49:52.949521 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/clone/create_or_replace_clone.sql
[0m21:49:52.949865 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/last_day.sql
[0m21:49:52.950240 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/snapshots/strategies.sql
[0m21:49:52.950558 [debug] [MainThread]: Partial parsing: added file: dbt://macros/etc/statement.sql
[0m21:49:52.950883 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/utils/dateadd.sql
[0m21:49:52.951337 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/materialized_view/replace.sql
[0m21:49:52.951754 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/safe_cast.sql
[0m21:49:52.952108 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/hash.sql
[0m21:49:52.952461 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/materialized_view/refresh.sql
[0m21:49:52.952763 [debug] [MainThread]: Partial parsing: added file: dbt://macros/adapters/validate_sql.sql
[0m21:49:52.953387 [debug] [MainThread]: Partial parsing: added file: dbt://macros/generic_test_sql/unique.sql
[0m21:49:52.953716 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/tests/helpers.sql
[0m21:49:52.954077 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/date.sql
[0m21:49:52.954386 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/functions/scalar.sql
[0m21:49:52.954705 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/configs.sql
[0m21:49:52.955010 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/materializations/snapshot_merge.sql
[0m21:49:52.955466 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/table/drop.sql
[0m21:49:52.955830 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/generate_series.sql
[0m21:49:52.956154 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/incremental/column_helpers.sql
[0m21:49:52.956452 [debug] [MainThread]: Partial parsing: added file: dbt://macros/adapters/persist_docs.sql
[0m21:49:52.956783 [debug] [MainThread]: Partial parsing: added file: dbt://macros/unit_test_sql/get_fixture_sql.sql
[0m21:49:52.957085 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/materialized_view/create.sql
[0m21:49:52.957442 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/table/create.sql
[0m21:49:52.957749 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/drop.sql
[0m21:49:52.958069 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/array_append.sql
[0m21:49:52.958360 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations.sql
[0m21:49:52.958673 [debug] [MainThread]: Partial parsing: added file: dbt://macros/adapters/apply_grants.sql
[0m21:49:52.958987 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/any_value.sql
[0m21:49:52.959424 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/materialized_view/create.sql
[0m21:49:52.959737 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/view/drop.sql
[0m21:49:52.960115 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/table.sql
[0m21:49:52.960523 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/materialized_view/drop.sql
[0m21:49:52.960979 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/create_backup.sql
[0m21:49:52.961359 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/functions/function.sql
[0m21:49:52.961719 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/materialized_view/rename.sql
[0m21:49:52.962148 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/view/replace.sql
[0m21:49:52.962581 [debug] [MainThread]: Partial parsing: added file: dbt://macros/get_custom_name/get_custom_schema.sql
[0m21:49:52.962956 [debug] [MainThread]: Partial parsing: added file: dbt://macros/generic_test_sql/accepted_values.sql
[0m21:49:52.963796 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/incremental/is_incremental.sql
[0m21:49:52.964260 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/incremental/strategies.sql
[0m21:49:52.964609 [debug] [MainThread]: Partial parsing: added file: dbt://macros/get_custom_name/get_custom_database.sql
[0m21:49:52.964990 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/view/drop.sql
[0m21:49:52.965301 [debug] [MainThread]: Partial parsing: added file: dbt://macros/etc/datetime.sql
[0m21:49:52.965637 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\generic_test_sql\unique.sql
[0m21:49:52.965942 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\listagg.sql
[0m21:49:52.966346 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\equals.sql
[0m21:49:52.966750 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\rename.sql
[0m21:49:52.967119 [debug] [MainThread]: Partial parsing: deleted file: ecommerce_dw://models\marts\product_performance.sql
[0m21:49:52.967470 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\tests\where_subquery.sql
[0m21:49:52.967778 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\bool_or.sql
[0m21:49:52.968101 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\create_intermediate.sql
[0m21:49:52.968733 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\get_custom_name\get_custom_database.sql
[0m21:49:52.969059 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\functions\helpers.sql
[0m21:49:52.969345 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\datediff.sql
[0m21:49:52.969614 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\python_model\python.sql
[0m21:49:52.969905 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\utils\split_part.sql
[0m21:49:52.970180 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\materialized_view\drop.sql
[0m21:49:52.970436 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\split_part.sql
[0m21:49:52.970726 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\incremental\incremental.sql
[0m21:49:52.971059 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\unit_test_sql\get_fixture_sql.sql
[0m21:49:52.971329 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\snapshots\snapshot_merge.sql
[0m21:49:52.971590 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\materialized_view\alter.sql
[0m21:49:52.971881 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\materialized_view\describe.sql
[0m21:49:52.972249 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\materialized_view\rename.sql
[0m21:49:52.972597 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\materialized_view\replace.sql
[0m21:49:52.972876 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\intersect.sql
[0m21:49:52.973131 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\snapshots\snapshot.sql
[0m21:49:52.973381 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\utils\any_value.sql
[0m21:49:52.973676 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\incremental\is_incremental.sql
[0m21:49:52.974117 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\incremental\merge.sql
[0m21:49:52.974529 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\data_types.sql
[0m21:49:52.974869 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\materialized_view\create.sql
[0m21:49:52.975209 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\adapters\schema.sql
[0m21:49:52.975505 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\drop.sql
[0m21:49:52.975781 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\schema.sql
[0m21:49:52.976033 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\materialized_view\refresh.sql
[0m21:49:52.976494 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\adapters\columns.sql
[0m21:49:52.976767 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\array_construct.sql
[0m21:49:52.977044 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\incremental\column_helpers.sql
[0m21:49:52.977314 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\incremental\strategies.sql
[0m21:49:52.977566 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\get_custom_name\get_custom_alias.sql
[0m21:49:52.977828 [debug] [MainThread]: Partial parsing: deleted file: dbt://docs\overview.md
[0m21:49:52.978092 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\table\drop.sql
[0m21:49:52.978360 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\create_backup.sql
[0m21:49:52.978615 [debug] [MainThread]: Partial parsing: deleted file: ecommerce_dw://models\marts\daily_sales.sql
[0m21:49:52.978868 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\concat.sql
[0m21:49:52.979252 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\etc\datetime.sql
[0m21:49:52.979520 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\view\drop.sql
[0m21:49:52.979782 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\clone\create_or_replace_clone.sql
[0m21:49:52.980042 [debug] [MainThread]: Partial parsing: deleted file: ecommerce_dw://models\staging\stg_sales.sql
[0m21:49:52.980326 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\timestamps.sql
[0m21:49:52.980593 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\incremental\on_schema_change.sql
[0m21:49:52.980953 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\array_concat.sql
[0m21:49:52.981305 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\generate_series.sql
[0m21:49:52.981667 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\adapters\show.sql
[0m21:49:52.981970 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\escape_single_quotes.sql
[0m21:49:52.982335 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\functions\aggregate.sql
[0m21:49:52.982723 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\functions\scalar.sql
[0m21:49:52.983106 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\view\rename.sql
[0m21:49:52.983432 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\generic_test_sql\accepted_values.sql
[0m21:49:52.983831 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\table\replace.sql
[0m21:49:52.984206 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations.sql
[0m21:49:52.984510 [debug] [MainThread]: Partial parsing: deleted file: ecommerce_dw://models\marts\customer_ltv.sql
[0m21:49:52.984790 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\materialized_view\drop.sql
[0m21:49:52.985045 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\except.sql
[0m21:49:52.985303 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\literal.sql
[0m21:49:52.985573 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\date.sql
[0m21:49:52.985836 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\materialized_view\rename.sql
[0m21:49:52.986116 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\catalog.sql
[0m21:49:52.986379 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\materialized_view\create.sql
[0m21:49:52.986629 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\get_custom_name\get_custom_schema.sql
[0m21:49:52.986932 [debug] [MainThread]: Partial parsing: deleted file: dbt://tests\generic\builtin.sql
[0m21:49:52.987212 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\hash.sql
[0m21:49:52.987628 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\column\columns_spec_ddl.sql
[0m21:49:52.987893 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\materialized_view.sql
[0m21:49:52.988166 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\view\drop.sql
[0m21:49:52.988415 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\generic_test_sql\not_null.sql
[0m21:49:52.988682 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\snapshots\strategies.sql
[0m21:49:52.988946 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\adapters\freshness.sql
[0m21:49:52.989211 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\array_append.sql
[0m21:49:52.989466 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\replace.sql
[0m21:49:52.989725 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\rename_intermediate.sql
[0m21:49:52.989996 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\adapters\metadata.sql
[0m21:49:52.990243 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\materializations\incremental_strategies.sql
[0m21:49:52.990497 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\view\rename.sql
[0m21:49:52.990742 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\table.sql
[0m21:49:52.991026 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\table\rename.sql
[0m21:49:52.991310 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\date_spine.sql
[0m21:49:52.991575 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\table\drop.sql
[0m21:49:52.991920 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\adapters\apply_grants.sql
[0m21:49:52.992208 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\seeds\helpers.sql
[0m21:49:52.992517 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\tests\helpers.sql
[0m21:49:52.992787 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\view\replace.sql
[0m21:49:52.993065 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\view\replace.sql
[0m21:49:52.993331 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\length.sql
[0m21:49:52.993640 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\cast.sql
[0m21:49:52.993895 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\utils\last_day.sql
[0m21:49:52.994158 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\utils\listagg.sql
[0m21:49:52.994455 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\materialized_view\alter.sql
[0m21:49:52.994712 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\materializations\snapshot_merge.sql
[0m21:49:52.994960 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\functions\function.sql
[0m21:49:52.995249 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\snapshots\helpers.sql
[0m21:49:52.995521 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\create.sql
[0m21:49:52.995772 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\any_value.sql
[0m21:49:52.996042 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\adapters\indexes.sql
[0m21:49:52.996288 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\tests\unit.sql
[0m21:49:52.996552 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\configs.sql
[0m21:49:52.996848 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\table\create.sql
[0m21:49:52.997183 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\table\replace.sql
[0m21:49:52.997535 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\view\create.sql
[0m21:49:52.997832 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\seeds\seed.sql
[0m21:49:52.998245 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\adapters.sql
[0m21:49:52.998534 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\utils\datediff.sql
[0m21:49:52.998796 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\adapters\validate_sql.sql
[0m21:49:52.999358 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\adapters\persist_docs.sql
[0m21:49:53.000281 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\safe_cast.sql
[0m21:49:53.000613 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\adapters\relation.sql
[0m21:49:53.000937 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\drop_backup.sql
[0m21:49:53.001231 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\generic_test_sql\relationships.sql
[0m21:49:53.001561 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\adapters\timestamps.sql
[0m21:49:53.001830 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\table\rename.sql
[0m21:49:53.002139 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\view.sql
[0m21:49:53.002457 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\replace.sql
[0m21:49:53.002759 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\last_day.sql
[0m21:49:53.003032 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\clone\can_clone_table.sql
[0m21:49:53.003286 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\clone\clone.sql
[0m21:49:53.003537 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\cast_bool_to_text.sql
[0m21:49:53.003803 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\utils\dateadd.sql
[0m21:49:53.004161 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\tests\test.sql
[0m21:49:53.004608 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\materialized_view\refresh.sql
[0m21:49:53.005022 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\etc\statement.sql
[0m21:49:53.005455 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\dateadd.sql
[0m21:49:53.005979 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\utils\columns_spec_ddl.sql
[0m21:49:53.006422 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\hooks.sql
[0m21:49:53.006832 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\position.sql
[0m21:49:53.007245 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\right.sql
[0m21:49:53.007570 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\date_trunc.sql
[0m21:49:53.007865 [error] [MainThread]: Encountered an error:
'dbt_postgres://macros/adapters.sql'
[0m21:49:53.008637 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 182, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 276, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 321, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 391, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 368, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 407, in wrapper
    setup_manifest(ctx, write=write, write_perf_info=write_perf_info)
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 434, in setup_manifest
    ctx.obj["manifest"] = parse_manifest(
                          ^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/parser/manifest.py", line 2257, in parse_manifest
    manifest = ManifestLoader.get_full_manifest(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/parser/manifest.py", line 323, in get_full_manifest
    manifest = loader.load()
               ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/parser/manifest.py", line 392, in load
    self.load_and_parse_macros(project_parser_files)
  File "/usr/local/lib/python3.11/site-packages/dbt/parser/manifest.py", line 707, in load_and_parse_macros
    block = FileBlock(self.manifest.files[file_id])
                      ~~~~~~~~~~~~~~~~~~~^^^^^^^^^
KeyError: 'dbt_postgres://macros/adapters.sql'

[0m21:49:53.009772 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.35714626, "process_in_blocks": "2680", "process_kernel_time": 0.095604, "process_mem_max_rss": "115288", "process_out_blocks": "2120", "process_user_time": 0.952065}
[0m21:49:53.010192 [debug] [MainThread]: Command `dbt run` failed at 21:49:53.010128 after 0.36 seconds
[0m21:49:53.010551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0a42b70210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0a443d4550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a0a43d42550>]}
[0m21:49:53.010892 [debug] [MainThread]: Flushing usage events
[0m21:49:53.522496 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:26:10.889195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7971fe9864d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7971fe98ac50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7971fe9873d0>]}


============================== 16:26:10.894046 | 804d91cd-3d64-4766-9b6e-23c8227ff239 ==============================
[0m16:26:10.894046 [info ] [MainThread]: Running with dbt=1.11.4
[0m16:26:10.894685 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'introspect': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --profiles-dir .', 'static_parser': 'True', 'log_path': '/dbt_project/logs', 'write_json': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'profiles_dir': '.', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'debug': 'False', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'use_experimental_parser': 'False', 'printer_width': '80', 'no_print': 'None', 'log_format': 'default', 'empty': 'False', 'target_path': 'None', 'log_cache_events': 'False'}
[0m16:26:10.978712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '804d91cd-3d64-4766-9b6e-23c8227ff239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7971fe97e610>]}
[0m16:26:11.010688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '804d91cd-3d64-4766-9b6e-23c8227ff239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797201890c10>]}
[0m16:26:11.011525 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m16:26:11.042851 [debug] [MainThread]: checksum: 092b177ba87eb6bb3c55954c38aa57900eebac336561eb9ee32218428aa81d43, vars: {}, profile: , target: , version: 1.11.4
[0m16:26:11.112560 [debug] [MainThread]: Partial parsing enabled: 134 files deleted, 135 files added, 0 files changed.
[0m16:26:11.113133 [debug] [MainThread]: Partial parsing: added file: dbt://macros/adapters/show.sql
[0m16:26:11.113544 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/materialized_view/create.sql
[0m16:26:11.113912 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/incremental/incremental.sql
[0m16:26:11.114282 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/schema.sql
[0m16:26:11.114671 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/right.sql
[0m16:26:11.115048 [debug] [MainThread]: Partial parsing: added file: dbt://macros/generic_test_sql/unique.sql
[0m16:26:11.115427 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/cast.sql
[0m16:26:11.115790 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/utils/dateadd.sql
[0m16:26:11.116593 [debug] [MainThread]: Partial parsing: added file: dbt://macros/generic_test_sql/accepted_values.sql
[0m16:26:11.117418 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/clone/create_or_replace_clone.sql
[0m16:26:11.117950 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations.sql
[0m16:26:11.118315 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/hooks.sql
[0m16:26:11.118637 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/view/rename.sql
[0m16:26:11.118955 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/functions/helpers.sql
[0m16:26:11.119346 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/view.sql
[0m16:26:11.119942 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/snapshots/snapshot.sql
[0m16:26:11.120346 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/materialized_view/refresh.sql
[0m16:26:11.120747 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/view/replace.sql
[0m16:26:11.121103 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/configs.sql
[0m16:26:11.121493 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/datediff.sql
[0m16:26:11.121864 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/materialized_view/refresh.sql
[0m16:26:11.122229 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/replace.sql
[0m16:26:11.122629 [debug] [MainThread]: Partial parsing: added file: dbt://macros/etc/statement.sql
[0m16:26:11.123057 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/table/replace.sql
[0m16:26:11.123395 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/view/drop.sql
[0m16:26:11.123704 [debug] [MainThread]: Partial parsing: added file: dbt://macros/generic_test_sql/not_null.sql
[0m16:26:11.124057 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/date_spine.sql
[0m16:26:11.124362 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/table/replace.sql
[0m16:26:11.124683 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/snapshots/helpers.sql
[0m16:26:11.124974 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/cast_bool_to_text.sql
[0m16:26:11.125302 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/split_part.sql
[0m16:26:11.125603 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/array_append.sql
[0m16:26:11.126005 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/materialized_view/rename.sql
[0m16:26:11.126348 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/table/drop.sql
[0m16:26:11.126691 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/incremental/on_schema_change.sql
[0m16:26:11.126996 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/view/replace.sql
[0m16:26:11.127318 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/escape_single_quotes.sql
[0m16:26:11.127613 [debug] [MainThread]: Partial parsing: added file: dbt://macros/generic_test_sql/relationships.sql
[0m16:26:11.128138 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/date.sql
[0m16:26:11.128446 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/snapshots/snapshot_merge.sql
[0m16:26:11.128774 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/tests/helpers.sql
[0m16:26:11.129063 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/incremental/column_helpers.sql
[0m16:26:11.129377 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/equals.sql
[0m16:26:11.129671 [debug] [MainThread]: Partial parsing: added file: dbt://macros/get_custom_name/get_custom_alias.sql
[0m16:26:11.129991 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/bool_or.sql
[0m16:26:11.130308 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/literal.sql
[0m16:26:11.130635 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/utils/columns_spec_ddl.sql
[0m16:26:11.130930 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/tests/test.sql
[0m16:26:11.131298 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/materialized_view/rename.sql
[0m16:26:11.131637 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/incremental/strategies.sql
[0m16:26:11.131979 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/intersect.sql
[0m16:26:11.132278 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/drop_backup.sql
[0m16:26:11.132589 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/utils/split_part.sql
[0m16:26:11.132877 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/snapshots/strategies.sql
[0m16:26:11.134119 [debug] [MainThread]: Partial parsing: added file: ecommerce_dw://models/staging/stg_sales.sql
[0m16:26:11.134542 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/data_types.sql
[0m16:26:11.134918 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/replace.sql
[0m16:26:11.135254 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/view/create.sql
[0m16:26:11.135579 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/any_value.sql
[0m16:26:11.135888 [debug] [MainThread]: Partial parsing: added file: ecommerce_dw://models/marts/daily_sales.sql
[0m16:26:11.136234 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/utils/last_day.sql
[0m16:26:11.136555 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/materialized_view/drop.sql
[0m16:26:11.136900 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/timestamps.sql
[0m16:26:11.137237 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/rename_intermediate.sql
[0m16:26:11.137582 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/create.sql
[0m16:26:11.137906 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/utils/listagg.sql
[0m16:26:11.138259 [debug] [MainThread]: Partial parsing: added file: dbt://macros/adapters/metadata.sql
[0m16:26:11.138571 [debug] [MainThread]: Partial parsing: added file: dbt://macros/adapters/relation.sql
[0m16:26:11.138905 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/functions/scalar.sql
[0m16:26:11.139210 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/clone/clone.sql
[0m16:26:11.139535 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/utils/datediff.sql
[0m16:26:11.139825 [debug] [MainThread]: Partial parsing: added file: dbt://macros/unit_test_sql/get_fixture_sql.sql
[0m16:26:11.140137 [debug] [MainThread]: Partial parsing: added file: dbt://macros/python_model/python.sql
[0m16:26:11.140433 [debug] [MainThread]: Partial parsing: added file: dbt://macros/get_custom_name/get_custom_database.sql
[0m16:26:11.140758 [debug] [MainThread]: Partial parsing: added file: dbt://macros/adapters/timestamps.sql
[0m16:26:11.141049 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/materialized_view/describe.sql
[0m16:26:11.141363 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/functions/aggregate.sql
[0m16:26:11.141661 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/utils/any_value.sql
[0m16:26:11.142096 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/table/rename.sql
[0m16:26:11.142394 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/materialized_view/alter.sql
[0m16:26:11.142736 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/view/drop.sql
[0m16:26:11.143102 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/materialized_view/replace.sql
[0m16:26:11.143599 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/clone/can_clone_table.sql
[0m16:26:11.143957 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/table/create.sql
[0m16:26:11.144288 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/listagg.sql
[0m16:26:11.144589 [debug] [MainThread]: Partial parsing: added file: dbt://macros/adapters/validate_sql.sql
[0m16:26:11.144928 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/materializations/incremental_strategies.sql
[0m16:26:11.145219 [debug] [MainThread]: Partial parsing: added file: dbt://macros/adapters/columns.sql
[0m16:26:11.145555 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/date_trunc.sql
[0m16:26:11.145929 [debug] [MainThread]: Partial parsing: added file: dbt://macros/adapters/schema.sql
[0m16:26:11.146497 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/tests/where_subquery.sql
[0m16:26:11.146214 [debug] [MainThread]: Partial parsing: added file: dbt://macros/adapters/indexes.sql
[0m16:26:11.146766 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/hash.sql
[0m16:26:11.147141 [debug] [MainThread]: Partial parsing: added file: dbt://macros/get_custom_name/get_custom_schema.sql
[0m16:26:11.147537 [debug] [MainThread]: Partial parsing: added file: dbt://macros/adapters/persist_docs.sql
[0m16:26:11.147930 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/catalog.sql
[0m16:26:11.148308 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/tests/unit.sql
[0m16:26:11.148950 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/functions/function.sql
[0m16:26:11.150050 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/materializations/functions/scalar.sql
[0m16:26:11.150466 [debug] [MainThread]: Partial parsing: added file: dbt://macros/etc/datetime.sql
[0m16:26:11.150828 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/last_day.sql
[0m16:26:11.151160 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/rename.sql
[0m16:26:11.151528 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/materialized_view/create.sql
[0m16:26:11.151872 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/materialized_view.sql
[0m16:26:11.152233 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/create_intermediate.sql
[0m16:26:11.152598 [debug] [MainThread]: Partial parsing: added file: dbt://macros/adapters/freshness.sql
[0m16:26:11.152981 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/table/drop.sql
[0m16:26:11.153367 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/table.sql
[0m16:26:11.153726 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/incremental/is_incremental.sql
[0m16:26:11.154034 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/drop.sql
[0m16:26:11.154359 [debug] [MainThread]: Partial parsing: added file: dbt://macros/adapters/apply_grants.sql
[0m16:26:11.154667 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/generate_series.sql
[0m16:26:11.154994 [debug] [MainThread]: Partial parsing: added file: dbt://docs/overview.md
[0m16:26:11.155300 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/create_backup.sql
[0m16:26:11.155629 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/array_concat.sql
[0m16:26:11.155929 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/table/rename.sql
[0m16:26:11.156249 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/seeds/seed.sql
[0m16:26:11.156545 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/materializations/snapshot_merge.sql
[0m16:26:11.156893 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/concat.sql
[0m16:26:11.157203 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/array_construct.sql
[0m16:26:11.157528 [debug] [MainThread]: Partial parsing: added file: ecommerce_dw://models/marts/customer_ltv.sql
[0m16:26:11.158164 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/view/rename.sql
[0m16:26:11.158591 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/except.sql
[0m16:26:11.158928 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/column/columns_spec_ddl.sql
[0m16:26:11.159250 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/materialized_view/alter.sql
[0m16:26:11.159558 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/seeds/helpers.sql
[0m16:26:11.159917 [debug] [MainThread]: Partial parsing: added file: ecommerce_dw://models/marts/product_performance.sql
[0m16:26:11.160264 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/materialized_view/drop.sql
[0m16:26:11.160599 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/length.sql
[0m16:26:11.160990 [debug] [MainThread]: Partial parsing: added file: dbt://tests/generic/builtin.sql
[0m16:26:11.161341 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/adapters.sql
[0m16:26:11.161652 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/safe_cast.sql
[0m16:26:11.161980 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/position.sql
[0m16:26:11.162276 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/dateadd.sql
[0m16:26:11.162632 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/incremental/merge.sql
[0m16:26:11.163006 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\get_custom_name\get_custom_database.sql
[0m16:26:11.163338 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\hooks.sql
[0m16:26:11.163622 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\last_day.sql
[0m16:26:11.163892 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\intersect.sql
[0m16:26:11.164344 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\table\create.sql
[0m16:26:11.164727 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\rename_intermediate.sql
[0m16:26:11.165046 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\generate_series.sql
[0m16:26:11.165552 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\listagg.sql
[0m16:26:11.166720 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\date_spine.sql
[0m16:26:11.167168 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\array_concat.sql
[0m16:26:11.167615 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\view\rename.sql
[0m16:26:11.168056 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\python_model\python.sql
[0m16:26:11.168464 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\drop.sql
[0m16:26:11.168838 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\materialized_view\create.sql
[0m16:26:11.169232 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\incremental\incremental.sql
[0m16:26:11.169570 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\etc\datetime.sql
[0m16:26:11.169885 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\adapters\schema.sql
[0m16:26:11.170222 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\array_construct.sql
[0m16:26:11.170542 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations.sql
[0m16:26:11.170894 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\generic_test_sql\relationships.sql
[0m16:26:11.171236 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\materialized_view\replace.sql
[0m16:26:11.171763 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\snapshots\snapshot_merge.sql
[0m16:26:11.172219 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\adapters\columns.sql
[0m16:26:11.172732 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\bool_or.sql
[0m16:26:11.173163 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\column\columns_spec_ddl.sql
[0m16:26:11.173834 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\any_value.sql
[0m16:26:11.174235 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\utils\split_part.sql
[0m16:26:11.174565 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\view\drop.sql
[0m16:26:11.175027 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\adapters.sql
[0m16:26:11.175356 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\schema.sql
[0m16:26:11.175654 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\concat.sql
[0m16:26:11.175955 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\snapshots\snapshot.sql
[0m16:26:11.176254 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\view\rename.sql
[0m16:26:11.176559 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\replace.sql
[0m16:26:11.176887 [debug] [MainThread]: Partial parsing: deleted file: dbt://docs\overview.md
[0m16:26:11.177186 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\position.sql
[0m16:26:11.177486 [debug] [MainThread]: Partial parsing: deleted file: ecommerce_dw://models\marts\customer_ltv.sql
[0m16:26:11.177779 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\materialized_view.sql
[0m16:26:11.178072 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\functions\helpers.sql
[0m16:26:11.178357 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\clone\create_or_replace_clone.sql
[0m16:26:11.178711 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\functions\scalar.sql
[0m16:26:11.179021 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\drop_backup.sql
[0m16:26:11.179327 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\escape_single_quotes.sql
[0m16:26:11.179619 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\date_trunc.sql
[0m16:26:11.179907 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\view\replace.sql
[0m16:26:11.180213 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\adapters\indexes.sql
[0m16:26:11.180513 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\create.sql
[0m16:26:11.180814 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\utils\dateadd.sql
[0m16:26:11.181135 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\snapshots\helpers.sql
[0m16:26:11.181434 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\snapshots\strategies.sql
[0m16:26:11.181728 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\generic_test_sql\accepted_values.sql
[0m16:26:11.182014 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\tests\unit.sql
[0m16:26:11.183236 [debug] [MainThread]: Partial parsing: deleted file: ecommerce_dw://models\staging\stg_sales.sql
[0m16:26:11.183590 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\utils\listagg.sql
[0m16:26:11.183920 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\length.sql
[0m16:26:11.184212 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\seeds\seed.sql
[0m16:26:11.184518 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\utils\columns_spec_ddl.sql
[0m16:26:11.184837 [debug] [MainThread]: Partial parsing: deleted file: ecommerce_dw://models\marts\daily_sales.sql
[0m16:26:11.185149 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\table\rename.sql
[0m16:26:11.185441 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\adapters\show.sql
[0m16:26:11.185738 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\right.sql
[0m16:26:11.186033 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\table\drop.sql
[0m16:26:11.186360 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\incremental\column_helpers.sql
[0m16:26:11.186647 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\materialized_view\create.sql
[0m16:26:11.186936 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\cast_bool_to_text.sql
[0m16:26:11.187217 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\tests\where_subquery.sql
[0m16:26:11.187539 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\adapters\relation.sql
[0m16:26:11.187836 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\functions\aggregate.sql
[0m16:26:11.188151 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\timestamps.sql
[0m16:26:11.188438 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\tests\test.sql
[0m16:26:11.188742 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\create_backup.sql
[0m16:26:11.189136 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\hash.sql
[0m16:26:11.189604 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\materializations\incremental_strategies.sql
[0m16:26:11.189924 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\array_append.sql
[0m16:26:11.190232 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\view\drop.sql
[0m16:26:11.190562 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\adapters\persist_docs.sql
[0m16:26:11.190862 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\view\replace.sql
[0m16:26:11.191151 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\adapters\validate_sql.sql
[0m16:26:11.191444 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\materializations\snapshot_merge.sql
[0m16:26:11.191724 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\generic_test_sql\unique.sql
[0m16:26:11.192006 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\functions\function.sql
[0m16:26:11.192306 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\incremental\merge.sql
[0m16:26:11.192601 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\split_part.sql
[0m16:26:11.192918 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\adapters\metadata.sql
[0m16:26:11.193213 [debug] [MainThread]: Partial parsing: deleted file: dbt://tests\generic\builtin.sql
[0m16:26:11.193508 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\date.sql
[0m16:26:11.193808 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\dateadd.sql
[0m16:26:11.194095 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\unit_test_sql\get_fixture_sql.sql
[0m16:26:11.194357 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\except.sql
[0m16:26:11.194653 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\view\create.sql
[0m16:26:11.194941 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\utils\any_value.sql
[0m16:26:11.195228 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\materialized_view\alter.sql
[0m16:26:11.195515 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\safe_cast.sql
[0m16:26:11.195790 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\materialized_view\describe.sql
[0m16:26:11.196077 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\configs.sql
[0m16:26:11.196351 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\utils\last_day.sql
[0m16:26:11.196727 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\etc\statement.sql
[0m16:26:11.197041 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\adapters\timestamps.sql
[0m16:26:11.197337 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\literal.sql
[0m16:26:11.197619 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\table\drop.sql
[0m16:26:11.197909 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\materialized_view\refresh.sql
[0m16:26:11.198210 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\materialized_view\refresh.sql
[0m16:26:11.198495 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\get_custom_name\get_custom_alias.sql
[0m16:26:11.198986 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\get_custom_name\get_custom_schema.sql
[0m16:26:11.199907 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\cast.sql
[0m16:26:11.200289 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\incremental\is_incremental.sql
[0m16:26:11.200709 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\clone\clone.sql
[0m16:26:11.201025 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\table.sql
[0m16:26:11.201337 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\materialized_view\rename.sql
[0m16:26:11.201636 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\materialized_view\drop.sql
[0m16:26:11.201938 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\rename.sql
[0m16:26:11.202228 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\materialized_view\drop.sql
[0m16:26:11.202520 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\table\replace.sql
[0m16:26:11.202802 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\clone\can_clone_table.sql
[0m16:26:11.203100 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\tests\helpers.sql
[0m16:26:11.203445 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\adapters\apply_grants.sql
[0m16:26:11.203746 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\materialized_view\alter.sql
[0m16:26:11.204030 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\view.sql
[0m16:26:11.204346 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\seeds\helpers.sql
[0m16:26:11.204810 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\generic_test_sql\not_null.sql
[0m16:26:11.205137 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\materialized_view\rename.sql
[0m16:26:11.205436 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\equals.sql
[0m16:26:11.205806 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\incremental\strategies.sql
[0m16:26:11.206128 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\create_intermediate.sql
[0m16:26:11.206420 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\adapters\freshness.sql
[0m16:26:11.206770 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\catalog.sql
[0m16:26:11.207090 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\replace.sql
[0m16:26:11.207419 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\datediff.sql
[0m16:26:11.207736 [debug] [MainThread]: Partial parsing: deleted file: ecommerce_dw://models\marts\product_performance.sql
[0m16:26:11.208032 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\incremental\on_schema_change.sql
[0m16:26:11.208378 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\data_types.sql
[0m16:26:11.208759 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\table\replace.sql
[0m16:26:11.209102 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\utils\datediff.sql
[0m16:26:11.209446 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\table\rename.sql
[0m16:26:11.210111 [error] [MainThread]: Encountered an error:
'dbt_postgres://macros/relations.sql'
[0m16:26:11.210942 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 182, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 276, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 321, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 391, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 368, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 407, in wrapper
    setup_manifest(ctx, write=write, write_perf_info=write_perf_info)
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 434, in setup_manifest
    ctx.obj["manifest"] = parse_manifest(
                          ^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/parser/manifest.py", line 2257, in parse_manifest
    manifest = ManifestLoader.get_full_manifest(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/parser/manifest.py", line 323, in get_full_manifest
    manifest = loader.load()
               ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/parser/manifest.py", line 392, in load
    self.load_and_parse_macros(project_parser_files)
  File "/usr/local/lib/python3.11/site-packages/dbt/parser/manifest.py", line 707, in load_and_parse_macros
    block = FileBlock(self.manifest.files[file_id])
                      ~~~~~~~~~~~~~~~~~~~^^^^^^^^^
KeyError: 'dbt_postgres://macros/relations.sql'

[0m16:26:11.212305 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.35944462, "process_in_blocks": "2608", "process_kernel_time": 0.149122, "process_mem_max_rss": "115360", "process_out_blocks": "2120", "process_user_time": 0.894737}
[0m16:26:11.212830 [debug] [MainThread]: Command `dbt run` failed at 16:26:11.212762 after 0.36 seconds
[0m16:26:11.213227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7971fe8eba90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7972032bc710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7971fe987c10>]}
[0m16:26:11.213664 [debug] [MainThread]: Flushing usage events
[0m16:26:11.729234 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:31:12.590149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797ff5ca8950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797ff5ca1510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797ff5ca0d50>]}


============================== 16:31:12.592266 | d80cbf97-8e78-4336-9f97-f9c9efadfaea ==============================
[0m16:31:12.592266 [info ] [MainThread]: Running with dbt=1.11.4
[0m16:31:12.592846 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'fail_fast': 'False', 'static_parser': 'True', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'quiet': 'False', 'warn_error': 'None', 'no_print': 'None', 'introspect': 'True', 'printer_width': '80', 'profiles_dir': '.', 'target_path': 'None', 'write_json': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir .', 'log_path': '/dbt_project/logs'}
[0m16:31:12.673988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd80cbf97-8e78-4336-9f97-f9c9efadfaea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797ff6c9c050>]}
[0m16:31:12.705997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd80cbf97-8e78-4336-9f97-f9c9efadfaea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797ff8c59290>]}
[0m16:31:12.706753 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m16:31:12.737885 [debug] [MainThread]: checksum: 092b177ba87eb6bb3c55954c38aa57900eebac336561eb9ee32218428aa81d43, vars: {}, profile: , target: , version: 1.11.4
[0m16:31:12.802410 [debug] [MainThread]: Partial parsing enabled: 134 files deleted, 135 files added, 0 files changed.
[0m16:31:12.803221 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/literal.sql
[0m16:31:12.803579 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/datediff.sql
[0m16:31:12.803934 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/view/drop.sql
[0m16:31:12.804272 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/utils/last_day.sql
[0m16:31:12.804610 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/drop_backup.sql
[0m16:31:12.804906 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/materialized_view/rename.sql
[0m16:31:12.805265 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/view/drop.sql
[0m16:31:12.805648 [debug] [MainThread]: Partial parsing: added file: dbt://macros/generic_test_sql/not_null.sql
[0m16:31:12.805992 [debug] [MainThread]: Partial parsing: added file: dbt://macros/adapters/metadata.sql
[0m16:31:12.806289 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/view.sql
[0m16:31:12.806600 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/table.sql
[0m16:31:12.806889 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/catalog.sql
[0m16:31:12.807227 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/length.sql
[0m16:31:12.807776 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/snapshots/helpers.sql
[0m16:31:12.808132 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/seeds/seed.sql
[0m16:31:12.808462 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/view/rename.sql
[0m16:31:12.808784 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/replace.sql
[0m16:31:12.809097 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/snapshots/snapshot.sql
[0m16:31:12.809417 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/except.sql
[0m16:31:12.809723 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/hash.sql
[0m16:31:12.810054 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/materialized_view/drop.sql
[0m16:31:12.810347 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/materialized_view/create.sql
[0m16:31:12.810655 [debug] [MainThread]: Partial parsing: added file: dbt://macros/adapters/persist_docs.sql
[0m16:31:12.810956 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/create.sql
[0m16:31:12.811273 [debug] [MainThread]: Partial parsing: added file: dbt://macros/get_custom_name/get_custom_schema.sql
[0m16:31:12.811561 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations.sql
[0m16:31:12.811871 [debug] [MainThread]: Partial parsing: added file: dbt://macros/adapters/columns.sql
[0m16:31:12.812167 [debug] [MainThread]: Partial parsing: added file: dbt://docs/overview.md
[0m16:31:12.812503 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/split_part.sql
[0m16:31:12.812826 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/table/drop.sql
[0m16:31:12.813174 [debug] [MainThread]: Partial parsing: added file: dbt://macros/etc/statement.sql
[0m16:31:12.813491 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/array_concat.sql
[0m16:31:12.813857 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/configs.sql
[0m16:31:12.814161 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/rename.sql
[0m16:31:12.814477 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/timestamps.sql
[0m16:31:12.814771 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/drop.sql
[0m16:31:12.815133 [debug] [MainThread]: Partial parsing: added file: ecommerce_dw://models/marts/daily_sales.sql
[0m16:31:12.815472 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/bool_or.sql
[0m16:31:12.815797 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/cast_bool_to_text.sql
[0m16:31:12.816093 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/utils/datediff.sql
[0m16:31:12.816418 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/view/rename.sql
[0m16:31:12.816734 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/incremental/merge.sql
[0m16:31:12.817054 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/functions/function.sql
[0m16:31:12.817342 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/utils/columns_spec_ddl.sql
[0m16:31:12.817650 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/replace.sql
[0m16:31:12.818839 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/utils/listagg.sql
[0m16:31:12.819235 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/table/create.sql
[0m16:31:12.819558 [debug] [MainThread]: Partial parsing: added file: dbt://macros/python_model/python.sql
[0m16:31:12.819887 [debug] [MainThread]: Partial parsing: added file: dbt://macros/adapters/freshness.sql
[0m16:31:12.820212 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/array_construct.sql
[0m16:31:12.820604 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/safe_cast.sql
[0m16:31:12.820900 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/date_spine.sql
[0m16:31:12.821213 [debug] [MainThread]: Partial parsing: added file: dbt://tests/generic/builtin.sql
[0m16:31:12.821518 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/date_trunc.sql
[0m16:31:12.821846 [debug] [MainThread]: Partial parsing: added file: dbt://macros/generic_test_sql/unique.sql
[0m16:31:12.822148 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/cast.sql
[0m16:31:12.822478 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/clone/clone.sql
[0m16:31:12.822768 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/view/replace.sql
[0m16:31:12.823386 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/functions/scalar.sql
[0m16:31:12.823741 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/last_day.sql
[0m16:31:12.824079 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/clone/can_clone_table.sql
[0m16:31:12.824408 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/tests/unit.sql
[0m16:31:12.824761 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/escape_single_quotes.sql
[0m16:31:12.825077 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/incremental/on_schema_change.sql
[0m16:31:12.825454 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/snapshots/snapshot_merge.sql
[0m16:31:12.825803 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/functions/aggregate.sql
[0m16:31:12.826151 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/create_intermediate.sql
[0m16:31:12.826448 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/tests/where_subquery.sql
[0m16:31:12.826792 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/intersect.sql
[0m16:31:12.827085 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/materializations/functions/scalar.sql
[0m16:31:12.827394 [debug] [MainThread]: Partial parsing: added file: dbt://macros/generic_test_sql/relationships.sql
[0m16:31:12.827690 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/materialized_view.sql
[0m16:31:12.828001 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/create_backup.sql
[0m16:31:12.828355 [debug] [MainThread]: Partial parsing: added file: ecommerce_dw://models/marts/customer_ltv.sql
[0m16:31:12.828741 [debug] [MainThread]: Partial parsing: added file: dbt://macros/adapters/schema.sql
[0m16:31:12.829045 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/table/rename.sql
[0m16:31:12.829358 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/seeds/helpers.sql
[0m16:31:12.829652 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/incremental/strategies.sql
[0m16:31:12.829989 [debug] [MainThread]: Partial parsing: added file: ecommerce_dw://models/marts/product_performance.sql
[0m16:31:12.830301 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/table/rename.sql
[0m16:31:12.830623 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/clone/create_or_replace_clone.sql
[0m16:31:12.830925 [debug] [MainThread]: Partial parsing: added file: dbt://macros/get_custom_name/get_custom_alias.sql
[0m16:31:12.831248 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/array_append.sql
[0m16:31:12.831538 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/data_types.sql
[0m16:31:12.831853 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/any_value.sql
[0m16:31:12.832151 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/materialized_view/refresh.sql
[0m16:31:12.832485 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/tests/test.sql
[0m16:31:12.832777 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/column/columns_spec_ddl.sql
[0m16:31:12.833091 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/functions/helpers.sql
[0m16:31:12.833397 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/snapshots/strategies.sql
[0m16:31:12.833717 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/materialized_view/create.sql
[0m16:31:12.834004 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/position.sql
[0m16:31:12.834311 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/concat.sql
[0m16:31:12.835191 [debug] [MainThread]: Partial parsing: added file: dbt://macros/adapters/validate_sql.sql
[0m16:31:12.836015 [debug] [MainThread]: Partial parsing: added file: dbt://macros/unit_test_sql/get_fixture_sql.sql
[0m16:31:12.836341 [debug] [MainThread]: Partial parsing: added file: dbt://macros/adapters/show.sql
[0m16:31:12.836666 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/date.sql
[0m16:31:12.836954 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/table/replace.sql
[0m16:31:12.837257 [debug] [MainThread]: Partial parsing: added file: dbt://macros/adapters/timestamps.sql
[0m16:31:12.837555 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/listagg.sql
[0m16:31:12.837869 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/rename_intermediate.sql
[0m16:31:12.838154 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/utils/any_value.sql
[0m16:31:12.838732 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/materializations/snapshot_merge.sql
[0m16:31:12.839064 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/materialized_view/describe.sql
[0m16:31:12.839407 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/generate_series.sql
[0m16:31:12.839698 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/equals.sql
[0m16:31:12.840071 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/view/replace.sql
[0m16:31:12.840385 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/utils/split_part.sql
[0m16:31:12.840721 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/materialized_view/refresh.sql
[0m16:31:12.841014 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/incremental/incremental.sql
[0m16:31:12.841350 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/table/drop.sql
[0m16:31:12.841637 [debug] [MainThread]: Partial parsing: added file: dbt://macros/adapters/apply_grants.sql
[0m16:31:12.841947 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/utils/dateadd.sql
[0m16:31:12.842241 [debug] [MainThread]: Partial parsing: added file: dbt://macros/adapters/indexes.sql
[0m16:31:12.842548 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/right.sql
[0m16:31:12.842840 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/dateadd.sql
[0m16:31:12.843152 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/materialized_view/alter.sql
[0m16:31:12.843454 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/incremental/is_incremental.sql
[0m16:31:12.843769 [debug] [MainThread]: Partial parsing: added file: dbt://macros/adapters/relation.sql
[0m16:31:12.844062 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/incremental/column_helpers.sql
[0m16:31:12.844407 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/materialized_view/drop.sql
[0m16:31:12.844726 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/tests/helpers.sql
[0m16:31:12.845039 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/materializations/incremental_strategies.sql
[0m16:31:12.845326 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/adapters.sql
[0m16:31:12.845642 [debug] [MainThread]: Partial parsing: added file: ecommerce_dw://models/staging/stg_sales.sql
[0m16:31:12.845928 [debug] [MainThread]: Partial parsing: added file: dbt://macros/etc/datetime.sql
[0m16:31:12.846237 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/schema.sql
[0m16:31:12.846519 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/table/replace.sql
[0m16:31:12.846828 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/materialized_view/rename.sql
[0m16:31:12.847118 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/materialized_view/replace.sql
[0m16:31:12.847423 [debug] [MainThread]: Partial parsing: added file: dbt://macros/get_custom_name/get_custom_database.sql
[0m16:31:12.847703 [debug] [MainThread]: Partial parsing: added file: dbt://macros/generic_test_sql/accepted_values.sql
[0m16:31:12.848011 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/materialized_view/alter.sql
[0m16:31:12.848433 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/hooks.sql
[0m16:31:12.848800 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/view/create.sql
[0m16:31:12.849084 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\clone\clone.sql
[0m16:31:12.849418 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\date.sql
[0m16:31:12.849726 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\replace.sql
[0m16:31:12.850050 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\python_model\python.sql
[0m16:31:12.850335 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\escape_single_quotes.sql
[0m16:31:12.850635 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\view\replace.sql
[0m16:31:12.851157 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\adapters\columns.sql
[0m16:31:12.852224 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\table\rename.sql
[0m16:31:12.852760 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\hash.sql
[0m16:31:12.853126 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\adapters\freshness.sql
[0m16:31:12.853477 [debug] [MainThread]: Partial parsing: deleted file: ecommerce_dw://models\staging\stg_sales.sql
[0m16:31:12.853953 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\adapters.sql
[0m16:31:12.854446 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\date_spine.sql
[0m16:31:12.854968 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\utils\any_value.sql
[0m16:31:12.855334 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\materializations\incremental_strategies.sql
[0m16:31:12.856029 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\get_custom_name\get_custom_schema.sql
[0m16:31:12.856430 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\incremental\merge.sql
[0m16:31:12.856788 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\clone\create_or_replace_clone.sql
[0m16:31:12.857130 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\generic_test_sql\accepted_values.sql
[0m16:31:12.857480 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\create.sql
[0m16:31:12.857813 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\materializations\snapshot_merge.sql
[0m16:31:12.858174 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\data_types.sql
[0m16:31:12.858515 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\view\rename.sql
[0m16:31:12.858874 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\snapshots\helpers.sql
[0m16:31:12.859215 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\get_custom_name\get_custom_alias.sql
[0m16:31:12.859562 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\view\drop.sql
[0m16:31:12.859880 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\utils\columns_spec_ddl.sql
[0m16:31:12.860207 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\utils\dateadd.sql
[0m16:31:12.860595 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\adapters\relation.sql
[0m16:31:12.860948 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\drop.sql
[0m16:31:12.861280 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\replace.sql
[0m16:31:12.861717 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\materialized_view\alter.sql
[0m16:31:12.862081 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\materialized_view\refresh.sql
[0m16:31:12.862418 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\last_day.sql
[0m16:31:12.862742 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\generic_test_sql\unique.sql
[0m16:31:12.863086 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\materialized_view.sql
[0m16:31:12.863424 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\utils\last_day.sql
[0m16:31:12.863771 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\adapters\show.sql
[0m16:31:12.864117 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\equals.sql
[0m16:31:12.864448 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\seeds\seed.sql
[0m16:31:12.864786 [debug] [MainThread]: Partial parsing: deleted file: dbt://tests\generic\builtin.sql
[0m16:31:12.865134 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\clone\can_clone_table.sql
[0m16:31:12.865464 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\drop_backup.sql
[0m16:31:12.865867 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\generic_test_sql\relationships.sql
[0m16:31:12.866188 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\except.sql
[0m16:31:12.866538 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\functions\aggregate.sql
[0m16:31:12.866879 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\tests\helpers.sql
[0m16:31:12.867223 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\incremental\on_schema_change.sql
[0m16:31:12.867557 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\literal.sql
[0m16:31:12.868214 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\configs.sql
[0m16:31:12.869190 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\utils\datediff.sql
[0m16:31:12.869646 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\materialized_view\drop.sql
[0m16:31:12.870032 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\adapters\schema.sql
[0m16:31:12.870472 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\incremental\column_helpers.sql
[0m16:31:12.870828 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\table\drop.sql
[0m16:31:12.871170 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\listagg.sql
[0m16:31:12.871540 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\array_construct.sql
[0m16:31:12.871941 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\adapters\persist_docs.sql
[0m16:31:12.872322 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\view\create.sql
[0m16:31:12.872666 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\materialized_view\rename.sql
[0m16:31:12.873093 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\etc\statement.sql
[0m16:31:12.873425 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\functions\scalar.sql
[0m16:31:12.873739 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\tests\test.sql
[0m16:31:12.874066 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\cast_bool_to_text.sql
[0m16:31:12.874399 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\rename.sql
[0m16:31:12.874734 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\create_intermediate.sql
[0m16:31:12.875074 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\concat.sql
[0m16:31:12.875399 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\tests\unit.sql
[0m16:31:12.875729 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\create_backup.sql
[0m16:31:12.876043 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\intersect.sql
[0m16:31:12.876425 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\cast.sql
[0m16:31:12.876746 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\table.sql
[0m16:31:12.877101 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\unit_test_sql\get_fixture_sql.sql
[0m16:31:12.877437 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\generate_series.sql
[0m16:31:12.877770 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\view\rename.sql
[0m16:31:12.878187 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\adapters\apply_grants.sql
[0m16:31:12.878505 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\generic_test_sql\not_null.sql
[0m16:31:12.878825 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\functions\helpers.sql
[0m16:31:12.879160 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\split_part.sql
[0m16:31:12.879503 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\catalog.sql
[0m16:31:12.879837 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\incremental\incremental.sql
[0m16:31:12.880175 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\datediff.sql
[0m16:31:12.880536 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\dateadd.sql
[0m16:31:12.880875 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\incremental\strategies.sql
[0m16:31:12.881175 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\view\drop.sql
[0m16:31:12.881482 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\rename_intermediate.sql
[0m16:31:12.881752 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\utils\listagg.sql
[0m16:31:12.882054 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\snapshots\strategies.sql
[0m16:31:12.882331 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\position.sql
[0m16:31:12.882630 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\materialized_view\describe.sql
[0m16:31:12.882945 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\schema.sql
[0m16:31:12.883246 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\tests\where_subquery.sql
[0m16:31:12.883559 [debug] [MainThread]: Partial parsing: deleted file: dbt://docs\overview.md
[0m16:31:12.883873 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\view.sql
[0m16:31:12.884169 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\materialized_view\alter.sql
[0m16:31:12.884848 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\snapshots\snapshot_merge.sql
[0m16:31:12.885852 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\hooks.sql
[0m16:31:12.886377 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\materialized_view\create.sql
[0m16:31:12.886682 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\table\replace.sql
[0m16:31:12.887001 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\view\replace.sql
[0m16:31:12.887279 [debug] [MainThread]: Partial parsing: deleted file: ecommerce_dw://models\marts\daily_sales.sql
[0m16:31:12.887587 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\bool_or.sql
[0m16:31:12.887871 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\date_trunc.sql
[0m16:31:12.888177 [debug] [MainThread]: Partial parsing: deleted file: ecommerce_dw://models\marts\product_performance.sql
[0m16:31:12.888462 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\snapshots\snapshot.sql
[0m16:31:12.888782 [debug] [MainThread]: Partial parsing: deleted file: ecommerce_dw://models\marts\customer_ltv.sql
[0m16:31:12.889061 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\functions\function.sql
[0m16:31:12.889373 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\table\drop.sql
[0m16:31:12.889659 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\etc\datetime.sql
[0m16:31:12.889954 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\array_append.sql
[0m16:31:12.890228 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\materialized_view\drop.sql
[0m16:31:12.890604 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\column\columns_spec_ddl.sql
[0m16:31:12.890908 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\adapters\timestamps.sql
[0m16:31:12.891217 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\materialized_view\rename.sql
[0m16:31:12.891505 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\timestamps.sql
[0m16:31:12.891817 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\adapters\indexes.sql
[0m16:31:12.892105 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\right.sql
[0m16:31:12.892431 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\materialized_view\refresh.sql
[0m16:31:12.892718 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\adapters\metadata.sql
[0m16:31:12.893010 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\incremental\is_incremental.sql
[0m16:31:12.893282 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\table\replace.sql
[0m16:31:12.893591 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\safe_cast.sql
[0m16:31:12.893865 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\materialized_view\replace.sql
[0m16:31:12.894159 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations.sql
[0m16:31:12.894427 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\utils\split_part.sql
[0m16:31:12.894714 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\array_concat.sql
[0m16:31:12.895018 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\seeds\helpers.sql
[0m16:31:12.895323 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\materialized_view\create.sql
[0m16:31:12.895602 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\get_custom_name\get_custom_database.sql
[0m16:31:12.895965 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\table\create.sql
[0m16:31:12.896315 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\length.sql
[0m16:31:12.896643 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\table\rename.sql
[0m16:31:12.896926 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\adapters\validate_sql.sql
[0m16:31:12.897225 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\any_value.sql
[0m16:31:12.898316 [error] [MainThread]: Encountered an error:
'dbt_postgres://macros/catalog.sql'
[0m16:31:12.899108 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 182, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 276, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 321, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 391, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 368, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 407, in wrapper
    setup_manifest(ctx, write=write, write_perf_info=write_perf_info)
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 434, in setup_manifest
    ctx.obj["manifest"] = parse_manifest(
                          ^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/parser/manifest.py", line 2257, in parse_manifest
    manifest = ManifestLoader.get_full_manifest(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/parser/manifest.py", line 323, in get_full_manifest
    manifest = loader.load()
               ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/parser/manifest.py", line 392, in load
    self.load_and_parse_macros(project_parser_files)
  File "/usr/local/lib/python3.11/site-packages/dbt/parser/manifest.py", line 707, in load_and_parse_macros
    block = FileBlock(self.manifest.files[file_id])
                      ~~~~~~~~~~~~~~~~~~~^^^^^^^^^
KeyError: 'dbt_postgres://macros/catalog.sql'

[0m16:31:12.899791 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.3441611, "process_in_blocks": "0", "process_kernel_time": 0.121052, "process_mem_max_rss": "114876", "process_out_blocks": "0", "process_user_time": 0.8514}
[0m16:31:12.900223 [debug] [MainThread]: Command `dbt run` failed at 16:31:12.900165 after 0.34 seconds
[0m16:31:12.900605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797ff5caa0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797ff5caa9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x797ffa6904d0>]}
[0m16:31:12.900979 [debug] [MainThread]: Flushing usage events
[0m16:31:13.402261 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:34:24.063745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7436600b2fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7436600b2b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743660241810>]}


============================== 16:34:24.068514 | 71589407-0328-4383-b3c1-a713188e4edb ==============================
[0m16:34:24.068514 [info ] [MainThread]: Running with dbt=1.11.4
[0m16:34:24.069183 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'version_check': 'True', 'fail_fast': 'False', 'introspect': 'True', 'warn_error': 'None', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run --profiles-dir .', 'write_json': 'True', 'empty': 'False', 'printer_width': '80', 'log_cache_events': 'False', 'quiet': 'False', 'log_path': '/dbt_project/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'target_path': 'None', 'profiles_dir': '.', 'cache_selected_only': 'False', 'no_print': 'None', 'static_parser': 'True', 'debug': 'False', 'indirect_selection': 'eager'}
[0m16:34:24.150275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '71589407-0328-4383-b3c1-a713188e4edb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74365f393a50>]}
[0m16:34:24.183035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '71589407-0328-4383-b3c1-a713188e4edb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743662fb4dd0>]}
[0m16:34:24.183991 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m16:34:24.215147 [debug] [MainThread]: checksum: 092b177ba87eb6bb3c55954c38aa57900eebac336561eb9ee32218428aa81d43, vars: {}, profile: , target: , version: 1.11.4
[0m16:34:24.282842 [debug] [MainThread]: Partial parsing enabled: 134 files deleted, 135 files added, 0 files changed.
[0m16:34:24.283396 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/drop_backup.sql
[0m16:34:24.283787 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/incremental/incremental.sql
[0m16:34:24.284162 [debug] [MainThread]: Partial parsing: added file: dbt://macros/get_custom_name/get_custom_database.sql
[0m16:34:24.284495 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/materialized_view.sql
[0m16:34:24.284859 [debug] [MainThread]: Partial parsing: added file: dbt://macros/adapters/apply_grants.sql
[0m16:34:24.285177 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/listagg.sql
[0m16:34:24.285549 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/create.sql
[0m16:34:24.285984 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/utils/any_value.sql
[0m16:34:24.286383 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/column/columns_spec_ddl.sql
[0m16:34:24.286745 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/seeds/seed.sql
[0m16:34:24.287102 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/hooks.sql
[0m16:34:24.287462 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/clone/clone.sql
[0m16:34:24.287874 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/array_append.sql
[0m16:34:24.288272 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/array_construct.sql
[0m16:34:24.288667 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/functions/aggregate.sql
[0m16:34:24.289008 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/incremental/strategies.sql
[0m16:34:24.289363 [debug] [MainThread]: Partial parsing: added file: dbt://macros/get_custom_name/get_custom_schema.sql
[0m16:34:24.289679 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/snapshots/snapshot.sql
[0m16:34:24.290074 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/hash.sql
[0m16:34:24.290386 [debug] [MainThread]: Partial parsing: added file: dbt://macros/generic_test_sql/accepted_values.sql
[0m16:34:24.290725 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/bool_or.sql
[0m16:34:24.291039 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/concat.sql
[0m16:34:24.291378 [debug] [MainThread]: Partial parsing: added file: dbt://macros/adapters/metadata.sql
[0m16:34:24.291680 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/snapshots/strategies.sql
[0m16:34:24.292051 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/materialized_view/alter.sql
[0m16:34:24.292358 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/equals.sql
[0m16:34:24.293269 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/materialized_view/drop.sql
[0m16:34:24.294456 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/cast.sql
[0m16:34:24.296867 [debug] [MainThread]: Partial parsing: added file: dbt://macros/unit_test_sql/get_fixture_sql.sql
[0m16:34:24.300821 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/rename_intermediate.sql
[0m16:34:24.301221 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/materialized_view/refresh.sql
[0m16:34:24.301575 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/date_trunc.sql
[0m16:34:24.302021 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/generate_series.sql
[0m16:34:24.302350 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/date_spine.sql
[0m16:34:24.302696 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/length.sql
[0m16:34:24.303004 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/timestamps.sql
[0m16:34:24.303358 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/utils/split_part.sql
[0m16:34:24.303666 [debug] [MainThread]: Partial parsing: added file: dbt://macros/adapters/freshness.sql
[0m16:34:24.304013 [debug] [MainThread]: Partial parsing: added file: dbt://macros/get_custom_name/get_custom_alias.sql
[0m16:34:24.304329 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/materialized_view/rename.sql
[0m16:34:24.304664 [debug] [MainThread]: Partial parsing: added file: dbt://docs/overview.md
[0m16:34:24.304992 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/table.sql
[0m16:34:24.305333 [debug] [MainThread]: Partial parsing: added file: ecommerce_dw://models/marts/daily_sales.sql
[0m16:34:24.305642 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/rename.sql
[0m16:34:24.306013 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/literal.sql
[0m16:34:24.306320 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/date.sql
[0m16:34:24.306661 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/cast_bool_to_text.sql
[0m16:34:24.306961 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/snapshots/helpers.sql
[0m16:34:24.307294 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/materializations/snapshot_merge.sql
[0m16:34:24.307589 [debug] [MainThread]: Partial parsing: added file: dbt://macros/generic_test_sql/not_null.sql
[0m16:34:24.307924 [debug] [MainThread]: Partial parsing: added file: dbt://macros/adapters/schema.sql
[0m16:34:24.308226 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/right.sql
[0m16:34:24.308577 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/table/rename.sql
[0m16:34:24.308877 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/except.sql
[0m16:34:24.309354 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/tests/where_subquery.sql
[0m16:34:24.310093 [debug] [MainThread]: Partial parsing: added file: dbt://macros/python_model/python.sql
[0m16:34:24.311255 [debug] [MainThread]: Partial parsing: added file: ecommerce_dw://models/staging/stg_sales.sql
[0m16:34:24.311678 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/materialized_view/alter.sql
[0m16:34:24.312063 [debug] [MainThread]: Partial parsing: added file: dbt://tests/generic/builtin.sql
[0m16:34:24.312427 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/materialized_view/create.sql
[0m16:34:24.312785 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/functions/helpers.sql
[0m16:34:24.313105 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/utils/datediff.sql
[0m16:34:24.313452 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/view/create.sql
[0m16:34:24.313767 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/view/rename.sql
[0m16:34:24.314197 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/create_intermediate.sql
[0m16:34:24.314501 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/materialized_view/refresh.sql
[0m16:34:24.314864 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/snapshots/snapshot_merge.sql
[0m16:34:24.315192 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/functions/function.sql
[0m16:34:24.315571 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/view/replace.sql
[0m16:34:24.315885 [debug] [MainThread]: Partial parsing: added file: dbt://macros/generic_test_sql/relationships.sql
[0m16:34:24.316229 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/view/drop.sql
[0m16:34:24.316531 [debug] [MainThread]: Partial parsing: added file: dbt://macros/adapters/validate_sql.sql
[0m16:34:24.316866 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/table/drop.sql
[0m16:34:24.317162 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/data_types.sql
[0m16:34:24.317495 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/view/rename.sql
[0m16:34:24.317802 [debug] [MainThread]: Partial parsing: added file: dbt://macros/adapters/persist_docs.sql
[0m16:34:24.318199 [debug] [MainThread]: Partial parsing: added file: ecommerce_dw://models/marts/customer_ltv.sql
[0m16:34:24.318520 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/drop.sql
[0m16:34:24.318862 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/tests/helpers.sql
[0m16:34:24.319164 [debug] [MainThread]: Partial parsing: added file: dbt://macros/adapters/timestamps.sql
[0m16:34:24.319493 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/seeds/helpers.sql
[0m16:34:24.319799 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/view/replace.sql
[0m16:34:24.320125 [debug] [MainThread]: Partial parsing: added file: dbt://macros/adapters/columns.sql
[0m16:34:24.320424 [debug] [MainThread]: Partial parsing: added file: dbt://macros/adapters/show.sql
[0m16:34:24.320822 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/materializations/incremental_strategies.sql
[0m16:34:24.321211 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/tests/test.sql
[0m16:34:24.321576 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/utils/columns_spec_ddl.sql
[0m16:34:24.321911 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/table/create.sql
[0m16:34:24.322270 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/last_day.sql
[0m16:34:24.322602 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/utils/listagg.sql
[0m16:34:24.322950 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/materialized_view/drop.sql
[0m16:34:24.323258 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/position.sql
[0m16:34:24.323602 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/escape_single_quotes.sql
[0m16:34:24.323900 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/split_part.sql
[0m16:34:24.324225 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/materialized_view/describe.sql
[0m16:34:24.324521 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/materializations/functions/scalar.sql
[0m16:34:24.324851 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/clone/can_clone_table.sql
[0m16:34:24.325159 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/materialized_view/rename.sql
[0m16:34:24.325752 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/catalog.sql
[0m16:34:24.326812 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/replace.sql
[0m16:34:24.327660 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/replace.sql
[0m16:34:24.328013 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/array_concat.sql
[0m16:34:24.328367 [debug] [MainThread]: Partial parsing: added file: dbt://macros/etc/statement.sql
[0m16:34:24.328690 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/incremental/on_schema_change.sql
[0m16:34:24.329098 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/materialized_view/create.sql
[0m16:34:24.329423 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/incremental/column_helpers.sql
[0m16:34:24.329772 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/materialized_view/replace.sql
[0m16:34:24.330137 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/datediff.sql
[0m16:34:24.330486 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/schema.sql
[0m16:34:24.330802 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/clone/create_or_replace_clone.sql
[0m16:34:24.331149 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/intersect.sql
[0m16:34:24.331487 [debug] [MainThread]: Partial parsing: added file: dbt://macros/adapters/relation.sql
[0m16:34:24.331900 [debug] [MainThread]: Partial parsing: added file: ecommerce_dw://models/marts/product_performance.sql
[0m16:34:24.332291 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/create_backup.sql
[0m16:34:24.332647 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/view.sql
[0m16:34:24.332992 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/table/rename.sql
[0m16:34:24.333334 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/incremental/merge.sql
[0m16:34:24.333649 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/view/drop.sql
[0m16:34:24.334016 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/safe_cast.sql
[0m16:34:24.334341 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/functions/scalar.sql
[0m16:34:24.334704 [debug] [MainThread]: Partial parsing: added file: dbt://macros/etc/datetime.sql
[0m16:34:24.335035 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/table/drop.sql
[0m16:34:24.335384 [debug] [MainThread]: Partial parsing: added file: dbt://macros/adapters/indexes.sql
[0m16:34:24.335693 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/configs.sql
[0m16:34:24.336045 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/table/replace.sql
[0m16:34:24.336355 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/any_value.sql
[0m16:34:24.336708 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/adapters.sql
[0m16:34:24.337017 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/incremental/is_incremental.sql
[0m16:34:24.337356 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/utils/dateadd.sql
[0m16:34:24.337662 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/tests/unit.sql
[0m16:34:24.338013 [debug] [MainThread]: Partial parsing: added file: dbt://macros/generic_test_sql/unique.sql
[0m16:34:24.338314 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations.sql
[0m16:34:24.338646 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/utils/last_day.sql
[0m16:34:24.338961 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/table/replace.sql
[0m16:34:24.339311 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/dateadd.sql
[0m16:34:24.339697 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\table\create.sql
[0m16:34:24.340041 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\incremental\incremental.sql
[0m16:34:24.340360 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\incremental\strategies.sql
[0m16:34:24.340713 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\table\rename.sql
[0m16:34:24.341081 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\view\create.sql
[0m16:34:24.341451 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\view\drop.sql
[0m16:34:24.341814 [debug] [MainThread]: Partial parsing: deleted file: ecommerce_dw://models\marts\daily_sales.sql
[0m16:34:24.342164 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\table\replace.sql
[0m16:34:24.342566 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\utils\dateadd.sql
[0m16:34:24.343126 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\equals.sql
[0m16:34:24.344244 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations.sql
[0m16:34:24.344601 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\concat.sql
[0m16:34:24.344947 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\etc\datetime.sql
[0m16:34:24.345265 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\except.sql
[0m16:34:24.345771 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\adapters.sql
[0m16:34:24.346120 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\utils\split_part.sql
[0m16:34:24.346460 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\view\drop.sql
[0m16:34:24.346927 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\adapters\columns.sql
[0m16:34:24.347302 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\timestamps.sql
[0m16:34:24.347597 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\get_custom_name\get_custom_schema.sql
[0m16:34:24.347927 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\escape_single_quotes.sql
[0m16:34:24.348232 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\drop_backup.sql
[0m16:34:24.348586 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\table\drop.sql
[0m16:34:24.348884 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\materialized_view\drop.sql
[0m16:34:24.349223 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\materialized_view\refresh.sql
[0m16:34:24.349523 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\materialized_view\create.sql
[0m16:34:24.349859 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\view.sql
[0m16:34:24.350163 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\right.sql
[0m16:34:24.350496 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\adapters\schema.sql
[0m16:34:24.350797 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\snapshots\snapshot.sql
[0m16:34:24.351122 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\split_part.sql
[0m16:34:24.351486 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\functions\scalar.sql
[0m16:34:24.351828 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\materialized_view\alter.sql
[0m16:34:24.352211 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\adapters\apply_grants.sql
[0m16:34:24.352572 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\view\replace.sql
[0m16:34:24.352863 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\adapters\validate_sql.sql
[0m16:34:24.353207 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\array_concat.sql
[0m16:34:24.353533 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\drop.sql
[0m16:34:24.353957 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\adapters\indexes.sql
[0m16:34:24.354355 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\tests\helpers.sql
[0m16:34:24.354745 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\create_backup.sql
[0m16:34:24.355047 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\literal.sql
[0m16:34:24.355365 [debug] [MainThread]: Partial parsing: deleted file: dbt://docs\overview.md
[0m16:34:24.355666 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\replace.sql
[0m16:34:24.356004 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\bool_or.sql
[0m16:34:24.356289 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\tests\unit.sql
[0m16:34:24.356830 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\table.sql
[0m16:34:24.357894 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\clone\create_or_replace_clone.sql
[0m16:34:24.358715 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\materialized_view\describe.sql
[0m16:34:24.359282 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\adapters\relation.sql
[0m16:34:24.359932 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\clone\clone.sql
[0m16:34:24.361081 [debug] [MainThread]: Partial parsing: deleted file: ecommerce_dw://models\marts\product_performance.sql
[0m16:34:24.361464 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\functions\aggregate.sql
[0m16:34:24.361828 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\create_intermediate.sql
[0m16:34:24.362228 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\rename_intermediate.sql
[0m16:34:24.362601 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\table\rename.sql
[0m16:34:24.362942 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\materialized_view\rename.sql
[0m16:34:24.363295 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\cast_bool_to_text.sql
[0m16:34:24.363627 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\position.sql
[0m16:34:24.363996 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\materialized_view\refresh.sql
[0m16:34:24.364354 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\snapshots\snapshot_merge.sql
[0m16:34:24.364842 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\hash.sql
[0m16:34:24.365222 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\adapters\show.sql
[0m16:34:24.365680 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\etc\statement.sql
[0m16:34:24.366049 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\generate_series.sql
[0m16:34:24.366355 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\seeds\seed.sql
[0m16:34:24.366688 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\last_day.sql
[0m16:34:24.366982 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\materialized_view.sql
[0m16:34:24.367329 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\unit_test_sql\get_fixture_sql.sql
[0m16:34:24.367622 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\materialized_view\drop.sql
[0m16:34:24.367938 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\materializations\incremental_strategies.sql
[0m16:34:24.368233 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\rename.sql
[0m16:34:24.368569 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\schema.sql
[0m16:34:24.368867 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\table\drop.sql
[0m16:34:24.369196 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\incremental\merge.sql
[0m16:34:24.369489 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\catalog.sql
[0m16:34:24.369829 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\array_append.sql
[0m16:34:24.370185 [debug] [MainThread]: Partial parsing: deleted file: dbt://tests\generic\builtin.sql
[0m16:34:24.370510 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\utils\datediff.sql
[0m16:34:24.370793 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\adapters\freshness.sql
[0m16:34:24.371165 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\any_value.sql
[0m16:34:24.371489 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\intersect.sql
[0m16:34:24.371776 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\view\rename.sql
[0m16:34:24.372344 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\date.sql
[0m16:34:24.372722 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\date_spine.sql
[0m16:34:24.373079 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\get_custom_name\get_custom_database.sql
[0m16:34:24.373386 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\create.sql
[0m16:34:24.373725 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\view\rename.sql
[0m16:34:24.374075 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\snapshots\strategies.sql
[0m16:34:24.374407 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\utils\columns_spec_ddl.sql
[0m16:34:24.374791 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\column\columns_spec_ddl.sql
[0m16:34:24.375121 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\functions\function.sql
[0m16:34:24.375430 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\table\replace.sql
[0m16:34:24.375819 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\materialized_view\alter.sql
[0m16:34:24.376194 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\date_trunc.sql
[0m16:34:24.377260 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\materializations\snapshot_merge.sql
[0m16:34:24.377749 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\configs.sql
[0m16:34:24.378113 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\utils\last_day.sql
[0m16:34:24.378444 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\materialized_view\rename.sql
[0m16:34:24.378821 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\adapters\metadata.sql
[0m16:34:24.379129 [debug] [MainThread]: Partial parsing: deleted file: ecommerce_dw://models\marts\customer_ltv.sql
[0m16:34:24.379492 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\cast.sql
[0m16:34:24.379786 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\length.sql
[0m16:34:24.380124 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\safe_cast.sql
[0m16:34:24.380426 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\python_model\python.sql
[0m16:34:24.380760 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\tests\test.sql
[0m16:34:24.381049 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\generic_test_sql\accepted_values.sql
[0m16:34:24.381368 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\get_custom_name\get_custom_alias.sql
[0m16:34:24.381669 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\generic_test_sql\relationships.sql
[0m16:34:24.382017 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\hooks.sql
[0m16:34:24.382361 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\snapshots\helpers.sql
[0m16:34:24.382747 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\adapters\persist_docs.sql
[0m16:34:24.383069 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\replace.sql
[0m16:34:24.383400 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\incremental\is_incremental.sql
[0m16:34:24.383709 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\adapters\timestamps.sql
[0m16:34:24.384028 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\functions\helpers.sql
[0m16:34:24.384323 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\clone\can_clone_table.sql
[0m16:34:24.384642 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\materialized_view\create.sql
[0m16:34:24.384922 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\dateadd.sql
[0m16:34:24.385257 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\utils\any_value.sql
[0m16:34:24.385557 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\materialized_view\replace.sql
[0m16:34:24.385922 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\generic_test_sql\unique.sql
[0m16:34:24.386257 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\incremental\column_helpers.sql
[0m16:34:24.386608 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\seeds\helpers.sql
[0m16:34:24.386967 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\view\replace.sql
[0m16:34:24.387339 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\array_construct.sql
[0m16:34:24.387686 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\tests\where_subquery.sql
[0m16:34:24.388040 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\listagg.sql
[0m16:34:24.388712 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\datediff.sql
[0m16:34:24.389230 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\data_types.sql
[0m16:34:24.389697 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\utils\listagg.sql
[0m16:34:24.390143 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\generic_test_sql\not_null.sql
[0m16:34:24.390466 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\incremental\on_schema_change.sql
[0m16:34:24.390804 [debug] [MainThread]: Partial parsing: deleted file: ecommerce_dw://models\staging\stg_sales.sql
[0m16:34:24.391687 [error] [MainThread]: Encountered an error:
'dbt_postgres://macros/timestamps.sql'
[0m16:34:24.392914 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 182, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 276, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 321, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 391, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 368, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 407, in wrapper
    setup_manifest(ctx, write=write, write_perf_info=write_perf_info)
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 434, in setup_manifest
    ctx.obj["manifest"] = parse_manifest(
                          ^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/parser/manifest.py", line 2257, in parse_manifest
    manifest = ManifestLoader.get_full_manifest(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/parser/manifest.py", line 323, in get_full_manifest
    manifest = loader.load()
               ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/parser/manifest.py", line 392, in load
    self.load_and_parse_macros(project_parser_files)
  File "/usr/local/lib/python3.11/site-packages/dbt/parser/manifest.py", line 707, in load_and_parse_macros
    block = FileBlock(self.manifest.files[file_id])
                      ~~~~~~~~~~~~~~~~~~~^^^^^^^^^
KeyError: 'dbt_postgres://macros/timestamps.sql'

[0m16:34:24.394392 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.36563185, "process_in_blocks": "0", "process_kernel_time": 0.150792, "process_mem_max_rss": "115136", "process_out_blocks": "2120", "process_user_time": 0.924594}
[0m16:34:24.394887 [debug] [MainThread]: Command `dbt run` failed at 16:34:24.394818 after 0.37 seconds
[0m16:34:24.395316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74366007e110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743660311490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7436600b3f90>]}
[0m16:34:24.395764 [debug] [MainThread]: Flushing usage events
[0m16:34:24.897188 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:39:25.769147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71353df12910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71353e3c8850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71353e3cb490>]}


============================== 16:39:25.771146 | fba71e2f-2879-42c1-9058-73ff4b2833ba ==============================
[0m16:39:25.771146 [info ] [MainThread]: Running with dbt=1.11.4
[0m16:39:25.771638 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'printer_width': '80', 'static_parser': 'True', 'use_colors': 'True', 'quiet': 'False', 'empty': 'False', 'version_check': 'True', 'debug': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir .', 'log_format': 'default', 'fail_fast': 'False', 'log_path': '/dbt_project/logs', 'partial_parse': 'True', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'profiles_dir': '.', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'log_cache_events': 'False', 'write_json': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:39:25.852411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fba71e2f-2879-42c1-9058-73ff4b2833ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71353dfc2390>]}
[0m16:39:25.885507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fba71e2f-2879-42c1-9058-73ff4b2833ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71353d36a610>]}
[0m16:39:25.886217 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m16:39:25.916018 [debug] [MainThread]: checksum: 092b177ba87eb6bb3c55954c38aa57900eebac336561eb9ee32218428aa81d43, vars: {}, profile: , target: , version: 1.11.4
[0m16:39:25.987456 [debug] [MainThread]: Partial parsing enabled: 134 files deleted, 135 files added, 0 files changed.
[0m16:39:25.988119 [debug] [MainThread]: Partial parsing: added file: dbt://macros/get_custom_name/get_custom_database.sql
[0m16:39:25.988554 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/date_trunc.sql
[0m16:39:25.989045 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/table/rename.sql
[0m16:39:25.989483 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/view/rename.sql
[0m16:39:25.989875 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/materializations/incremental_strategies.sql
[0m16:39:25.990243 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/table/drop.sql
[0m16:39:25.990605 [debug] [MainThread]: Partial parsing: added file: dbt://macros/generic_test_sql/unique.sql
[0m16:39:25.991305 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/materialized_view/create.sql
[0m16:39:25.991690 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/listagg.sql
[0m16:39:25.992079 [debug] [MainThread]: Partial parsing: added file: dbt://macros/get_custom_name/get_custom_schema.sql
[0m16:39:25.992408 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/replace.sql
[0m16:39:25.992800 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/rename.sql
[0m16:39:25.993205 [debug] [MainThread]: Partial parsing: added file: dbt://macros/adapters/columns.sql
[0m16:39:25.993577 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/length.sql
[0m16:39:25.994224 [debug] [MainThread]: Partial parsing: added file: dbt://macros/adapters/timestamps.sql
[0m16:39:25.994787 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/timestamps.sql
[0m16:39:25.995490 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/snapshots/strategies.sql
[0m16:39:25.996020 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/column/columns_spec_ddl.sql
[0m16:39:25.996540 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/create_intermediate.sql
[0m16:39:25.997198 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/utils/last_day.sql
[0m16:39:25.997734 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/any_value.sql
[0m16:39:25.998187 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/table.sql
[0m16:39:25.998613 [debug] [MainThread]: Partial parsing: added file: dbt://macros/get_custom_name/get_custom_alias.sql
[0m16:39:25.999388 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/view/create.sql
[0m16:39:25.999732 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/right.sql
[0m16:39:26.000043 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/adapters.sql
[0m16:39:26.000430 [debug] [MainThread]: Partial parsing: added file: dbt://macros/adapters/persist_docs.sql
[0m16:39:26.000789 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/utils/any_value.sql
[0m16:39:26.001230 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/snapshots/snapshot.sql
[0m16:39:26.001692 [debug] [MainThread]: Partial parsing: added file: dbt://macros/python_model/python.sql
[0m16:39:26.002053 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/configs.sql
[0m16:39:26.002458 [debug] [MainThread]: Partial parsing: added file: dbt://docs/overview.md
[0m16:39:26.002952 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/cast.sql
[0m16:39:26.003313 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/table/replace.sql
[0m16:39:26.003721 [debug] [MainThread]: Partial parsing: added file: dbt://macros/generic_test_sql/relationships.sql
[0m16:39:26.004143 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/clone/create_or_replace_clone.sql
[0m16:39:26.004563 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/date.sql
[0m16:39:26.004991 [debug] [MainThread]: Partial parsing: added file: ecommerce_dw://models/marts/product_performance.sql
[0m16:39:26.005385 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/view.sql
[0m16:39:26.005759 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/tests/unit.sql
[0m16:39:26.006104 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/materialized_view/drop.sql
[0m16:39:26.006471 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/safe_cast.sql
[0m16:39:26.006855 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/materialized_view/drop.sql
[0m16:39:26.007230 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/functions/aggregate.sql
[0m16:39:26.007559 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/functions/helpers.sql
[0m16:39:26.007918 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/clone/can_clone_table.sql
[0m16:39:26.008230 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/table/create.sql
[0m16:39:26.008573 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/materialized_view/refresh.sql
[0m16:39:26.008939 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/replace.sql
[0m16:39:26.009341 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/datediff.sql
[0m16:39:26.009681 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/materializations/snapshot_merge.sql
[0m16:39:26.010215 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/dateadd.sql
[0m16:39:26.010666 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/utils/dateadd.sql
[0m16:39:26.011177 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/tests/helpers.sql
[0m16:39:26.011559 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/schema.sql
[0m16:39:26.011951 [debug] [MainThread]: Partial parsing: added file: dbt://macros/adapters/apply_grants.sql
[0m16:39:26.012291 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/functions/scalar.sql
[0m16:39:26.012879 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/view/drop.sql
[0m16:39:26.013800 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/tests/test.sql
[0m16:39:26.014259 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/catalog.sql
[0m16:39:26.014634 [debug] [MainThread]: Partial parsing: added file: dbt://tests/generic/builtin.sql
[0m16:39:26.015049 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/utils/columns_spec_ddl.sql
[0m16:39:26.015399 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/utils/listagg.sql
[0m16:39:26.015784 [debug] [MainThread]: Partial parsing: added file: dbt://macros/etc/datetime.sql
[0m16:39:26.016140 [debug] [MainThread]: Partial parsing: added file: dbt://macros/generic_test_sql/accepted_values.sql
[0m16:39:26.016506 [debug] [MainThread]: Partial parsing: added file: dbt://macros/etc/statement.sql
[0m16:39:26.016860 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/incremental/on_schema_change.sql
[0m16:39:26.017304 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/materialized_view/describe.sql
[0m16:39:26.017667 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/literal.sql
[0m16:39:26.018025 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/snapshots/helpers.sql
[0m16:39:26.018344 [debug] [MainThread]: Partial parsing: added file: dbt://macros/adapters/indexes.sql
[0m16:39:26.018685 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/tests/where_subquery.sql
[0m16:39:26.019123 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/utils/datediff.sql
[0m16:39:26.019511 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/view/rename.sql
[0m16:39:26.019871 [debug] [MainThread]: Partial parsing: added file: dbt://macros/adapters/relation.sql
[0m16:39:26.020252 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/array_append.sql
[0m16:39:26.020607 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/last_day.sql
[0m16:39:26.021078 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/except.sql
[0m16:39:26.021483 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/seeds/seed.sql
[0m16:39:26.021802 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/materialized_view/rename.sql
[0m16:39:26.022097 [debug] [MainThread]: Partial parsing: added file: ecommerce_dw://models/staging/stg_sales.sql
[0m16:39:26.022379 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/materialized_view/alter.sql
[0m16:39:26.022658 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/materializations/functions/scalar.sql
[0m16:39:26.023172 [debug] [MainThread]: Partial parsing: added file: dbt://macros/adapters/show.sql
[0m16:39:26.023516 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/table/drop.sql
[0m16:39:26.023853 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/table/replace.sql
[0m16:39:26.024158 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/position.sql
[0m16:39:26.024495 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations.sql
[0m16:39:26.024860 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/table/rename.sql
[0m16:39:26.025228 [debug] [MainThread]: Partial parsing: added file: dbt://macros/generic_test_sql/not_null.sql
[0m16:39:26.025849 [debug] [MainThread]: Partial parsing: added file: ecommerce_dw://models/marts/daily_sales.sql
[0m16:39:26.026184 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/materialized_view/refresh.sql
[0m16:39:26.026522 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/rename_intermediate.sql
[0m16:39:26.026953 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/concat.sql
[0m16:39:26.027341 [debug] [MainThread]: Partial parsing: added file: dbt://macros/unit_test_sql/get_fixture_sql.sql
[0m16:39:26.027665 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/cast_bool_to_text.sql
[0m16:39:26.028008 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/array_concat.sql
[0m16:39:26.028304 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/materialized_view.sql
[0m16:39:26.028625 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/materialized_view/alter.sql
[0m16:39:26.028968 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/array_construct.sql
[0m16:39:26.029425 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/drop_backup.sql
[0m16:39:26.029977 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/materialized_view/replace.sql
[0m16:39:26.030337 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/materialized_view/rename.sql
[0m16:39:26.030707 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/data_types.sql
[0m16:39:26.031180 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/incremental/column_helpers.sql
[0m16:39:26.031580 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/drop.sql
[0m16:39:26.031915 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/hash.sql
[0m16:39:26.032218 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/bool_or.sql
[0m16:39:26.032494 [debug] [MainThread]: Partial parsing: added file: dbt://macros/adapters/freshness.sql
[0m16:39:26.032846 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/clone/clone.sql
[0m16:39:26.033247 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/incremental/strategies.sql
[0m16:39:26.033652 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/functions/function.sql
[0m16:39:26.034089 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/incremental/merge.sql
[0m16:39:26.034489 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/relations/view/replace.sql
[0m16:39:26.034889 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/create.sql
[0m16:39:26.035392 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/intersect.sql
[0m16:39:26.035903 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/incremental/is_incremental.sql
[0m16:39:26.036249 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/date_spine.sql
[0m16:39:26.036645 [debug] [MainThread]: Partial parsing: added file: dbt://macros/adapters/metadata.sql
[0m16:39:26.037091 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/snapshots/snapshot_merge.sql
[0m16:39:26.037492 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/equals.sql
[0m16:39:26.037838 [debug] [MainThread]: Partial parsing: added file: ecommerce_dw://models/marts/customer_ltv.sql
[0m16:39:26.038213 [debug] [MainThread]: Partial parsing: added file: dbt://macros/adapters/schema.sql
[0m16:39:26.038565 [debug] [MainThread]: Partial parsing: added file: dbt://macros/adapters/validate_sql.sql
[0m16:39:26.039016 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/view/drop.sql
[0m16:39:26.039380 [debug] [MainThread]: Partial parsing: added file: dbt_postgres://macros/utils/split_part.sql
[0m16:39:26.039715 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/view/replace.sql
[0m16:39:26.040005 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/materialized_view/create.sql
[0m16:39:26.040298 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/split_part.sql
[0m16:39:26.040600 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/hooks.sql
[0m16:39:26.040963 [debug] [MainThread]: Partial parsing: added file: dbt://macros/relations/create_backup.sql
[0m16:39:26.041307 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/models/incremental/incremental.sql
[0m16:39:26.041936 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/escape_single_quotes.sql
[0m16:39:26.042305 [debug] [MainThread]: Partial parsing: added file: dbt://macros/utils/generate_series.sql
[0m16:39:26.042608 [debug] [MainThread]: Partial parsing: added file: dbt://macros/materializations/seeds/helpers.sql
[0m16:39:26.043051 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\view\create.sql
[0m16:39:26.043360 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\view.sql
[0m16:39:26.043647 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\materialized_view.sql
[0m16:39:26.043928 [debug] [MainThread]: Partial parsing: deleted file: ecommerce_dw://models\marts\customer_ltv.sql
[0m16:39:26.044254 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\materialized_view\refresh.sql
[0m16:39:26.044562 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\adapters\show.sql
[0m16:39:26.044972 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\functions\function.sql
[0m16:39:26.045347 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\materializations\incremental_strategies.sql
[0m16:39:26.045902 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\adapters\apply_grants.sql
[0m16:39:26.046613 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\clone\create_or_replace_clone.sql
[0m16:39:26.047079 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\create.sql
[0m16:39:26.047426 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\array_append.sql
[0m16:39:26.047853 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\utils\dateadd.sql
[0m16:39:26.048221 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\materialized_view\rename.sql
[0m16:39:26.048629 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\materialized_view\describe.sql
[0m16:39:26.049091 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\utils\split_part.sql
[0m16:39:26.049466 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\dateadd.sql
[0m16:39:26.049820 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\table\rename.sql
[0m16:39:26.050293 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\adapters.sql
[0m16:39:26.050623 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\generic_test_sql\unique.sql
[0m16:39:26.051042 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\snapshots\helpers.sql
[0m16:39:26.051396 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\right.sql
[0m16:39:26.051724 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\incremental\column_helpers.sql
[0m16:39:26.052079 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\table\create.sql
[0m16:39:26.052370 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\adapters\indexes.sql
[0m16:39:26.052662 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\generate_series.sql
[0m16:39:26.052934 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\etc\datetime.sql
[0m16:39:26.053197 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\bool_or.sql
[0m16:39:26.053457 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\generic_test_sql\relationships.sql
[0m16:39:26.053723 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\view\rename.sql
[0m16:39:26.053978 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\adapters\freshness.sql
[0m16:39:26.054252 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\table\drop.sql
[0m16:39:26.054507 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\generic_test_sql\accepted_values.sql
[0m16:39:26.054819 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\rename_intermediate.sql
[0m16:39:26.055189 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\tests\test.sql
[0m16:39:26.055499 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\materialized_view\refresh.sql
[0m16:39:26.055919 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\adapters\columns.sql
[0m16:39:26.056198 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\materialized_view\alter.sql
[0m16:39:26.056475 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\adapters\timestamps.sql
[0m16:39:26.056879 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\safe_cast.sql
[0m16:39:26.057552 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\etc\statement.sql
[0m16:39:26.057927 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\get_custom_name\get_custom_database.sql
[0m16:39:26.058259 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\table\drop.sql
[0m16:39:26.058549 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\table\replace.sql
[0m16:39:26.058915 [debug] [MainThread]: Partial parsing: deleted file: ecommerce_dw://models\marts\daily_sales.sql
[0m16:39:26.059227 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\timestamps.sql
[0m16:39:26.059589 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\materialized_view\drop.sql
[0m16:39:26.059946 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\materializations\snapshot_merge.sql
[0m16:39:26.060241 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\view\rename.sql
[0m16:39:26.060562 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\seeds\helpers.sql
[0m16:39:26.060966 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\datediff.sql
[0m16:39:26.061330 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\tests\where_subquery.sql
[0m16:39:26.061629 [debug] [MainThread]: Partial parsing: deleted file: ecommerce_dw://models\marts\product_performance.sql
[0m16:39:26.061927 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\literal.sql
[0m16:39:26.062529 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\materialized_view\create.sql
[0m16:39:26.063523 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\except.sql
[0m16:39:26.063908 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\create_backup.sql
[0m16:39:26.064238 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\hash.sql
[0m16:39:26.064590 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\utils\datediff.sql
[0m16:39:26.064990 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\last_day.sql
[0m16:39:26.065342 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations.sql
[0m16:39:26.065691 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\utils\last_day.sql
[0m16:39:26.065967 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\get_custom_name\get_custom_alias.sql
[0m16:39:26.066239 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\functions\helpers.sql
[0m16:39:26.066521 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\rename.sql
[0m16:39:26.066870 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\adapters\schema.sql
[0m16:39:26.067274 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\drop.sql
[0m16:39:26.067586 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\incremental\incremental.sql
[0m16:39:26.067869 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\create_intermediate.sql
[0m16:39:26.068144 [debug] [MainThread]: Partial parsing: deleted file: ecommerce_dw://models\staging\stg_sales.sql
[0m16:39:26.068408 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\intersect.sql
[0m16:39:26.068716 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\functions\scalar.sql
[0m16:39:26.069099 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\snapshots\snapshot.sql
[0m16:39:26.069468 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\incremental\is_incremental.sql
[0m16:39:26.069754 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\array_construct.sql
[0m16:39:26.070036 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\materialized_view\rename.sql
[0m16:39:26.070301 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\clone\clone.sql
[0m16:39:26.070568 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\adapters\validate_sql.sql
[0m16:39:26.070920 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\length.sql
[0m16:39:26.071244 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\materialized_view\drop.sql
[0m16:39:26.071519 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\drop_backup.sql
[0m16:39:26.071797 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\hooks.sql
[0m16:39:26.072063 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\view\drop.sql
[0m16:39:26.072350 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\adapters\persist_docs.sql
[0m16:39:26.072622 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\data_types.sql
[0m16:39:26.073211 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\snapshots\snapshot_merge.sql
[0m16:39:26.073844 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\cast.sql
[0m16:39:26.074430 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\date_trunc.sql
[0m16:39:26.074806 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\table.sql
[0m16:39:26.075231 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\unit_test_sql\get_fixture_sql.sql
[0m16:39:26.075582 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\view\replace.sql
[0m16:39:26.075916 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\utils\any_value.sql
[0m16:39:26.076205 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\utils\columns_spec_ddl.sql
[0m16:39:26.076485 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\configs.sql
[0m16:39:26.076797 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\equals.sql
[0m16:39:26.077145 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\view\replace.sql
[0m16:39:26.077434 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\tests\helpers.sql
[0m16:39:26.077731 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\incremental\strategies.sql
[0m16:39:26.078005 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\get_custom_name\get_custom_schema.sql
[0m16:39:26.078275 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\replace.sql
[0m16:39:26.078542 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\materialized_view\create.sql
[0m16:39:26.078869 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\listagg.sql
[0m16:39:26.079532 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\any_value.sql
[0m16:39:26.080228 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\view\drop.sql
[0m16:39:26.080703 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\snapshots\strategies.sql
[0m16:39:26.081192 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\date_spine.sql
[0m16:39:26.081611 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\array_concat.sql
[0m16:39:26.081968 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\utils\listagg.sql
[0m16:39:26.082336 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\python_model\python.sql
[0m16:39:26.082696 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\functions\aggregate.sql
[0m16:39:26.083075 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\position.sql
[0m16:39:26.083448 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\split_part.sql
[0m16:39:26.083858 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\adapters\relation.sql
[0m16:39:26.084196 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\clone\can_clone_table.sql
[0m16:39:26.084511 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\adapters\metadata.sql
[0m16:39:26.084866 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\table\replace.sql
[0m16:39:26.085240 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\replace.sql
[0m16:39:26.085602 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\column\columns_spec_ddl.sql
[0m16:39:26.085880 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\generic_test_sql\not_null.sql
[0m16:39:26.086155 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\incremental\merge.sql
[0m16:39:26.086430 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\relations\table\rename.sql
[0m16:39:26.086733 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\models\incremental\on_schema_change.sql
[0m16:39:26.087118 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\schema.sql
[0m16:39:26.087444 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\cast_bool_to_text.sql
[0m16:39:26.087753 [debug] [MainThread]: Partial parsing: deleted file: dbt://docs\overview.md
[0m16:39:26.088032 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\concat.sql
[0m16:39:26.088560 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\escape_single_quotes.sql
[0m16:39:26.088972 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\seeds\seed.sql
[0m16:39:26.089372 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\utils\date.sql
[0m16:39:26.089690 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\materializations\tests\unit.sql
[0m16:39:26.090005 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\materialized_view\replace.sql
[0m16:39:26.090282 [debug] [MainThread]: Partial parsing: deleted file: dbt://tests\generic\builtin.sql
[0m16:39:26.090559 [debug] [MainThread]: Partial parsing: deleted file: dbt://macros\relations\materialized_view\alter.sql
[0m16:39:26.090929 [debug] [MainThread]: Partial parsing: deleted file: dbt_postgres://macros\catalog.sql
[0m16:39:26.092592 [error] [MainThread]: Encountered an error:
'dbt_postgres://macros/timestamps.sql'
[0m16:39:26.093441 [error] [MainThread]: Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 182, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 276, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 321, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 391, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 368, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 407, in wrapper
    setup_manifest(ctx, write=write, write_perf_info=write_perf_info)
  File "/usr/local/lib/python3.11/site-packages/dbt/cli/requires.py", line 434, in setup_manifest
    ctx.obj["manifest"] = parse_manifest(
                          ^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/parser/manifest.py", line 2257, in parse_manifest
    manifest = ManifestLoader.get_full_manifest(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/parser/manifest.py", line 323, in get_full_manifest
    manifest = loader.load()
               ^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/dbt/parser/manifest.py", line 392, in load
    self.load_and_parse_macros(project_parser_files)
  File "/usr/local/lib/python3.11/site-packages/dbt/parser/manifest.py", line 707, in load_and_parse_macros
    block = FileBlock(self.manifest.files[file_id])
                      ~~~~~~~~~~~~~~~~~~~^^^^^^^^^
KeyError: 'dbt_postgres://macros/timestamps.sql'

[0m16:39:26.094176 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.35865885, "process_in_blocks": "0", "process_kernel_time": 0.140925, "process_mem_max_rss": "114552", "process_out_blocks": "0", "process_user_time": 0.853607}
[0m16:39:26.094565 [debug] [MainThread]: Command `dbt run` failed at 16:39:26.094516 after 0.36 seconds
[0m16:39:26.094949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71353df56950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71353df0b850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71353df0be50>]}
[0m16:39:26.095401 [debug] [MainThread]: Flushing usage events
[0m16:39:26.598878 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:45:57.925300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72642097bb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726420916850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72642097f4d0>]}


============================== 16:45:57.929704 | 7bf8726d-79fb-4cc0-ab20-86b7d08e056d ==============================
[0m16:45:57.929704 [info ] [MainThread]: Running with dbt=1.11.4
[0m16:45:57.930308 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'log_format': 'default', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'log_path': '/dbt_project/logs', 'profiles_dir': '.', 'invocation_command': 'dbt run --profiles-dir .', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'introspect': 'True', 'no_print': 'None', 'empty': 'False', 'warn_error': 'None', 'write_json': 'True', 'target_path': 'None', 'indirect_selection': 'eager', 'static_parser': 'True', 'debug': 'False', 'use_colors': 'True', 'quiet': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'fail_fast': 'False'}
[0m16:45:58.014201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7bf8726d-79fb-4cc0-ab20-86b7d08e056d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72641f98f350>]}
[0m16:45:58.046231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7bf8726d-79fb-4cc0-ab20-86b7d08e056d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72642384c5d0>]}
[0m16:45:58.047071 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m16:45:58.078679 [debug] [MainThread]: checksum: 092b177ba87eb6bb3c55954c38aa57900eebac336561eb9ee32218428aa81d43, vars: {}, profile: , target: , version: 1.11.4
[0m16:45:58.116668 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m16:45:58.117619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7bf8726d-79fb-4cc0-ab20-86b7d08e056d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x726421896b50>]}
[0m16:45:58.573020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7bf8726d-79fb-4cc0-ab20-86b7d08e056d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7264207ff510>]}
[0m16:45:58.604732 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt_project/target/manifest.json
[0m16:45:58.606922 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt_project/target/semantic_manifest.json
[0m16:45:58.618553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7bf8726d-79fb-4cc0-ab20-86b7d08e056d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72641ed47910>]}
[0m16:45:58.619053 [info ] [MainThread]: Found 4 models, 464 macros
[0m16:45:58.619482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7bf8726d-79fb-4cc0-ab20-86b7d08e056d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72641ed82410>]}
[0m16:45:58.620549 [info ] [MainThread]: 
[0m16:45:58.620913 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:45:58.621272 [info ] [MainThread]: 
[0m16:45:58.621765 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:45:58.624152 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_dw'
[0m16:45:58.639226 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_dw"
[0m16:45:58.639704 [debug] [ThreadPool]: On list_ecommerce_dw: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "connection_name": "list_ecommerce_dw"} */

    select distinct nspname from pg_namespace
  
[0m16:45:58.640047 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:45:58.645629 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.006 seconds
[0m16:45:58.646562 [debug] [ThreadPool]: On list_ecommerce_dw: Close
[0m16:45:58.647604 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ecommerce_dw, now list_ecommerce_dw_public)
[0m16:45:58.650542 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_dw_public"
[0m16:45:58.650909 [debug] [ThreadPool]: On list_ecommerce_dw_public: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "connection_name": "list_ecommerce_dw_public"} */
select
      'ecommerce_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:45:58.651241 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:45:58.656298 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m16:45:58.657163 [debug] [ThreadPool]: On list_ecommerce_dw_public: ROLLBACK
[0m16:45:58.657611 [debug] [ThreadPool]: On list_ecommerce_dw_public: Close
[0m16:45:58.659943 [debug] [MainThread]: Using postgres connection "master"
[0m16:45:58.660411 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m16:45:58.660812 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:45:58.666075 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m16:45:58.666944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7bf8726d-79fb-4cc0-ab20-86b7d08e056d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72641e9b6a50>]}
[0m16:45:58.667511 [debug] [MainThread]: On master: ROLLBACK
[0m16:45:58.667939 [debug] [MainThread]: On master: COMMIT
[0m16:45:58.668245 [debug] [MainThread]: Using postgres connection "master"
[0m16:45:58.668520 [debug] [MainThread]: On master: COMMIT
[0m16:45:58.668891 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:45:58.669173 [debug] [MainThread]: On master: Close
[0m16:45:58.672974 [debug] [Thread-1 (]: Began running node model.ecommerce_dw.stg_sales
[0m16:45:58.673495 [info ] [Thread-1 (]: 1 of 4 START sql view model public.stg_sales ................................... [RUN]
[0m16:45:58.674277 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ecommerce_dw_public, now model.ecommerce_dw.stg_sales)
[0m16:45:58.674834 [debug] [Thread-1 (]: Began compiling node model.ecommerce_dw.stg_sales
[0m16:45:58.678701 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_dw.stg_sales"
[0m16:45:58.681769 [debug] [Thread-1 (]: Began executing node model.ecommerce_dw.stg_sales
[0m16:45:58.697933 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_dw.stg_sales"
[0m16:45:58.701402 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dw.stg_sales"
[0m16:45:58.701868 [debug] [Thread-1 (]: On model.ecommerce_dw.stg_sales: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.stg_sales"} */

  create view "ecommerce_dw"."public"."stg_sales__dbt_tmp"
    
    
  as (
    -- Staging model: Clean fact_sales data
-- This is a foundation for marts



SELECT 
    f.sale_id,
    f.order_id,
    f.user_id,
    f.product_id,
    f.date_id,
    f.quantity,
    f.unit_price,
    f.revenue,
    f.created_at,
    
    -- Join dimension data for easier querying
    p.product_title,
    p.category,
    u.username,
    u.email,
    d.full_date,
    d.year,
    d.month,
    d.quarter
    
FROM fact_sales f
LEFT JOIN dim_product p ON f.product_id = p.product_id
LEFT JOIN dim_user u ON f.user_id = u.user_id
LEFT JOIN dim_date d ON f.date_id = d.date_id
WHERE f.created_at IS NOT NULL
  );
[0m16:45:58.702265 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:45:58.706494 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "fact_sales" does not exist
LINE 33: FROM fact_sales f
              ^

[0m16:45:58.706906 [debug] [Thread-1 (]: On model.ecommerce_dw.stg_sales: ROLLBACK
[0m16:45:58.707501 [debug] [Thread-1 (]: On model.ecommerce_dw.stg_sales: Close
[0m16:45:58.709372 [debug] [Thread-1 (]: Database Error in model stg_sales (models/staging/stg_sales.sql)
  relation "fact_sales" does not exist
  LINE 33: FROM fact_sales f
                ^
  compiled code at target/run/ecommerce_dw/models/staging/stg_sales.sql
[0m16:45:58.710419 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7bf8726d-79fb-4cc0-ab20-86b7d08e056d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72641e59aad0>]}
[0m16:45:58.712318 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model public.stg_sales .......................... [[31mERROR[0m in 0.04s]
[0m16:45:58.712898 [debug] [Thread-1 (]: Finished running node model.ecommerce_dw.stg_sales
[0m16:45:58.713489 [debug] [Thread-7 (]: Marking all children of 'model.ecommerce_dw.stg_sales' to be skipped because of status 'error'.  Reason: Database Error in model stg_sales (models/staging/stg_sales.sql)
  relation "fact_sales" does not exist
  LINE 33: FROM fact_sales f
                ^
  compiled code at target/run/ecommerce_dw/models/staging/stg_sales.sql.
[0m16:45:58.714484 [debug] [Thread-3 (]: Began running node model.ecommerce_dw.customer_ltv
[0m16:45:58.714733 [debug] [Thread-4 (]: Began running node model.ecommerce_dw.daily_sales
[0m16:45:58.714921 [debug] [Thread-2 (]: Began running node model.ecommerce_dw.product_performance
[0m16:45:58.715348 [info ] [Thread-3 (]: 2 of 4 SKIP relation public.customer_ltv ....................................... [[33mSKIP[0m]
[0m16:45:58.715771 [info ] [Thread-4 (]: 3 of 4 SKIP relation public.daily_sales ........................................ [[33mSKIP[0m]
[0m16:45:58.716197 [info ] [Thread-2 (]: 4 of 4 SKIP relation public.product_performance ................................ [[33mSKIP[0m]
[0m16:45:58.716607 [debug] [Thread-3 (]: Finished running node model.ecommerce_dw.customer_ltv
[0m16:45:58.717026 [debug] [Thread-4 (]: Finished running node model.ecommerce_dw.daily_sales
[0m16:45:58.717397 [debug] [Thread-2 (]: Finished running node model.ecommerce_dw.product_performance
[0m16:45:58.718939 [debug] [MainThread]: On master: COMMIT
[0m16:45:58.719423 [debug] [MainThread]: Using postgres connection "master"
[0m16:45:58.719768 [debug] [MainThread]: On master: COMMIT
[0m16:45:58.720133 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:45:58.724505 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m16:45:58.724998 [debug] [MainThread]: On master: Close
[0m16:45:58.725457 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:45:58.725849 [debug] [MainThread]: Connection 'model.ecommerce_dw.stg_sales' was properly closed.
[0m16:45:58.726298 [info ] [MainThread]: 
[0m16:45:58.726742 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0 hours 0 minutes and 0.10 seconds (0.10s).
[0m16:45:58.727348 [debug] [MainThread]: Command end result
[0m16:45:58.743736 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt_project/target/manifest.json
[0m16:45:58.747732 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt_project/target/semantic_manifest.json
[0m16:45:58.753289 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt_project/target/run_results.json
[0m16:45:58.753775 [info ] [MainThread]: 
[0m16:45:58.754258 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:45:58.754630 [info ] [MainThread]: 
[0m16:45:58.755085 [error] [MainThread]: [31mFailure in model stg_sales (models/staging/stg_sales.sql)[0m
[0m16:45:58.755681 [error] [MainThread]:   Database Error in model stg_sales (models/staging/stg_sales.sql)
  relation "fact_sales" does not exist
  LINE 33: FROM fact_sales f
                ^
  compiled code at target/run/ecommerce_dw/models/staging/stg_sales.sql
[0m16:45:58.756062 [info ] [MainThread]: 
[0m16:45:58.756420 [info ] [MainThread]:   compiled code at target/compiled/ecommerce_dw/models/staging/stg_sales.sql
[0m16:45:58.756766 [info ] [MainThread]: 
[0m16:45:58.757133 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=3 NO-OP=0 TOTAL=4
[0m16:45:58.757912 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.86758494, "process_in_blocks": "96", "process_kernel_time": 0.156102, "process_mem_max_rss": "129256", "process_out_blocks": "2240", "process_user_time": 1.408929}
[0m16:45:58.758310 [debug] [MainThread]: Command `dbt run` failed at 16:45:58.758255 after 0.87 seconds
[0m16:45:58.758697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72642090ca50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72642382b850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72642097e6d0>]}
[0m16:45:58.759043 [debug] [MainThread]: Flushing usage events
[0m16:45:59.252322 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:50:39.692923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72069f7779d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72069f776d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72069f7771d0>]}


============================== 16:50:39.697781 | 347d9da9-f061-4798-8151-553e6855c0c5 ==============================
[0m16:50:39.697781 [info ] [MainThread]: Running with dbt=1.11.4
[0m16:50:39.699285 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'version_check': 'True', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --profiles-dir .', 'log_path': '/dbt_project/logs', 'printer_width': '80', 'partial_parse': 'True', 'cache_selected_only': 'False', 'target_path': 'None', 'quiet': 'False', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'indirect_selection': 'eager', 'fail_fast': 'False', 'log_format': 'default', 'use_experimental_parser': 'False', 'debug': 'False', 'introspect': 'True', 'no_print': 'None', 'profiles_dir': '.', 'log_cache_events': 'False', 'warn_error': 'None'}
[0m16:50:39.781122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '347d9da9-f061-4798-8151-553e6855c0c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72069e7df0d0>]}
[0m16:50:39.813485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '347d9da9-f061-4798-8151-553e6855c0c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7206a2672ed0>]}
[0m16:50:39.814265 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m16:50:39.846134 [debug] [MainThread]: checksum: 092b177ba87eb6bb3c55954c38aa57900eebac336561eb9ee32218428aa81d43, vars: {}, profile: , target: , version: 1.11.4
[0m16:50:39.920652 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:50:39.921206 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:50:39.921720 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:50:39.934800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '347d9da9-f061-4798-8151-553e6855c0c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72069db82a50>]}
[0m16:50:39.970729 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt_project/target/manifest.json
[0m16:50:39.974115 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt_project/target/semantic_manifest.json
[0m16:50:39.986915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '347d9da9-f061-4798-8151-553e6855c0c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72069dfed390>]}
[0m16:50:39.987485 [info ] [MainThread]: Found 4 models, 464 macros
[0m16:50:39.987966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '347d9da9-f061-4798-8151-553e6855c0c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72069df872d0>]}
[0m16:50:39.989123 [info ] [MainThread]: 
[0m16:50:39.989615 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:50:39.990040 [info ] [MainThread]: 
[0m16:50:39.990542 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:50:39.992986 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_dw'
[0m16:50:40.009920 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_dw"
[0m16:50:40.010410 [debug] [ThreadPool]: On list_ecommerce_dw: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "connection_name": "list_ecommerce_dw"} */

    select distinct nspname from pg_namespace
  
[0m16:50:40.010730 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:50:40.016857 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.006 seconds
[0m16:50:40.017865 [debug] [ThreadPool]: On list_ecommerce_dw: Close
[0m16:50:40.018991 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ecommerce_dw, now list_ecommerce_dw_public)
[0m16:50:40.022005 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_dw_public"
[0m16:50:40.022397 [debug] [ThreadPool]: On list_ecommerce_dw_public: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "connection_name": "list_ecommerce_dw_public"} */
select
      'ecommerce_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:50:40.022702 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:50:40.027989 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m16:50:40.028789 [debug] [ThreadPool]: On list_ecommerce_dw_public: ROLLBACK
[0m16:50:40.029210 [debug] [ThreadPool]: On list_ecommerce_dw_public: Close
[0m16:50:40.031482 [debug] [MainThread]: Using postgres connection "master"
[0m16:50:40.032025 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m16:50:40.032542 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:50:40.037986 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m16:50:40.038840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '347d9da9-f061-4798-8151-553e6855c0c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72069e72d290>]}
[0m16:50:40.039282 [debug] [MainThread]: On master: ROLLBACK
[0m16:50:40.039689 [debug] [MainThread]: On master: COMMIT
[0m16:50:40.039999 [debug] [MainThread]: Using postgres connection "master"
[0m16:50:40.040274 [debug] [MainThread]: On master: COMMIT
[0m16:50:40.040646 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:50:40.040932 [debug] [MainThread]: On master: Close
[0m16:50:40.043721 [debug] [Thread-1 (]: Began running node model.ecommerce_dw.stg_sales
[0m16:50:40.044202 [info ] [Thread-1 (]: 1 of 4 START sql view model public.stg_sales ................................... [RUN]
[0m16:50:40.044638 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ecommerce_dw_public, now model.ecommerce_dw.stg_sales)
[0m16:50:40.044966 [debug] [Thread-1 (]: Began compiling node model.ecommerce_dw.stg_sales
[0m16:50:40.048618 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_dw.stg_sales"
[0m16:50:40.052703 [debug] [Thread-1 (]: Began executing node model.ecommerce_dw.stg_sales
[0m16:50:40.069136 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_dw.stg_sales"
[0m16:50:40.072964 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dw.stg_sales"
[0m16:50:40.073336 [debug] [Thread-1 (]: On model.ecommerce_dw.stg_sales: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.stg_sales"} */

  create view "ecommerce_dw"."public"."stg_sales__dbt_tmp"
    
    
  as (
    -- Staging model: Clean fact_sales data
-- This is a foundation for marts



SELECT 
    f.sale_id,
    f.order_id,
    f.user_id,
    f.product_id,
    f.date_id,
    f.quantity,
    f.unit_price,
    f.revenue,
    f.created_at,
    
    -- Join dimension data for easier querying
    p.product_title,
    p.category,
    u.username,
    u.email,
    d.full_date,
    d.year,
    d.month,
    d.quarter
    
FROM fact_sales f
LEFT JOIN dim_product p ON f.product_id = p.product_id
LEFT JOIN dim_user u ON f.user_id = u.user_id
LEFT JOIN dim_date d ON f.date_id = d.date_id
WHERE f.created_at IS NOT NULL
  );
[0m16:50:40.073675 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:50:40.077972 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "fact_sales" does not exist
LINE 33: FROM fact_sales f
              ^

[0m16:50:40.079021 [debug] [Thread-1 (]: On model.ecommerce_dw.stg_sales: ROLLBACK
[0m16:50:40.080066 [debug] [Thread-1 (]: On model.ecommerce_dw.stg_sales: Close
[0m16:50:40.082614 [debug] [Thread-1 (]: Database Error in model stg_sales (models/staging/stg_sales.sql)
  relation "fact_sales" does not exist
  LINE 33: FROM fact_sales f
                ^
  compiled code at target/run/ecommerce_dw/models/staging/stg_sales.sql
[0m16:50:40.084043 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '347d9da9-f061-4798-8151-553e6855c0c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72069c6d6310>]}
[0m16:50:40.084634 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model public.stg_sales .......................... [[31mERROR[0m in 0.04s]
[0m16:50:40.085115 [debug] [Thread-1 (]: Finished running node model.ecommerce_dw.stg_sales
[0m16:50:40.085633 [debug] [Thread-7 (]: Marking all children of 'model.ecommerce_dw.stg_sales' to be skipped because of status 'error'.  Reason: Database Error in model stg_sales (models/staging/stg_sales.sql)
  relation "fact_sales" does not exist
  LINE 33: FROM fact_sales f
                ^
  compiled code at target/run/ecommerce_dw/models/staging/stg_sales.sql.
[0m16:50:40.086686 [debug] [Thread-3 (]: Began running node model.ecommerce_dw.customer_ltv
[0m16:50:40.086895 [debug] [Thread-4 (]: Began running node model.ecommerce_dw.daily_sales
[0m16:50:40.087096 [debug] [Thread-2 (]: Began running node model.ecommerce_dw.product_performance
[0m16:50:40.087448 [info ] [Thread-3 (]: 2 of 4 SKIP relation public.customer_ltv ....................................... [[33mSKIP[0m]
[0m16:50:40.087969 [info ] [Thread-4 (]: 3 of 4 SKIP relation public.daily_sales ........................................ [[33mSKIP[0m]
[0m16:50:40.088315 [info ] [Thread-2 (]: 4 of 4 SKIP relation public.product_performance ................................ [[33mSKIP[0m]
[0m16:50:40.088694 [debug] [Thread-3 (]: Finished running node model.ecommerce_dw.customer_ltv
[0m16:50:40.089031 [debug] [Thread-4 (]: Finished running node model.ecommerce_dw.daily_sales
[0m16:50:40.089353 [debug] [Thread-2 (]: Finished running node model.ecommerce_dw.product_performance
[0m16:50:40.090814 [debug] [MainThread]: On master: COMMIT
[0m16:50:40.091215 [debug] [MainThread]: Using postgres connection "master"
[0m16:50:40.091526 [debug] [MainThread]: On master: COMMIT
[0m16:50:40.091932 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:50:40.095875 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m16:50:40.096330 [debug] [MainThread]: On master: Close
[0m16:50:40.096779 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:50:40.097153 [debug] [MainThread]: Connection 'model.ecommerce_dw.stg_sales' was properly closed.
[0m16:50:40.097504 [info ] [MainThread]: 
[0m16:50:40.097871 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0 hours 0 minutes and 0.11 seconds (0.11s).
[0m16:50:40.099737 [debug] [MainThread]: Command end result
[0m16:50:40.139236 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt_project/target/manifest.json
[0m16:50:40.141385 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt_project/target/semantic_manifest.json
[0m16:50:40.145452 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt_project/target/run_results.json
[0m16:50:40.145765 [info ] [MainThread]: 
[0m16:50:40.146104 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:50:40.146399 [info ] [MainThread]: 
[0m16:50:40.146718 [error] [MainThread]: [31mFailure in model stg_sales (models/staging/stg_sales.sql)[0m
[0m16:50:40.147027 [error] [MainThread]:   Database Error in model stg_sales (models/staging/stg_sales.sql)
  relation "fact_sales" does not exist
  LINE 33: FROM fact_sales f
                ^
  compiled code at target/run/ecommerce_dw/models/staging/stg_sales.sql
[0m16:50:40.147308 [info ] [MainThread]: 
[0m16:50:40.147628 [info ] [MainThread]:   compiled code at target/compiled/ecommerce_dw/models/staging/stg_sales.sql
[0m16:50:40.147923 [info ] [MainThread]: 
[0m16:50:40.148350 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=3 NO-OP=0 TOTAL=4
[0m16:50:40.149802 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.4921577, "process_in_blocks": "0", "process_kernel_time": 0.138405, "process_mem_max_rss": "125920", "process_out_blocks": "2240", "process_user_time": 1.0242}
[0m16:50:40.150310 [debug] [MainThread]: Command `dbt run` failed at 16:50:40.150242 after 0.49 seconds
[0m16:50:40.150675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7206a40ad150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72069f775510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72069f777f10>]}
[0m16:50:40.151005 [debug] [MainThread]: Flushing usage events
[0m16:50:40.664328 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:54:55.312935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f359f6a6e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f359f70f350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f359f9edc90>]}


============================== 16:54:55.316872 | a16892ec-b171-4eca-acfd-f17150cd47ca ==============================
[0m16:54:55.316872 [info ] [MainThread]: Running with dbt=1.11.4
[0m16:54:55.317395 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'version_check': 'True', 'printer_width': '80', 'target_path': 'None', 'introspect': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'quiet': 'False', 'static_parser': 'True', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --profiles-dir .', 'debug': 'False', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/dbt_project/logs', 'no_print': 'None', 'profiles_dir': '.', 'indirect_selection': 'eager', 'log_format': 'default'}
[0m16:54:55.398871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a16892ec-b171-4eca-acfd-f17150cd47ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f359ecb8f10>]}
[0m16:54:55.430976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a16892ec-b171-4eca-acfd-f17150cd47ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f359f5e6490>]}
[0m16:54:55.431740 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m16:54:55.463274 [debug] [MainThread]: checksum: 092b177ba87eb6bb3c55954c38aa57900eebac336561eb9ee32218428aa81d43, vars: {}, profile: , target: , version: 1.11.4
[0m16:54:55.528088 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:54:55.528570 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:54:55.528911 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:54:55.541929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a16892ec-b171-4eca-acfd-f17150cd47ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f359e187010>]}
[0m16:54:55.577432 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt_project/target/manifest.json
[0m16:54:55.580097 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt_project/target/semantic_manifest.json
[0m16:54:55.593957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a16892ec-b171-4eca-acfd-f17150cd47ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f359e5f0390>]}
[0m16:54:55.594444 [info ] [MainThread]: Found 4 models, 464 macros
[0m16:54:55.594842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a16892ec-b171-4eca-acfd-f17150cd47ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f359e5ba790>]}
[0m16:54:55.595919 [info ] [MainThread]: 
[0m16:54:55.596295 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:54:55.596626 [info ] [MainThread]: 
[0m16:54:55.597053 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:54:55.599262 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_dw'
[0m16:54:55.616306 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_dw"
[0m16:54:55.616798 [debug] [ThreadPool]: On list_ecommerce_dw: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "connection_name": "list_ecommerce_dw"} */

    select distinct nspname from pg_namespace
  
[0m16:54:55.617171 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:54:55.623673 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.006 seconds
[0m16:54:55.624613 [debug] [ThreadPool]: On list_ecommerce_dw: Close
[0m16:54:55.625728 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ecommerce_dw, now list_ecommerce_dw_public)
[0m16:54:55.628808 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_dw_public"
[0m16:54:55.629300 [debug] [ThreadPool]: On list_ecommerce_dw_public: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "connection_name": "list_ecommerce_dw_public"} */
select
      'ecommerce_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:54:55.629687 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:54:55.634938 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.005 seconds
[0m16:54:55.635902 [debug] [ThreadPool]: On list_ecommerce_dw_public: ROLLBACK
[0m16:54:55.636397 [debug] [ThreadPool]: On list_ecommerce_dw_public: Close
[0m16:54:55.639718 [debug] [MainThread]: Using postgres connection "master"
[0m16:54:55.640274 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m16:54:55.640704 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:54:55.646418 [debug] [MainThread]: SQL status: SELECT 6 in 0.006 seconds
[0m16:54:55.647797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a16892ec-b171-4eca-acfd-f17150cd47ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35a27003d0>]}
[0m16:54:55.648311 [debug] [MainThread]: On master: ROLLBACK
[0m16:54:55.648779 [debug] [MainThread]: On master: COMMIT
[0m16:54:55.649165 [debug] [MainThread]: Using postgres connection "master"
[0m16:54:55.649527 [debug] [MainThread]: On master: COMMIT
[0m16:54:55.649936 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:54:55.650246 [debug] [MainThread]: On master: Close
[0m16:54:55.654042 [debug] [Thread-1 (]: Began running node model.ecommerce_dw.stg_sales
[0m16:54:55.655035 [info ] [Thread-1 (]: 1 of 4 START sql view model public.stg_sales ................................... [RUN]
[0m16:54:55.657513 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ecommerce_dw_public, now model.ecommerce_dw.stg_sales)
[0m16:54:55.660551 [debug] [Thread-1 (]: Began compiling node model.ecommerce_dw.stg_sales
[0m16:54:55.664897 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_dw.stg_sales"
[0m16:54:55.673816 [debug] [Thread-1 (]: Began executing node model.ecommerce_dw.stg_sales
[0m16:54:55.725381 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_dw.stg_sales"
[0m16:54:55.731459 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dw.stg_sales"
[0m16:54:55.732143 [debug] [Thread-1 (]: On model.ecommerce_dw.stg_sales: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.stg_sales"} */

  create view "ecommerce_dw"."public"."stg_sales__dbt_tmp"
    
    
  as (
    -- Staging model: Clean fact_sales data
-- This is a foundation for marts



SELECT 
    f.sale_id,
    f.order_id,
    f.user_id,
    f.product_id,
    f.date_id,
    f.quantity,
    f.unit_price,
    f.revenue,
    f.created_at,
    
    -- Join dimension data for easier querying
    p.product_title,
    p.category,
    u.username,
    u.email,
    d.full_date,
    d.year,
    d.month,
    d.quarter
    
FROM fact_sales f
LEFT JOIN dim_product p ON f.product_id = p.product_id
LEFT JOIN dim_user u ON f.user_id = u.user_id
LEFT JOIN dim_date d ON f.date_id = d.date_id
WHERE f.created_at IS NOT NULL
  );
[0m16:54:55.732624 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:54:55.738334 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m16:54:55.741717 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dw.stg_sales"
[0m16:54:55.742362 [debug] [Thread-1 (]: On model.ecommerce_dw.stg_sales: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.stg_sales"} */
alter table "ecommerce_dw"."public"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m16:54:55.743029 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:54:55.750074 [debug] [Thread-1 (]: On model.ecommerce_dw.stg_sales: COMMIT
[0m16:54:55.750570 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dw.stg_sales"
[0m16:54:55.751393 [debug] [Thread-1 (]: On model.ecommerce_dw.stg_sales: COMMIT
[0m16:54:55.753219 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:54:55.756792 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_dw"."public"."stg_sales__dbt_backup"
[0m16:54:55.759814 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dw.stg_sales"
[0m16:54:55.760194 [debug] [Thread-1 (]: On model.ecommerce_dw.stg_sales: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.stg_sales"} */
drop view if exists "ecommerce_dw"."public"."stg_sales__dbt_backup" cascade
[0m16:54:55.760977 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m16:54:55.762328 [debug] [Thread-1 (]: On model.ecommerce_dw.stg_sales: Close
[0m16:54:55.763416 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a16892ec-b171-4eca-acfd-f17150cd47ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f359d1a77d0>]}
[0m16:54:55.763984 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public.stg_sales .............................. [[32mCREATE VIEW[0m in 0.11s]
[0m16:54:55.764512 [debug] [Thread-1 (]: Finished running node model.ecommerce_dw.stg_sales
[0m16:54:55.765234 [debug] [Thread-3 (]: Began running node model.ecommerce_dw.customer_ltv
[0m16:54:55.765486 [debug] [Thread-4 (]: Began running node model.ecommerce_dw.daily_sales
[0m16:54:55.765678 [debug] [Thread-2 (]: Began running node model.ecommerce_dw.product_performance
[0m16:54:55.766113 [info ] [Thread-3 (]: 2 of 4 START sql table model public.customer_ltv ............................... [RUN]
[0m16:54:55.766548 [info ] [Thread-4 (]: 3 of 4 START sql table model public.daily_sales ................................ [RUN]
[0m16:54:55.766938 [info ] [Thread-2 (]: 4 of 4 START sql table model public.product_performance ........................ [RUN]
[0m16:54:55.767350 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_dw.customer_ltv'
[0m16:54:55.767735 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.ecommerce_dw.daily_sales'
[0m16:54:55.768111 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.ecommerce_dw.product_performance'
[0m16:54:55.768447 [debug] [Thread-3 (]: Began compiling node model.ecommerce_dw.customer_ltv
[0m16:54:55.768784 [debug] [Thread-4 (]: Began compiling node model.ecommerce_dw.daily_sales
[0m16:54:55.769100 [debug] [Thread-2 (]: Began compiling node model.ecommerce_dw.product_performance
[0m16:54:55.770750 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_dw.customer_ltv"
[0m16:54:55.772317 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_dw.daily_sales"
[0m16:54:55.773892 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_dw.product_performance"
[0m16:54:55.776720 [debug] [Thread-3 (]: Began executing node model.ecommerce_dw.customer_ltv
[0m16:54:55.777214 [debug] [Thread-2 (]: Began executing node model.ecommerce_dw.product_performance
[0m16:54:55.782653 [debug] [Thread-4 (]: Began executing node model.ecommerce_dw.daily_sales
[0m16:54:55.787651 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_dw.customer_ltv"
[0m16:54:55.789480 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_dw.product_performance"
[0m16:54:55.792051 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_dw.daily_sales"
[0m16:54:55.794615 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_dw.customer_ltv"
[0m16:54:55.794906 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_dw.product_performance"
[0m16:54:55.795466 [debug] [Thread-3 (]: On model.ecommerce_dw.customer_ltv: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.customer_ltv"} */

  
    

  create  table "ecommerce_dw"."public"."customer_ltv__dbt_tmp"
  
  
    as
  
  (
    -- Customer Lifetime Value
-- Aggregated customer metrics



SELECT 
    user_id,
    username,
    email,
    
    COUNT(DISTINCT order_id) as lifetime_orders,
    SUM(revenue) as lifetime_value,
    AVG(revenue) as avg_order_value,
    SUM(quantity) as total_items_purchased,
    
    MIN(created_at) as first_order_date,
    MAX(created_at) as last_order_date,
    
    -- Calculate days between first and last order
    EXTRACT(DAY FROM (MAX(created_at) - MIN(created_at))) as customer_tenure_days,
    
    -- Categorize customers
    CASE 
        WHEN COUNT(DISTINCT order_id) >= 20 THEN 'VIP'
        WHEN COUNT(DISTINCT order_id) >= 10 THEN 'Regular'
        ELSE 'Casual'
    END as customer_segment
    
FROM "ecommerce_dw"."public"."stg_sales"
GROUP BY user_id, username, email
ORDER BY lifetime_value DESC
  );
  
[0m16:54:55.796029 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_dw.daily_sales"
[0m16:54:55.796258 [debug] [Thread-2 (]: On model.ecommerce_dw.product_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.product_performance"} */

  
    

  create  table "ecommerce_dw"."public"."product_performance__dbt_tmp"
  
  
    as
  
  (
    -- Product Performance Analytics
-- Product-level metrics



SELECT 
    product_id,
    product_title,
    category,
    
    COUNT(DISTINCT order_id) as times_ordered,
    SUM(quantity) as total_units_sold,
    SUM(revenue) as total_revenue,
    AVG(unit_price) as avg_sale_price,
    
    -- Performance metrics
    RANK() OVER (ORDER BY SUM(revenue) DESC) as revenue_rank,
    RANK() OVER (PARTITION BY category ORDER BY SUM(revenue) DESC) as category_rank,
    
    -- Calculate what % of total revenue
    ROUND(
        100.0 * SUM(revenue) / SUM(SUM(revenue)) OVER (),
        2
    ) as pct_of_total_revenue
    
FROM "ecommerce_dw"."public"."stg_sales"
GROUP BY product_id, product_title, category
ORDER BY total_revenue DESC
  );
  
[0m16:54:55.796656 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:54:55.797059 [debug] [Thread-4 (]: On model.ecommerce_dw.daily_sales: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.daily_sales"} */

  
    

  create  table "ecommerce_dw"."public"."daily_sales__dbt_tmp"
  
  
    as
  
  (
    -- Daily Sales Aggregations
-- Business metrics aggregated by day



SELECT 
    full_date,
    year,
    month,
    quarter,
    
    COUNT(DISTINCT order_id) as total_orders,
    COUNT(DISTINCT user_id) as unique_customers,
    SUM(quantity) as total_items_sold,
    SUM(revenue) as total_revenue,
    AVG(revenue) as avg_order_value,
    MAX(revenue) as max_order_value,
    MIN(revenue) as min_order_value
    
FROM "ecommerce_dw"."public"."stg_sales"
GROUP BY full_date, year, month, quarter
ORDER BY full_date DESC
  );
  
[0m16:54:55.797459 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:54:55.798172 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:54:55.807301 [debug] [Thread-3 (]: SQL status: SELECT 20 in 0.011 seconds
[0m16:54:55.811635 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_dw.customer_ltv"
[0m16:54:55.811857 [debug] [Thread-2 (]: SQL status: SELECT 17 in 0.014 seconds
[0m16:54:55.812058 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.014 seconds
[0m16:54:55.812437 [debug] [Thread-3 (]: On model.ecommerce_dw.customer_ltv: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.customer_ltv"} */
alter table "ecommerce_dw"."public"."customer_ltv__dbt_tmp" rename to "customer_ltv"
[0m16:54:55.814079 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_dw.product_performance"
[0m16:54:55.815639 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_dw.daily_sales"
[0m16:54:55.816244 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:54:55.816435 [debug] [Thread-2 (]: On model.ecommerce_dw.product_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.product_performance"} */
alter table "ecommerce_dw"."public"."product_performance__dbt_tmp" rename to "product_performance"
[0m16:54:55.816807 [debug] [Thread-4 (]: On model.ecommerce_dw.daily_sales: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.daily_sales"} */
alter table "ecommerce_dw"."public"."daily_sales__dbt_tmp" rename to "daily_sales"
[0m16:54:55.817585 [debug] [Thread-3 (]: On model.ecommerce_dw.customer_ltv: COMMIT
[0m16:54:55.818193 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:54:55.818637 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:54:55.818919 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_dw.customer_ltv"
[0m16:54:55.820194 [debug] [Thread-2 (]: On model.ecommerce_dw.product_performance: COMMIT
[0m16:54:55.821601 [debug] [Thread-4 (]: On model.ecommerce_dw.daily_sales: COMMIT
[0m16:54:55.821975 [debug] [Thread-3 (]: On model.ecommerce_dw.customer_ltv: COMMIT
[0m16:54:55.822783 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_dw.product_performance"
[0m16:54:55.823202 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_dw.daily_sales"
[0m16:54:55.823870 [debug] [Thread-2 (]: On model.ecommerce_dw.product_performance: COMMIT
[0m16:54:55.824242 [debug] [Thread-4 (]: On model.ecommerce_dw.daily_sales: COMMIT
[0m16:54:55.824727 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m16:54:55.825547 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m16:54:55.826681 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_dw"."public"."customer_ltv__dbt_backup"
[0m16:54:55.826864 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m16:54:55.828087 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_dw"."public"."product_performance__dbt_backup"
[0m16:54:55.830044 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_dw.customer_ltv"
[0m16:54:55.831334 [debug] [Thread-4 (]: Applying DROP to: "ecommerce_dw"."public"."daily_sales__dbt_backup"
[0m16:54:55.831867 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_dw.product_performance"
[0m16:54:55.832217 [debug] [Thread-3 (]: On model.ecommerce_dw.customer_ltv: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.customer_ltv"} */
drop table if exists "ecommerce_dw"."public"."customer_ltv__dbt_backup" cascade
[0m16:54:55.832679 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_dw.daily_sales"
[0m16:54:55.833026 [debug] [Thread-2 (]: On model.ecommerce_dw.product_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.product_performance"} */
drop table if exists "ecommerce_dw"."public"."product_performance__dbt_backup" cascade
[0m16:54:55.833705 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.000 seconds
[0m16:54:55.833974 [debug] [Thread-4 (]: On model.ecommerce_dw.daily_sales: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.daily_sales"} */
drop table if exists "ecommerce_dw"."public"."daily_sales__dbt_backup" cascade
[0m16:54:55.834455 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.000 seconds
[0m16:54:55.835131 [debug] [Thread-3 (]: On model.ecommerce_dw.customer_ltv: Close
[0m16:54:55.835618 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.000 seconds
[0m16:54:55.836318 [debug] [Thread-2 (]: On model.ecommerce_dw.product_performance: Close
[0m16:54:55.837997 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a16892ec-b171-4eca-acfd-f17150cd47ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35a000b550>]}
[0m16:54:55.838798 [debug] [Thread-4 (]: On model.ecommerce_dw.daily_sales: Close
[0m16:54:55.839349 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a16892ec-b171-4eca-acfd-f17150cd47ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f359c5bbb90>]}
[0m16:54:55.839941 [info ] [Thread-3 (]: 2 of 4 OK created sql table model public.customer_ltv .......................... [[32mSELECT 20[0m in 0.07s]
[0m16:54:55.840585 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a16892ec-b171-4eca-acfd-f17150cd47ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f359ed0b010>]}
[0m16:54:55.841096 [info ] [Thread-2 (]: 4 of 4 OK created sql table model public.product_performance ................... [[32mSELECT 17[0m in 0.07s]
[0m16:54:55.841696 [debug] [Thread-3 (]: Finished running node model.ecommerce_dw.customer_ltv
[0m16:54:55.842227 [info ] [Thread-4 (]: 3 of 4 OK created sql table model public.daily_sales ........................... [[32mSELECT 1[0m in 0.07s]
[0m16:54:55.842683 [debug] [Thread-2 (]: Finished running node model.ecommerce_dw.product_performance
[0m16:54:55.843395 [debug] [Thread-4 (]: Finished running node model.ecommerce_dw.daily_sales
[0m16:54:55.844727 [debug] [MainThread]: On master: COMMIT
[0m16:54:55.845095 [debug] [MainThread]: Using postgres connection "master"
[0m16:54:55.845465 [debug] [MainThread]: On master: COMMIT
[0m16:54:55.845819 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:54:55.849671 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m16:54:55.850067 [debug] [MainThread]: On master: Close
[0m16:54:55.850490 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:54:55.850949 [debug] [MainThread]: Connection 'model.ecommerce_dw.stg_sales' was properly closed.
[0m16:54:55.851371 [debug] [MainThread]: Connection 'model.ecommerce_dw.customer_ltv' was properly closed.
[0m16:54:55.851732 [debug] [MainThread]: Connection 'model.ecommerce_dw.daily_sales' was properly closed.
[0m16:54:55.852031 [debug] [MainThread]: Connection 'model.ecommerce_dw.product_performance' was properly closed.
[0m16:54:55.852345 [info ] [MainThread]: 
[0m16:54:55.852664 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m16:54:55.854239 [debug] [MainThread]: Command end result
[0m16:54:55.868821 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt_project/target/manifest.json
[0m16:54:55.872388 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt_project/target/semantic_manifest.json
[0m16:54:55.876626 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt_project/target/run_results.json
[0m16:54:55.876991 [info ] [MainThread]: 
[0m16:54:55.877427 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:54:55.877751 [info ] [MainThread]: 
[0m16:54:55.878054 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m16:54:55.878693 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.59916, "process_in_blocks": "0", "process_kernel_time": 0.14058, "process_mem_max_rss": "127340", "process_out_blocks": "2240", "process_user_time": 1.088492}
[0m16:54:55.879056 [debug] [MainThread]: Command `dbt run` succeeded at 16:54:55.879006 after 0.60 seconds
[0m16:54:55.879362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35a40405d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35a4040590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35a40415d0>]}
[0m16:54:55.879672 [debug] [MainThread]: Flushing usage events
[0m16:54:56.391397 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:59:57.280815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda28e7c9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda28eda250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda28e7c450>]}


============================== 16:59:57.283053 | c94aed56-b974-434b-be32-e6cc73496494 ==============================
[0m16:59:57.283053 [info ] [MainThread]: Running with dbt=1.11.4
[0m16:59:57.283633 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'write_json': 'True', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'static_parser': 'True', 'log_format': 'default', 'indirect_selection': 'eager', 'log_path': '/dbt_project/logs', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '.', 'printer_width': '80', 'invocation_command': 'dbt run --profiles-dir .', 'no_print': 'None', 'quiet': 'False', 'target_path': 'None', 'use_colors': 'True', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'partial_parse': 'True', 'introspect': 'True', 'version_check': 'True'}
[0m16:59:57.365374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c94aed56-b974-434b-be32-e6cc73496494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda28e85550>]}
[0m16:59:57.397055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c94aed56-b974-434b-be32-e6cc73496494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda2be36550>]}
[0m16:59:57.397822 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m16:59:57.428397 [debug] [MainThread]: checksum: 092b177ba87eb6bb3c55954c38aa57900eebac336561eb9ee32218428aa81d43, vars: {}, profile: , target: , version: 1.11.4
[0m16:59:57.492284 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:59:57.492764 [debug] [MainThread]: Nothing changed, skipping partial parsing.
[0m16:59:57.493113 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:59:57.506465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c94aed56-b974-434b-be32-e6cc73496494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda277a8a10>]}
[0m16:59:57.540514 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt_project/target/manifest.json
[0m16:59:57.542879 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt_project/target/semantic_manifest.json
[0m16:59:57.552579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c94aed56-b974-434b-be32-e6cc73496494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda27780250>]}
[0m16:59:57.553105 [info ] [MainThread]: Found 4 models, 464 macros
[0m16:59:57.553495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c94aed56-b974-434b-be32-e6cc73496494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda27353550>]}
[0m16:59:57.554535 [info ] [MainThread]: 
[0m16:59:57.554894 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:59:57.555211 [info ] [MainThread]: 
[0m16:59:57.555684 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:59:57.558487 [debug] [ThreadPool]: Acquiring new postgres connection 'list_ecommerce_dw'
[0m16:59:57.576492 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_dw"
[0m16:59:57.577083 [debug] [ThreadPool]: On list_ecommerce_dw: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "connection_name": "list_ecommerce_dw"} */

    select distinct nspname from pg_namespace
  
[0m16:59:57.577428 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:59:57.583334 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.006 seconds
[0m16:59:57.584345 [debug] [ThreadPool]: On list_ecommerce_dw: Close
[0m16:59:57.585550 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ecommerce_dw, now list_ecommerce_dw_public)
[0m16:59:57.588657 [debug] [ThreadPool]: Using postgres connection "list_ecommerce_dw_public"
[0m16:59:57.589097 [debug] [ThreadPool]: On list_ecommerce_dw_public: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "connection_name": "list_ecommerce_dw_public"} */
select
      'ecommerce_dw' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_dw' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'ecommerce_dw' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:59:57.590289 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:59:57.595762 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.005 seconds
[0m16:59:57.596769 [debug] [ThreadPool]: On list_ecommerce_dw_public: ROLLBACK
[0m16:59:57.597215 [debug] [ThreadPool]: On list_ecommerce_dw_public: Close
[0m16:59:57.600247 [debug] [MainThread]: Using postgres connection "master"
[0m16:59:57.600686 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m16:59:57.601102 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:59:57.606157 [debug] [MainThread]: SQL status: SELECT 10 in 0.005 seconds
[0m16:59:57.608518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c94aed56-b974-434b-be32-e6cc73496494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda26fa5c50>]}
[0m16:59:57.609011 [debug] [MainThread]: On master: ROLLBACK
[0m16:59:57.609464 [debug] [MainThread]: On master: COMMIT
[0m16:59:57.609801 [debug] [MainThread]: Using postgres connection "master"
[0m16:59:57.610109 [debug] [MainThread]: On master: COMMIT
[0m16:59:57.610542 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:59:57.611198 [debug] [MainThread]: On master: Close
[0m16:59:57.613525 [debug] [Thread-1 (]: Began running node model.ecommerce_dw.stg_sales
[0m16:59:57.614018 [info ] [Thread-1 (]: 1 of 4 START sql view model public.stg_sales ................................... [RUN]
[0m16:59:57.614480 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ecommerce_dw_public, now model.ecommerce_dw.stg_sales)
[0m16:59:57.614901 [debug] [Thread-1 (]: Began compiling node model.ecommerce_dw.stg_sales
[0m16:59:57.618565 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_dw.stg_sales"
[0m16:59:57.621430 [debug] [Thread-1 (]: Began executing node model.ecommerce_dw.stg_sales
[0m16:59:57.638088 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_dw.stg_sales"
[0m16:59:57.642783 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dw.stg_sales"
[0m16:59:57.643211 [debug] [Thread-1 (]: On model.ecommerce_dw.stg_sales: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.stg_sales"} */

  create view "ecommerce_dw"."public"."stg_sales__dbt_tmp"
    
    
  as (
    -- Staging model: Clean fact_sales data
-- This is a foundation for marts



SELECT 
    f.sale_id,
    f.order_id,
    f.user_id,
    f.product_id,
    f.date_id,
    f.quantity,
    f.unit_price,
    f.revenue,
    f.created_at,
    
    -- Join dimension data for easier querying
    p.product_title,
    p.category,
    u.username,
    u.email,
    d.full_date,
    d.year,
    d.month,
    d.quarter
    
FROM fact_sales f
LEFT JOIN dim_product p ON f.product_id = p.product_id
LEFT JOIN dim_user u ON f.user_id = u.user_id
LEFT JOIN dim_date d ON f.date_id = d.date_id
WHERE f.created_at IS NOT NULL
  );
[0m16:59:57.643618 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:59:57.649030 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m16:59:57.680404 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dw.stg_sales"
[0m16:59:57.681007 [debug] [Thread-1 (]: On model.ecommerce_dw.stg_sales: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.stg_sales"} */
alter table "ecommerce_dw"."public"."stg_sales" rename to "stg_sales__dbt_backup"
[0m16:59:57.681807 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:59:57.683423 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dw.stg_sales"
[0m16:59:57.683805 [debug] [Thread-1 (]: On model.ecommerce_dw.stg_sales: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.stg_sales"} */
alter table "ecommerce_dw"."public"."stg_sales__dbt_tmp" rename to "stg_sales"
[0m16:59:57.684433 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:59:57.692302 [debug] [Thread-1 (]: On model.ecommerce_dw.stg_sales: COMMIT
[0m16:59:57.692770 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dw.stg_sales"
[0m16:59:57.693169 [debug] [Thread-1 (]: On model.ecommerce_dw.stg_sales: COMMIT
[0m16:59:57.694899 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:59:57.697987 [debug] [Thread-1 (]: Applying DROP to: "ecommerce_dw"."public"."stg_sales__dbt_backup"
[0m16:59:57.700984 [debug] [Thread-1 (]: Using postgres connection "model.ecommerce_dw.stg_sales"
[0m16:59:57.701419 [debug] [Thread-1 (]: On model.ecommerce_dw.stg_sales: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.stg_sales"} */
drop view if exists "ecommerce_dw"."public"."stg_sales__dbt_backup" cascade
[0m16:59:57.703289 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m16:59:57.704864 [debug] [Thread-1 (]: On model.ecommerce_dw.stg_sales: Close
[0m16:59:57.705955 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c94aed56-b974-434b-be32-e6cc73496494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda28eb6dd0>]}
[0m16:59:57.706895 [info ] [Thread-1 (]: 1 of 4 OK created sql view model public.stg_sales .............................. [[32mCREATE VIEW[0m in 0.09s]
[0m16:59:57.707798 [debug] [Thread-1 (]: Finished running node model.ecommerce_dw.stg_sales
[0m16:59:57.708656 [debug] [Thread-3 (]: Began running node model.ecommerce_dw.customer_ltv
[0m16:59:57.708888 [debug] [Thread-4 (]: Began running node model.ecommerce_dw.daily_sales
[0m16:59:57.709098 [debug] [Thread-2 (]: Began running node model.ecommerce_dw.product_performance
[0m16:59:57.709547 [info ] [Thread-3 (]: 2 of 4 START sql table model public.customer_ltv ............................... [RUN]
[0m16:59:57.710083 [info ] [Thread-4 (]: 3 of 4 START sql table model public.daily_sales ................................ [RUN]
[0m16:59:57.710575 [info ] [Thread-2 (]: 4 of 4 START sql table model public.product_performance ........................ [RUN]
[0m16:59:57.711838 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.ecommerce_dw.customer_ltv'
[0m16:59:57.712297 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.ecommerce_dw.daily_sales'
[0m16:59:57.712769 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.ecommerce_dw.product_performance'
[0m16:59:57.713202 [debug] [Thread-3 (]: Began compiling node model.ecommerce_dw.customer_ltv
[0m16:59:57.713564 [debug] [Thread-4 (]: Began compiling node model.ecommerce_dw.daily_sales
[0m16:59:57.713929 [debug] [Thread-2 (]: Began compiling node model.ecommerce_dw.product_performance
[0m16:59:57.715704 [debug] [Thread-3 (]: Writing injected SQL for node "model.ecommerce_dw.customer_ltv"
[0m16:59:57.717354 [debug] [Thread-4 (]: Writing injected SQL for node "model.ecommerce_dw.daily_sales"
[0m16:59:57.718936 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_dw.product_performance"
[0m16:59:57.725949 [debug] [Thread-4 (]: Began executing node model.ecommerce_dw.daily_sales
[0m16:59:57.726239 [debug] [Thread-2 (]: Began executing node model.ecommerce_dw.product_performance
[0m16:59:57.732663 [debug] [Thread-3 (]: Began executing node model.ecommerce_dw.customer_ltv
[0m16:59:57.738593 [debug] [Thread-4 (]: Writing runtime sql for node "model.ecommerce_dw.daily_sales"
[0m16:59:57.741930 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_dw.product_performance"
[0m16:59:57.746796 [debug] [Thread-3 (]: Writing runtime sql for node "model.ecommerce_dw.customer_ltv"
[0m16:59:57.751184 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_dw.customer_ltv"
[0m16:59:57.751472 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_dw.daily_sales"
[0m16:59:57.751913 [debug] [Thread-3 (]: On model.ecommerce_dw.customer_ltv: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.customer_ltv"} */

  
    

  create  table "ecommerce_dw"."public"."customer_ltv__dbt_tmp"
  
  
    as
  
  (
    -- Customer Lifetime Value
-- Aggregated customer metrics



SELECT 
    user_id,
    username,
    email,
    
    COUNT(DISTINCT order_id) as lifetime_orders,
    SUM(revenue) as lifetime_value,
    AVG(revenue) as avg_order_value,
    SUM(quantity) as total_items_purchased,
    
    MIN(created_at) as first_order_date,
    MAX(created_at) as last_order_date,
    
    -- Calculate days between first and last order
    EXTRACT(DAY FROM (MAX(created_at) - MIN(created_at))) as customer_tenure_days,
    
    -- Categorize customers
    CASE 
        WHEN COUNT(DISTINCT order_id) >= 20 THEN 'VIP'
        WHEN COUNT(DISTINCT order_id) >= 10 THEN 'Regular'
        ELSE 'Casual'
    END as customer_segment
    
FROM "ecommerce_dw"."public"."stg_sales"
GROUP BY user_id, username, email
ORDER BY lifetime_value DESC
  );
  
[0m16:59:57.752152 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_dw.product_performance"
[0m16:59:57.752574 [debug] [Thread-4 (]: On model.ecommerce_dw.daily_sales: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.daily_sales"} */

  
    

  create  table "ecommerce_dw"."public"."daily_sales__dbt_tmp"
  
  
    as
  
  (
    -- Daily Sales Aggregations
-- Business metrics aggregated by day



SELECT 
    full_date,
    year,
    month,
    quarter,
    
    COUNT(DISTINCT order_id) as total_orders,
    COUNT(DISTINCT user_id) as unique_customers,
    SUM(quantity) as total_items_sold,
    SUM(revenue) as total_revenue,
    AVG(revenue) as avg_order_value,
    MAX(revenue) as max_order_value,
    MIN(revenue) as min_order_value
    
FROM "ecommerce_dw"."public"."stg_sales"
GROUP BY full_date, year, month, quarter
ORDER BY full_date DESC
  );
  
[0m16:59:57.753302 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:59:57.754076 [debug] [Thread-2 (]: On model.ecommerce_dw.product_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.product_performance"} */

  
    

  create  table "ecommerce_dw"."public"."product_performance__dbt_tmp"
  
  
    as
  
  (
    -- Product Performance Analytics
-- Product-level metrics



SELECT 
    product_id,
    product_title,
    category,
    
    COUNT(DISTINCT order_id) as times_ordered,
    SUM(quantity) as total_units_sold,
    SUM(revenue) as total_revenue,
    AVG(unit_price) as avg_sale_price,
    
    -- Performance metrics
    RANK() OVER (ORDER BY SUM(revenue) DESC) as revenue_rank,
    RANK() OVER (PARTITION BY category ORDER BY SUM(revenue) DESC) as category_rank,
    
    -- Calculate what % of total revenue
    ROUND(
        100.0 * SUM(revenue) / SUM(SUM(revenue)) OVER (),
        2
    ) as pct_of_total_revenue
    
FROM "ecommerce_dw"."public"."stg_sales"
GROUP BY product_id, product_title, category
ORDER BY total_revenue DESC
  );
  
[0m16:59:57.754843 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:59:57.756573 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:59:57.766283 [debug] [Thread-3 (]: SQL status: SELECT 45 in 0.013 seconds
[0m16:59:57.770200 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_dw.customer_ltv"
[0m16:59:57.770460 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.016 seconds
[0m16:59:57.770670 [debug] [Thread-2 (]: SQL status: SELECT 20 in 0.014 seconds
[0m16:59:57.771057 [debug] [Thread-3 (]: On model.ecommerce_dw.customer_ltv: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.customer_ltv"} */
alter table "ecommerce_dw"."public"."customer_ltv" rename to "customer_ltv__dbt_backup"
[0m16:59:57.772817 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_dw.daily_sales"
[0m16:59:57.774701 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_dw.product_performance"
[0m16:59:57.775355 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:59:57.775641 [debug] [Thread-4 (]: On model.ecommerce_dw.daily_sales: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.daily_sales"} */
alter table "ecommerce_dw"."public"."daily_sales" rename to "daily_sales__dbt_backup"
[0m16:59:57.776056 [debug] [Thread-2 (]: On model.ecommerce_dw.product_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.product_performance"} */
alter table "ecommerce_dw"."public"."product_performance" rename to "product_performance__dbt_backup"
[0m16:59:57.777601 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_dw.customer_ltv"
[0m16:59:57.778222 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:59:57.778715 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:59:57.778913 [debug] [Thread-3 (]: On model.ecommerce_dw.customer_ltv: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.customer_ltv"} */
alter table "ecommerce_dw"."public"."customer_ltv__dbt_tmp" rename to "customer_ltv"
[0m16:59:57.780496 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_dw.daily_sales"
[0m16:59:57.782236 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_dw.product_performance"
[0m16:59:57.783009 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:59:57.783193 [debug] [Thread-4 (]: On model.ecommerce_dw.daily_sales: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.daily_sales"} */
alter table "ecommerce_dw"."public"."daily_sales__dbt_tmp" rename to "daily_sales"
[0m16:59:57.783630 [debug] [Thread-2 (]: On model.ecommerce_dw.product_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.product_performance"} */
alter table "ecommerce_dw"."public"."product_performance__dbt_tmp" rename to "product_performance"
[0m16:59:57.784625 [debug] [Thread-3 (]: On model.ecommerce_dw.customer_ltv: COMMIT
[0m16:59:57.785276 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:59:57.785702 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:59:57.785985 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_dw.customer_ltv"
[0m16:59:57.786866 [debug] [Thread-4 (]: On model.ecommerce_dw.daily_sales: COMMIT
[0m16:59:57.787734 [debug] [Thread-2 (]: On model.ecommerce_dw.product_performance: COMMIT
[0m16:59:57.788165 [debug] [Thread-3 (]: On model.ecommerce_dw.customer_ltv: COMMIT
[0m16:59:57.788586 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_dw.daily_sales"
[0m16:59:57.788989 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_dw.product_performance"
[0m16:59:57.789760 [debug] [Thread-4 (]: On model.ecommerce_dw.daily_sales: COMMIT
[0m16:59:57.790291 [debug] [Thread-2 (]: On model.ecommerce_dw.product_performance: COMMIT
[0m16:59:57.790606 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m16:59:57.792495 [debug] [Thread-3 (]: Applying DROP to: "ecommerce_dw"."public"."customer_ltv__dbt_backup"
[0m16:59:57.792698 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m16:59:57.792940 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m16:59:57.794912 [debug] [Thread-3 (]: Using postgres connection "model.ecommerce_dw.customer_ltv"
[0m16:59:57.796251 [debug] [Thread-4 (]: Applying DROP to: "ecommerce_dw"."public"."daily_sales__dbt_backup"
[0m16:59:57.797833 [debug] [Thread-2 (]: Applying DROP to: "ecommerce_dw"."public"."product_performance__dbt_backup"
[0m16:59:57.798312 [debug] [Thread-3 (]: On model.ecommerce_dw.customer_ltv: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.customer_ltv"} */
drop table if exists "ecommerce_dw"."public"."customer_ltv__dbt_backup" cascade
[0m16:59:57.798887 [debug] [Thread-4 (]: Using postgres connection "model.ecommerce_dw.daily_sales"
[0m16:59:57.799432 [debug] [Thread-2 (]: Using postgres connection "model.ecommerce_dw.product_performance"
[0m16:59:57.800160 [debug] [Thread-4 (]: On model.ecommerce_dw.daily_sales: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.daily_sales"} */
drop table if exists "ecommerce_dw"."public"."daily_sales__dbt_backup" cascade
[0m16:59:57.800682 [debug] [Thread-2 (]: On model.ecommerce_dw.product_performance: /* {"app": "dbt", "dbt_version": "1.11.4", "profile_name": "ecommerce_profile", "target_name": "dev", "node_id": "model.ecommerce_dw.product_performance"} */
drop table if exists "ecommerce_dw"."public"."product_performance__dbt_backup" cascade
[0m16:59:57.801265 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.001 seconds
[0m16:59:57.802366 [debug] [Thread-3 (]: On model.ecommerce_dw.customer_ltv: Close
[0m16:59:57.802609 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.001 seconds
[0m16:59:57.803067 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c94aed56-b974-434b-be32-e6cc73496494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda26f1b2d0>]}
[0m16:59:57.803387 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.002 seconds
[0m16:59:57.803988 [debug] [Thread-4 (]: On model.ecommerce_dw.daily_sales: Close
[0m16:59:57.804585 [info ] [Thread-3 (]: 2 of 4 OK created sql table model public.customer_ltv .......................... [[32mSELECT 45[0m in 0.09s]
[0m16:59:57.805427 [debug] [Thread-2 (]: On model.ecommerce_dw.product_performance: Close
[0m16:59:57.806000 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c94aed56-b974-434b-be32-e6cc73496494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda2bbb9c90>]}
[0m16:59:57.806545 [debug] [Thread-3 (]: Finished running node model.ecommerce_dw.customer_ltv
[0m16:59:57.807139 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c94aed56-b974-434b-be32-e6cc73496494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda25dd14d0>]}
[0m16:59:57.807653 [info ] [Thread-4 (]: 3 of 4 OK created sql table model public.daily_sales ........................... [[32mSELECT 1[0m in 0.09s]
[0m16:59:57.808549 [info ] [Thread-2 (]: 4 of 4 OK created sql table model public.product_performance ................... [[32mSELECT 20[0m in 0.09s]
[0m16:59:57.809058 [debug] [Thread-4 (]: Finished running node model.ecommerce_dw.daily_sales
[0m16:59:57.809519 [debug] [Thread-2 (]: Finished running node model.ecommerce_dw.product_performance
[0m16:59:57.810948 [debug] [MainThread]: On master: COMMIT
[0m16:59:57.811377 [debug] [MainThread]: Using postgres connection "master"
[0m16:59:57.811734 [debug] [MainThread]: On master: COMMIT
[0m16:59:57.812064 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:59:57.816135 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m16:59:57.816750 [debug] [MainThread]: On master: Close
[0m16:59:57.817272 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:59:57.817661 [debug] [MainThread]: Connection 'model.ecommerce_dw.stg_sales' was properly closed.
[0m16:59:57.818035 [debug] [MainThread]: Connection 'model.ecommerce_dw.customer_ltv' was properly closed.
[0m16:59:57.818426 [debug] [MainThread]: Connection 'model.ecommerce_dw.daily_sales' was properly closed.
[0m16:59:57.818826 [debug] [MainThread]: Connection 'model.ecommerce_dw.product_performance' was properly closed.
[0m16:59:57.819256 [info ] [MainThread]: 
[0m16:59:57.819676 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m16:59:57.820436 [debug] [MainThread]: Command end result
[0m16:59:57.838747 [debug] [MainThread]: Wrote artifact WritableManifest to /dbt_project/target/manifest.json
[0m16:59:57.842068 [debug] [MainThread]: Wrote artifact SemanticManifest to /dbt_project/target/semantic_manifest.json
[0m16:59:57.846963 [debug] [MainThread]: Wrote artifact RunExecutionResult to /dbt_project/target/run_results.json
[0m16:59:57.847447 [info ] [MainThread]: 
[0m16:59:57.847926 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:59:57.848364 [info ] [MainThread]: 
[0m16:59:57.848926 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m16:59:57.850032 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.6061217, "process_in_blocks": "0", "process_kernel_time": 0.173051, "process_mem_max_rss": "126760", "process_out_blocks": "0", "process_user_time": 1.038309}
[0m16:59:57.850537 [debug] [MainThread]: Command `dbt run` succeeded at 16:59:57.850470 after 0.61 seconds
[0m16:59:57.851015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda28eeb6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda2d8652d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fda2d865450>]}
[0m16:59:57.851481 [debug] [MainThread]: Flushing usage events
[0m16:59:58.349508 [debug] [MainThread]: An error was encountered while trying to flush usage events
